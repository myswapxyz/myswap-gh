(this.webpackJsonpamm_app=this.webpackJsonpamm_app||[]).push([[0],{132:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=132},133:function(e,t){},162:function(e,t,n){},188:function(e,t){},196:function(e,t){},197:function(e,t){},218:function(e,t){},233:function(e,t){},234:function(e,t){},235:function(e,t){},236:function(e,t){},237:function(e,t){},238:function(e,t){},239:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(39),c=n.n(a),s=(n(162),n(312)),i=n(314),l=n(316),b=n(328),d=n(13),j=n(14),u=n(7),O=n(24),m=n(17),h=n(311),g=n(315),x=n(143),f=n(299),p=n(317),k=n(306),y=n(307),v=n(135),w=n.n(v),S=n(1);const N="0.50";var B=function(e){const[t,n]=Object(r.useState)(N),[o,a]=Object(r.useState)(null),c=()=>{"Swap"===e.name&&Object(j.c)(W,t),"Add Liquidity"===e.name&&Object(j.c)(P,t),"Remove Liquidity"===e.name&&Object(j.c)(D,t),console.log("Slippage set to: ",t),a(null)};return Object(S.jsx)(h.a,{sx:{flexGrow:1},children:Object(S.jsx)(s.a,{position:"static",children:Object(S.jsxs)(i.a,{children:[Object(S.jsx)(g.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",onClick:e=>{a(e.currentTarget)},sx:{mr:2,position:"absolute",right:"0%"},children:Object(S.jsx)(w.a,{})}),Object(S.jsx)(l.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:e.name}),Object(S.jsx)("div",{children:Object(S.jsxs)(x.a,{id:"menuAppBar",sx:{boxShadow:1},anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{width:250}},open:Boolean(o),onClose:c,children:[Object(S.jsx)(f.a,{sx:{fontSize:14,fontWeight:"bold"},children:"Transaction Settings"}),Object(S.jsxs)(f.a,{children:["Set Slippage",Object(S.jsx)(p.a,{sx:{ml:3,mb:0},value:t,size:"small",onChange:e=>{n(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&c()},inputProps:{step:.01,min:0,max:100,type:"number","aria-labelledby":"input-slider"}})]}),Object(S.jsx)(k.a,{item:!0,container:!0,justifyContent:"center",children:Object(S.jsx)(y.a,{variant:"contained",size:"small",sx:{textWeight:"bold",mt:1},onClick:c,children:"OK"})})]})})]})})})};const A=Object(d.b)({key:"walletAddressState",default:""}),E=(Object(d.b)({key:"isWalletConnectedState",default:0}),Object(d.b)({key:"poolsState",default:new Map})),C=Object(d.b)({key:"tokensState",default:new Map}),_=Object(d.b)({key:"tokensUserDataState",default:new Map}),I=Object(d.b)({key:"pendingTxsState",default:new Array}),T=Object(d.b)({key:"toastsState",default:new Array}),W=Object(d.b)({key:"swapSlippage",default:N}),P=Object(d.b)({key:"addLiquiditySlippage",default:N}),D=Object(d.b)({key:"withdrawLiquiditySlippage",default:N}),z=Object(d.d)({key:"transactionsStatusSelector",get:e=>({get:t})=>{let n=t(I);if(n)return n.filter((t=>t.type===e))}}),M=(Object(d.c)({key:"walletAmountsSelector",get:({get:e})=>{let t=new Map;return e(_).forEach(((n,r)=>{if(void 0!==n.userBalance){let o=e(C).get(r);o&&o.decimals&&t.set(r,n.userBalance)}})),t}}),Object(d.c)({key:"walletAllowanceSelector",get:({get:e})=>{let t=new Map;return e(_).forEach(((n,r)=>{if(void 0!==n.userApproved){let o=e(C).get(r);o&&o.decimals&&t.set(r,n.userApproved)}})),t}}),Object(d.c)({key:"pendingTxSelector",get:({get:e})=>{let t=new Map;return e(I).forEach((e=>{t.set(e.hash,e.status)})),t}}),Object(d.c)({key:"lastTxDoneSelector",get:({get:e})=>{let t=!0;return e(I).forEach((e=>{t=!1,("RECEIVED"===e.status||e.status.includes("ACCEPTED"))&&(t=!0)})),t}}),Object(d.c)({key:"safeToSendTxSelector",get:({get:e})=>{const t=e(I).length;if(0===t)return!0;const n=e(I)[t-1];return!(!n.status.includes("REJECTED")&&!n.status.includes("ACCEPTED"))}})),L=O.stark.getSelectorFromName("swap"),F=O.stark.getSelectorFromName("add_liquidity"),R=O.stark.getSelectorFromName("withdraw_liquidity"),U=O.stark.getSelectorFromName("get_lp_balance"),q="0x008fb0ec84a7025839faafbf9eeee6b6e9957d50bd418a334d00740fbb9f6170",H=Object(u.BigNumber)(q).toString(10),G=O.stark.getSelectorFromName("get_total_number_of_pools"),K=O.stark.getSelectorFromName("get_pool"),V=O.stark.getSelectorFromName("get_total_shares"),J=O.stark.getSelectorFromName("approve"),Y=(O.stark.getSelectorFromName("mint"),O.stark.getSelectorFromName("name")),Z=O.stark.getSelectorFromName("symbol"),$=O.stark.getSelectorFromName("balanceOf"),Q=O.stark.getSelectorFromName("allowance"),X=O.stark.getSelectorFromName("decimals"),ee=0,te=1,ne=2,re=(e,t=!1)=>{if(void 0===e||""===e)return"";if(t){let t=Object(u.BigNumber)(e).shiftedBy(2).sd(4,u.BigNumber.ROUND_DOWN).toPrecision(4);return Object(u.BigNumber)(t).lt(.01)?"<0.01":t}if(Object(u.BigNumber)(e).lt(1)){let t=Object(u.BigNumber)(e).sd(6).toFixed(18,u.BigNumber.ROUND_DOWN);return Object(u.BigNumber)(t).toString(10)}return Object(u.BigNumber)(e).toFixed(2)},oe=e=>{let t=null;if(e){let n=Object(j.b)(_).get(e);n&&(t=n.userApproved,console.log("tokenAllowanceForAMM tud.userApproved = ",n.userApproved))}return t},ae=(e,t)=>{try{let n=oe(e);if(n&&Object(u.BigNumber)(n).gte(Object(u.BigNumber)(ye(e,t))))return!0}catch(n){}return!1},ce=(e,t,n)=>{e&&e.forEach((e=>{console.log("checkAndUpdateComponentTransactions: ",e.status,e.hash),t.hasOwnProperty(e.hash)&&["REJECTED","PENDING","ACCEPTED"].some((t=>e.status.includes(t)))&&(n(!1),delete t[e.hash])}))},se=(e,t,n,r="1")=>{let o=Object(j.b)(E).get(e),a=Object(u.BigNumber)(1);return o&&(o.token1===t?(console.log("here",o.token2Amount),a=Object(u.BigNumber)(ve(n,o.token2Amount)).times(Object(u.BigNumber)(r)).div(Object(u.BigNumber)(ve(t,o.token1Amount)))):a=Object(u.BigNumber)(ve(n,o.token1Amount)).times(Object(u.BigNumber)(r)).div(Object(u.BigNumber)(ve(t,o.token2Amount)))),console.log("Ratio",a.toString(10)),a.toString(10)},ie=e=>{let t=de(),n=Object(j.b)(_).get(e);return t&&e&&n&&void 0!==n.userBalance?ve(e,n.userBalance):""},le=(e,t)=>{let n=de(),r=Object(j.b)(_).get(e);if(!n)return ne;if(!e)return ne;if(!t)return te;if(!r)return ne;if(void 0===r.userBalance)return ne;let o=ve(e,r.userBalance);return Object(u.BigNumber)(t).isPositive()&&Object(u.BigNumber)(t).lte(Object(u.BigNumber)(o))?te:ee},be=(e,t)=>{let n={msg:e,type:t,dismiss:!1,hash:u.BigNumber.random(10).times(1e10).toString(16)};Object(j.c)(T,(e=>[...e,n]))},de=()=>Object(j.b)(A),je=async e=>{console.log("updatePoolsAndTokens");const t=Object(m.getStarknet)();let n=await t.provider.callContract({contract_address:q,entry_point_selector:G,calldata:[]}),r=Number(n.result[0]),o=Object(j.b)(E),a=Object(j.b)(C),c=new Map,s=new Map(a);for(let i=1;i<=r;i++){let n=o.get(i);if(n&&n.refresh>Date.now()-6e4){c.set(i,n);continue}let r=await t.provider.callContract({contract_address:q,entry_point_selector:K,calldata:[i.toString()]}),a=await t.provider.callContract({contract_address:q,entry_point_selector:V,calldata:[i.toString()]});console.log(r);let l={id:i,name:fe(r.result[0]),token1:r.result[1],token1Amount:ge(r.result[2],r.result[3]),token2:r.result[4],token2Amount:ge(r.result[5],r.result[6]),fee:Number(r.result[7])/1e5,cfmm:Number(r.result[8]),shares:ge(a.result[0],a.result[1]),refresh:Date.now()};if(c.set(i,l),e){if(!s.get(l.token1)){let e=s.size;console.log("new token1 n=",e);let t={address:l.token1,id:e,name:"",symbol:"",icon:"",decimals:0};s.set(l.token1,t)}if(!s.get(l.token2)){let e=s.size;console.log("new token2 n=",e);let t={address:l.token2,id:e,name:"",symbol:"",icon:"",decimals:0};s.set(l.token2,t)}}}if(e){let e=[];s.forEach(((n,r)=>{let o=t.provider.callContract({contract_address:r,entry_point_selector:Y,calldata:[]}).then((e=>{const t=fe(e.result[0]);console.log("name=",t),n.name=t}));e.push(o);let a=t.provider.callContract({contract_address:r,entry_point_selector:Z,calldata:[]}).then((e=>{const t=fe(e.result[0]);console.log("symbol=",t),n.symbol=t}));e.push(a);let c=t.provider.callContract({contract_address:r,entry_point_selector:X,calldata:[]}).then((e=>{const t=Number(e.result[0]);n.decimals=t}));e.push(c)})),await Promise.allSettled(e),Object(j.c)(C,s),console.log("tokens=",s)}Object(j.c)(E,c)},ue=async()=>{Object(j.b)(C).forEach(((e,t)=>{console.log("updateAllTokensDynamicData: token=",t),me(t)}))},Oe=async e=>{if(console.log("updatePoolDynamicData"),!de())return null;let t=Object(j.b)(E),n=Object(j.b)(C);if(!1===Object(m.getStarknet)().isConnected)throw Error("starknet wallet not connected");let r=t.get(e);if(!r)throw Error("unknown pool "+e);let o=n.get(r.token1),a=n.get(r.token2);if(!o)throw Error("missing token "+r.token1);if(!a)throw Error("missing token "+r.token2);me(r.token1),me(r.token2)},me=async e=>{if(!e)return null;const t=Object(m.getStarknet)();let n=[],r=de();if(!r)return null;let o=Object(j.b)(_).get(e);if(o){const e=Date.now()-6e4;if(o.refresh>e)return null}else Object(j.c)(_,(t=>{let n=new Map(t);if(!n.get(e)){let t={address:e,refresh:Date.now(),ammBalance:void 0,userBalance:void 0,userApproved:void 0};n.set(e,t)}return n}));let a=t.provider.callContract({contract_address:e,entry_point_selector:$,calldata:[H]}).then((t=>{const n=ge(t.result[0],t.result[1]);Object(j.c)(_,(t=>{let r=new Map(t),o=r.get(e);return o&&(o.ammBalance=n,r.set(o.address,o)),r}))}));n.push(a);let c=t.provider.callContract({contract_address:e,entry_point_selector:$,calldata:[xe(r)]}).then((t=>{const n=ge(t.result[0],t.result[1]);Object(j.c)(_,(t=>{let r=new Map(t),o=r.get(e);return o&&(o.userBalance=n,r.set(o.address,o)),r}))}));n.push(c);let s=t.provider.callContract({contract_address:e,entry_point_selector:Q,calldata:[xe(r),xe(q)]}).then((t=>{const n=ge(t.result[0],t.result[1]);Object(j.c)(_,(t=>{let r=new Map(t),o=r.get(e);return o&&(o.userApproved=n,r.set(o.address,o)),r}))}));n.push(s),await Promise.allSettled(n)};function he(e,t){let n={hash:e,type:t,status:"new",dismiss:!1};Object(j.c)(I,(e=>[...e,n]))}const ge=(e,t)=>Object(u.BigNumber)(e).plus(Object(u.BigNumber)(t).times(Object(u.BigNumber)(2).pow(128))).toString(10),xe=e=>Object(u.BigNumber)(e).toString(10);function fe(e){for(var t=e.substr(2).toString(),n="",r=0;r<t.length;r+=2)n+=String.fromCharCode(parseInt(t.substr(r,2),16));return n}function pe(e){return e.length<=8?e:e.substr(0,5)+"..."+e.substr(-3)}const ke=(e,t)=>{let n=Object(j.b)(E),r=Object(j.b)(C);if(!r.get(e)||!r.get(t))throw Error("Unknown tokens");let[o,a]=function(e,t){return Object(u.BigNumber)(e)<Object(u.BigNumber)(t)?[e,t]:[t,e]}(e,t);for(let c=1;c<=n.size;c++){let e=n.get(c);if(!e)throw Error("missing pool "+c);if(e.token1===o&&e.token2===a)return c}return 0};function ye(e,t){let n=Object(j.b)(C),r=n.get(e);return void 0===r?(be("float_to_decimal_int: Undefined pool for token "+e+", tokens size="+n.size+" amount="+t,"warning"),"0"):Object(u.BigNumber)(t).shiftedBy(r.decimals).toFixed(0,u.BigNumber.ROUND_DOWN)}function ve(e,t){let n=Object(j.b)(C),r=n.get(e);return void 0===r?(be("decimal_int_to_float: Undefined pool for token "+e+", tokens size="+n.size+" amount="+t,"warning"),"0"):Object(u.BigNumber)(t).shiftedBy(-r.decimals).toString(10)}const we=(e,t,n,r)=>{let o=ke(e,t);if(0===o||void 0===n||null===n)return;if(""===n)return"";let a=ye(e,n),c=Object(j.b)(E).get(o);if(void 0===c)return void be("Undefined pool id="+o,"warning");let s="0",i="0";if(c.token1===e?(s=c.token1Amount,i=c.token2Amount):(s=c.token2Amount,i=c.token1Amount),Object(u.BigNumber)(s).lte(0)||Object(u.BigNumber)(i).lte(0))throw Error("token reserve cannot be 0");if(1===r){return ve(t,Object(u.BigNumber)(i).times(Object(u.BigNumber)(a)).div(Object(u.BigNumber)(s).plus(Object(u.BigNumber)(a))).toFixed(0,u.BigNumber.ROUND_DOWN))}return ve(t,Object(u.BigNumber)(i).times(Object(u.BigNumber)(a)).div(Object(u.BigNumber)(s).minus(Object(u.BigNumber)(a))).toFixed(0,u.BigNumber.ROUND_DOWN))},Se=(e,t,n)=>{let r=ke(e,t);if(0===r||void 0===n||null===n)return;if(""===n)return"";let o=ye(e,n);if(void 0===Object(j.b)(E).get(r))return void be("Undefined pool id="+r,"warning");let a=se(r,e,t,o);return console.log("Other Token Add Liquidity: ",a,o),ve(t,a)},Ne=()=>!!Object(j.b)(M)||(be("Previous Transaction still being processed by your wallet, try again later","error"),!1),Be="https://my-json-server.typicode.com/mottyl/static_data";var Ae=n(318),Ee=n(319),Ce=n(320),_e=n(302),Ie=n(298),Te=n(303),We=n(295),Pe=n(138),De=n.n(Pe),ze=n(139),Me=n.n(ze),Le=n(56),Fe=n.n(Le),Re=n(49),Ue=n(136),qe=n.n(Ue);const He=BigInt(2**127-1).toString();var Ge=function(e){const[t]=Object(d.f)(C),[n]=Object(d.f)(A),[o,a]=Object(r.useState)(!1),[c]=Object(d.f)(z("approve")),[s,i]=Object(r.useState)({});Object(r.useEffect)((()=>{ce(c,s,a)}),[c,s]);let l=e.token,b=e.tokenAmount,j=e.activePoolId,u=e.tokenInRange;const O=async()=>{a(!0);let e=He||ye(l,b);try{let t=await(async(e,t)=>{console.log("approve");const n=Object(m.getStarknet)();if(!de())return null;if(!1===n.isConnected)throw Error("starknet wallet not connected");if(!Ne())return null;let r=await n.signer.invokeFunction(e,J,[xe(q),xe(t),xe(0)]);return he(r.transaction_hash,"approve"),r})(l,e);if(!t)throw Error("Cannot perform transaction");i((e=>({...e,[t.transaction_hash]:"new"})))}catch(t){be("Approve user abort","error"),a(!1)}};if(n&&l&&b>0&&j>0&&u&&!ae(l,b)){let e=t.get(l);if(e)return Object(S.jsx)(We.a,{color:"inherit",variant:"outlined",fullWidth:!0,loading:!(!o&&null!==oe(l)&&void 0!==oe(l)),loadingPosition:"start",startIcon:Object(S.jsx)(qe.a,{}),onClick:O,children:null===oe(l)||void 0===oe(l)?"CHECKING "+e.symbol+" ALLOWANCE":"APPROVE "+e.symbol})}return Object(S.jsx)("div",{})};var Ke=function(e){let t=e.token,n=e.showMaxButton,r=e.setMaxAmountHandler,o=e.amount;return void 0===o||""===o?Object(S.jsx)("div",{}):Object(S.jsx)("div",{children:Object(S.jsxs)(k.a,{container:!0,children:[Object(S.jsx)(l.a,{fontSize:13,sx:{ml:2,mt:.5},children:"Balance: "+re(o)}),n&&Object(S.jsx)(y.a,{size:"small",sx:{ml:-1.5,mt:-.2},onClick:()=>r(t,o),children:"max"})]})})};const Ve=async()=>{try{const[e]=await Object(m.getStarknet)().enable();return e}catch{}},Je=()=>{try{return Object(m.getStarknet)().provider.baseUrl.includes("alpha-mainnet.starknet.io")?"mainnet-alpha":"goerli-alpha"}catch{return"goerli-alpha"}},Ye=()=>"mainnet-alpha"===Je()?"https://voyager.online":"https://goerli.voyager.online";var Ze=n(67);const $e=e=>{Ze.a.pageview(e)},Qe=e=>{((e,t,n)=>{Ze.a.event({category:e,action:t,label:n})})("button","click",e)};var Xe=n(137),et=n.n(Xe);var tt=function(e){const[t,n]=Object(r.useState)(0),[o,a]=Object(r.useState)(""),[c,s]=Object(r.useState)(""),[i,l]=Object(r.useState)(!1),[b,j]=Object(d.f)(A),[u]=Object(d.f)(E),O=async()=>{Qe("connect_wallet"),n(1);try{await(async()=>await Object(m.getStarknet)({showModal:!0}).enable())()}catch{return be("Wallet not found","error"),void n(0)}j(await Ve()),n(2),be("Wallet connected","success")};if(Object(r.useEffect)((()=>{if(e.secondary)return;const t=async t=>{e.secondary||(console.log("handleWalletChange: ",t),j(await Ve()),a(Ye()),s(Je()),ue(),be("Wallet network/account change","success"))};console.log("address has changed, ",b),b&&(n(2),ue(),a(Ye()),s(Je()),e.secondary||i||((async e=>{Object(m.getStarknet)().on("accountsChanged",e)})(t),l(!0)))}),[b,e.secondary,i,j]),Object(r.useEffect)((()=>{e.secondary}),[u,e.secondary]),e.secondary)return""!==b||2===t?Object(S.jsx)("div",{}):1===t?Object(S.jsx)("div",{children:Object(S.jsx)(y.a,{color:"inherit",fullWidth:!0,variant:"outlined",disabled:!0,children:"Connecting..."})}):Object(S.jsx)("div",{children:Object(S.jsxs)(y.a,{className:"connect-wallet",color:"inherit",fullWidth:!0,variant:"contained",onClick:O,children:[Object(S.jsx)(Fe.a,{fontSize:"medium",sx:{mr:1}}),"CONNECT WALLET"]})});const h=async()=>{console.log("opening wallet"),window.open(o+"/contract/"+b,"_blank")};return 2===t?(console.log("Wallet is connected!",b),Object(S.jsx)("div",{children:Object(S.jsxs)(y.a,{color:"inherit",variant:"outlined",onClick:h,children:[Object(S.jsx)(et.a,{sx:{mr:1},style:{fill:"lightgreen",fontSize:10}})," ",c," ",pe(b)," "]})})):1===t?(console.log("Wallet is being connected!",b),Object(S.jsx)("div",{children:Object(S.jsx)(y.a,{color:"inherit",variant:"outlined",disabled:!0,children:"Connecting..."})})):Object(S.jsx)("div",{children:Object(S.jsx)(y.a,{color:"inherit",variant:"outlined",onClick:O,children:"Connect Wallet"})})};Number.MAX_SAFE_INTEGER;var nt=function(){const[e,t]=Object(r.useState)(0),[n,o]=Object(r.useState)(""),[a,c]=Object(r.useState)(""),[s,i]=Object(r.useState)(""),[b,O]=Object(r.useState)(""),[x,p]=Object(r.useState)(0),[v,w]=Object(r.useState)(!1),[N]=Object(d.f)(C),[I]=Object(d.f)(_),[T]=Object(d.f)(E),[P]=Object(d.f)(A),[D]=Object(d.f)(z("swap")),[M,F]=Object(r.useState)({});Object(r.useEffect)((()=>{$e("swap")}),[]),Object(r.useEffect)((()=>{ce(D,M,w)}),[D,M]),Object(r.useEffect)((()=>{}),[I,T]),Object(Re.a)((async()=>{e>0?Oe(e):(n&&me(n),s&&me(s))}),15e3);const R=(e,t)=>{const r=/^(([0-9]+[.]?[0-9]*)|([.][0-9]+))$/;e!==n||""!==t&&!r.test(t)||(c(t),p(1)),e!==s||""!==t&&!r.test(t)||(O(t),p(2))};Object(r.useEffect)((()=>{if(n&&s){let e=ke(n,s);if(t(e),x<=1)if(e>0){let e=we(n,s,a,1);console.log("calcOtherTokenAmount: (token1 leading) ",e),void 0!==e&&e!==b&&O(e)}else O(0);else if(e>0){let e=we(s,n,b,2);console.log("calcOtherTokenAmount: (token2 leading) ",e),void 0!==e&&e<0?e=0:void 0!==e&&e!==a&&c(e)}else c(0)}else x<=1?O(""):c("")}),[n,s,a,b,x]);const U=e=>{let t=[];return N.forEach(((n,r)=>{e!==r&&t.push(Object(S.jsx)(f.a,{value:r,children:Object(S.jsxs)(k.a,{container:!0,direction:"row",children:[Object(S.jsx)(k.a,{sx:{mr:1,mb:-1},children:Object(S.jsx)("img",{src:n.icon,alt:"",width:"24",height:"24"})}),Object(S.jsx)(k.a,{children:Object(S.jsx)(l.a,{children:n.symbol||n.address})})]})},r))})),t},H=()=>{let e=parseFloat(Object(j.b)(W))/100;return Object(u.BigNumber)(b).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(e)))},G=async()=>{w(!0);let t=H();try{let r=await(async(e,t,n,r)=>{console.log("swap");const o=Object(m.getStarknet)();if(!de())return null;if(!1===o.isConnected)throw Error("starknet wallet not connected");if(!Ne())return null;let a=await o.signer.invokeFunction(q,L,[xe(e),xe(t),xe(n),xe(0),xe(r),xe(0)]);return he(a.transaction_hash,"swap"),a})(e,n,ye(n,a),ye(s,t));if(!r)throw Error("Cannot perform transaction");F((e=>({...e,[r.transaction_hash]:"new"})))}catch(r){be("Swap Request: User Aborted","error"),w(!1)}},[K,V]=Object(r.useState)(0),[J]=Object(d.f)(W);return Object(S.jsx)(h.a,{sx:{p:2,border:"0px solid",mt:1,mb:4,boxShadow:2},children:Object(S.jsxs)("div",{children:[Object(S.jsx)(k.a,{container:!0,sx:{mb:2},children:Object(S.jsx)(B,{name:"Swap"})}),Object(S.jsx)(Ae.a,{sx:{p:2,boxShadow:2,mb:-4},children:Object(S.jsxs)(k.a,{container:!0,spacing:2,sx:{},children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(Ce.a,{fullWidth:!0,children:[Object(S.jsx)(_e.a,{id:"token1-label",children:"Token 1:"}),Object(S.jsx)(Ie.a,{labelId:"token1-label",id:"token1-select",value:n,label:"Token 1",onChange:e=>{let t=e.target.value;o(t),me(t),Qe("swap-token1")},children:U(s)})]}),Object(S.jsx)(Ke,{token:n,amount:ie(n),showMaxButton:!0,setMaxAmountHandler:R})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(Ce.a,{fullWidth:!0,children:Object(S.jsx)(Te.a,{helperText:"Amount to swap",id:"token1-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount"},value:a||"",onChange:e=>R(n,e.target.value),error:le(n,a)===ee,disabled:""===n})})})]})}),Object(S.jsx)(k.a,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:Object(S.jsx)(g.a,{size:"large",disabled:!n&&!s,onClick:()=>{Qe("swap-switchtokens");let e=n,t=a;o(s),i(e),c(b),O(t),p(1===x?2:1)},children:Object(S.jsx)(Me.a,{style:{fontSize:40}})})}),Object(S.jsx)(Ae.a,{sx:{p:2,mt:-3,boxShadow:2},children:Object(S.jsxs)(k.a,{container:!0,spacing:2,children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(Ce.a,{fullWidth:!0,children:[Object(S.jsx)(_e.a,{id:"token2-label",children:"Token 2:"}),Object(S.jsx)(Ie.a,{labelId:"token2-label",id:"token2-select",value:s,label:"Token 2",onChange:e=>{let t=e.target.value;i(t),me(t),Qe("swap-token2")},children:U(n)})]}),Object(S.jsx)(Ke,{token:s,amount:ie(s),showMaxButton:!1})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(Ce.a,{fullWidth:!0,children:Object(S.jsx)(Te.a,{helperText:"Estimated amount received",id:"token2-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount"},value:b||"",onChange:e=>R(s,e.target.value),disabled:""===s})})})]})}),(()=>{if(n&&s&&a&&!Object(u.BigNumber)(a).isZero()&&b&&!Object(u.BigNumber)(b).isZero()){let t=se(e,n,s);console.log("CurrentPrice: ",t);let r=H(),o=N.get(n).symbol,c=N.get(s).symbol,i=parseFloat(J),d=Object(u.BigNumber)(b).div(Object(u.BigNumber)(a)),j=Object(u.BigNumber)(a).div(Object(u.BigNumber)(b)),O=Object(u.BigNumber)(1).minus(Object(u.BigNumber)(d).div(Object(u.BigNumber)(t))),m=O.gt(.05)?"tomato":O.gt(.03)?"orange":"inherit",h=Object(S.jsxs)(S.Fragment,{children:["1 ",o," = ",re(d)," ",c]}),g=Object(S.jsxs)(S.Fragment,{children:["1 ",c," = ",re(j)," ",o]});return Object(S.jsxs)(k.a,{children:[Object(S.jsx)(Ae.a,{sx:{mb:.5,mt:2},children:Object(S.jsx)(Ee.a,{onClick:()=>V(!K),children:Object(S.jsx)(l.a,{fontSize:13,fontWeight:"medium",sx:{ml:1,mr:1},children:K?g:h})})}),Object(S.jsxs)(Ae.a,{style:{backgroundColor:m},sx:{mb:2},children:[Object(S.jsxs)(l.a,{fontSize:13,fontWeight:"medium",sx:{ml:1,mr:1},children:["Minimum amount received (slippage=",i.toFixed(2),"%): ",re(r)]}),Object(S.jsxs)(l.a,{fontSize:13,fontWeight:"medium",sx:{ml:1,mr:1},children:["Price impact: ",re(O,!0),"%"]})]})]})}return Object(S.jsx)("div",{})})(),Object(S.jsxs)(Ae.a,{sx:{minWidth:275,mb:2,mt:3,boxShadow:2},children:[Object(S.jsx)(tt,{secondary:"true"}),Object(S.jsx)(Ge,{token:n,tokenAmount:a,activePoolId:e,tokenInRange:le(n,a)===te}),(()=>{Qe("swap");let t=le(n,a),r=((e,t,n)=>{if(!t||e<=0)return!1;let r=Object(j.b)(E).get(e);if(!r)throw Error("missing pool "+e);let o=ye(t,n);return r.token1===t?Object(u.BigNumber)(o).gt(Object(u.BigNumber)(r.token1Amount)):Object(u.BigNumber)(o).gt(Object(u.BigNumber)(r.token2Amount))})(e,s,b);if(s&&a>0&&0!==e&&t===te&&!r)return Object(S.jsx)(We.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!(P&&ae(n,a)||v),loading:v,loadingPosition:"start",startIcon:Object(S.jsx)(De.a,{}),onClick:G,children:v?"SWAPPING":"SWAP"});if(P&&a>0&&t!==te&&!r)return Object(S.jsx)(We.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,loading:t===ne,loadingPosition:"start",startIcon:Object(S.jsx)(Fe.a,{}),children:t===ee?"AMOUNT EXCEEDS WALLET BALANCE":"CHECKING WALLET BALANCE"});if(n&&s&&0===e)return Object(S.jsx)(y.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,children:"NOT A VALID Pool"});if(n&&s&&e&&b&&r)return Object(S.jsx)(y.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,children:"INSUFFICIENT LIQUIDITY IN POOL"});if(P){let e="";if(n||s||(e="SELECT TOKENS"),(!n&&s||n&&!s)&&(e="SELECT TOKEN"),!n||!s||a&&b||(e="ENTER AMOUNT"),""!==e)return Object(S.jsx)(y.a,{color:"secondary",variant:"contained",fullWidth:!0,disabled:!0,children:e})}return Object(S.jsx)("div",{})})()]})]})})},rt=n(325),ot=n(141),at=n.n(ot),ct=n(3),st=n(313),it=n(291),lt=n(326),bt=n(309),dt=n(310),jt=n(322),ut=n(300),Ot=n(323),mt=n(324),ht=n(140),gt=n.n(ht);const xt=Object(ct.a)(st.a)((({theme:e})=>({...e.typography.body2,padding:e.spacing(0),textAlign:"left",color:e.palette.text.secondary}))),ft=Object(ct.a)(p.a)`
    width: 42px;
`;function pt(e){const[t,n]=Object(r.useState)(!1),[o,a]=Object(r.useState)(25),[c,s]=Object(r.useState)(""),[i,b]=Object(r.useState)(""),[O,g]=Object(r.useState)(0),[x]=Object(d.f)(z("withdraw_liquidity")),[f,p]=Object(r.useState)({});Object(r.useEffect)((()=>{ce(x,f,g)}),[x,f]);Object(r.useEffect)((()=>{Object(u.BigNumber)(c).isZero()&&b("0"),Object(u.BigNumber)(i).isZero()&&s("0"),s(re(Object(u.BigNumber)(e.token1Amount).times(o).shiftedBy(-2))),b(re(Object(u.BigNumber)(e.token2Amount).times(o).shiftedBy(-2))),g(0)}),[t,c,i,o,e.token1Amount,e.token2Amount]);const v=()=>{g(0),n(!1)},w=t=>{a(t),(t=>{s(re(Object(u.BigNumber)(e.token1Amount).times(t).shiftedBy(-2))),b(re(Object(u.BigNumber)(e.token2Amount).times(t).shiftedBy(-2)))})(t),console.log("Remove Liquidity, updateState: ",c,i,e.token1Amount,e.token2Amount)};return Object(S.jsxs)("div",{children:[Object(S.jsx)(y.a,{variant:"contained",sx:{textWeight:"bold"},onClick:()=>{n(!0)},children:"WITHDRAW"}),Object(S.jsx)(bt.a,{open:t,onClose:v,children:Object(S.jsxs)(h.a,{sx:{p:2,border:"0px solid",boxShadow:2},children:[Object(S.jsx)(k.a,{container:!0,sx:{mb:2},children:Object(S.jsx)(B,{name:"Remove Liquidity"})}),Object(S.jsxs)(dt.a,{children:[Object(S.jsxs)(Ae.a,{sx:{p:2,border:"0px solid",boxShadow:2,mb:2},children:[Object(S.jsx)(jt.a,{children:"Choose amount of liquidity shares to remove"}),Object(S.jsx)(h.a,{sx:{width:500,mt:3,ml:2},children:Object(S.jsxs)(k.a,{container:!0,spacing:2,alignItems:"center",children:[Object(S.jsx)(k.a,{item:!0,xs:!0,sx:{mt:2,ml:2,mr:2},children:Object(S.jsx)(ut.a,{"aria-label":"Custom marks",defaultValue:25,valueLabelDisplay:"auto",marks:[{value:0,label:"0%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:75,label:"75%"},{value:100,label:"100%"}],value:"number"===typeof o?o:0,onChange:(e,t)=>{w(t)},"aria-labelledby":"input-slider"})}),Object(S.jsx)(k.a,{item:!0,sx:{ml:2,mr:4},children:Object(S.jsx)(ft,{value:o,size:"small",onChange:e=>{let t=""===e.target.value?"":Number(e.target.value);w(t),console.log("handle input change")},onBlur:()=>{o<0?a(0):o>100&&a(100)},inputProps:{step:1,min:0,max:100,type:"number","aria-labelledby":"input-slider"}})})]})})]}),Object(S.jsxs)(Ae.a,{sx:{p:2,border:"0px solid",boxShadow:2,mb:0},children:[Object(S.jsx)(Ot.a,{title:"Amount Received",disableTypography:!0,sx:{fontSize:18,mt:0}}),Object(S.jsxs)(k.a,{item:!0,container:!0,alignItems:"center",spacing:2,sx:{width:400,ml:2},children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(it.a,{direction:"row",spacing:0,alignItems:"center",children:[Object(S.jsx)(xt,{sx:{boxShadow:0,mr:1},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:e.token1Icon,alt:"",width:"32",height:"32"})}),Object(S.jsx)(xt,{sx:{boxShadow:0},children:Object(S.jsxs)(l.a,{sx:{fontSize:18},children:[e.token1Symbol,":"]})})]}),Object(S.jsxs)(it.a,{direction:"row",spacing:0,alignItems:"center",children:[Object(S.jsx)(xt,{sx:{boxShadow:0,mr:1},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:e.token2Icon,alt:"",width:"32",height:"32"})}),Object(S.jsx)(xt,{sx:{boxShadow:0},children:Object(S.jsxs)(l.a,{sx:{fontSize:18},children:[e.token2Symbol,":"]})})]})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsxs)(it.a,{children:[Object(S.jsx)(xt,{sx:{boxShadow:0},children:Object(S.jsx)(l.a,{sx:{fontSize:18},children:re(c)})}),Object(S.jsx)(xt,{sx:{boxShadow:0},children:Object(S.jsx)(l.a,{sx:{fontSize:18},children:re(i)})})]})})]})]})]}),Object(S.jsxs)(mt.a,{children:[Object(S.jsx)(y.a,{variant:"contained",style:{backgroundColor:"gray"},onClick:v,children:"Cancel"}),Object(S.jsx)(We.a,{color:"primary",variant:"contained",disabled:!("0"!==c&&"0"!==i&&!O),loading:1===O,loadingPosition:"start",startIcon:Object(S.jsx)(gt.a,{}),onClick:async()=>{console.log("Withdraw percent: ",o);let t=parseFloat(Object(j.b)(D))/100,n=Object(u.BigNumber)(e.balance).times(Object(u.BigNumber)(o)).shiftedBy(-2).toFixed(2,u.BigNumber.ROUND_DOWN),r=Object(u.BigNumber)(c).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(t).shiftedBy(-2))).toString(10,u.BigNumber.ROUND_DOWN),a=Object(u.BigNumber)(i).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(t).shiftedBy(-2))).toString(10,u.BigNumber.ROUND_DOWN);g(1),console.log("handleWithdraw: ",n,r,a);try{let t=await(async(e,t,n,r)=>{console.log("withdraw_liquidity");const o=Object(m.getStarknet)();let a=de();if(!1===o.isConnected||!a)return null;if(console.log("Calling Starknet: withdraw_liquidity with ",e,t,n,r),!Ne())return null;let c=await o.signer.invokeFunction(q,R,[xe(e),xe(t),xe(0),xe(n),xe(0),xe(r),xe(0)]);return he(c.transaction_hash,"withdraw_liquidity"),c})(e.poolId,n,ye(e.token1,r),ye(e.token2,a));if(!t)throw Error("Cannot perform transaction");p((e=>({...e,[t.transaction_hash]:"new"})))}catch(s){be("Remove Liquidity: User Aborted","error"),g(0)}v()},children:O?"REMOVING":"REMOVE"})]})]})})]})}const kt=Object(ct.a)(st.a)((({theme:e})=>({...e.typography.body2,padding:e.spacing(0),textAlign:"left",color:e.palette.text.secondary})));var yt=function(e){const[t]=Object(d.f)(C),[n]=Object(d.f)(E);let r=n.get(e.poolId);if(!r||!r.shares)return Object(S.jsx)("div",{});const o=()=>{let r=n.get(e.poolId).token1;return t.get(r)},a=()=>o(e.poolId).symbol,c=()=>o(e.poolId).icon,s=()=>{let t=n.get(e.poolId);return t.shares?Object(u.BigNumber)(e.balance).div(Object(u.BigNumber)(t.shares)):"0"},i=()=>ve(r.token1,(()=>{let t=n.get(e.poolId),r=s();return Object(u.BigNumber)(r).times(t.token1Amount)})()),b=()=>{let r=n.get(e.poolId).token2;return t.get(r)},j=()=>b(e.poolId).symbol,O=()=>b(e.poolId).icon,m=()=>ve(r.token1,(()=>{let t=n.get(e.poolId),r=s();return Object(u.BigNumber)(r).times(t.token2Amount)})());return Object(S.jsxs)(Ae.a,{sx:{p:2,border:"0px solid",boxShadow:2,mb:5},children:[Object(S.jsx)(l.a,{sx:{fontSize:18,fontWeight:"500"},children:"Your Position"}),Object(S.jsx)(rt.a,{children:Object(S.jsxs)(k.a,{item:!0,container:!0,direction:"row",alignItems:"center",children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(it.a,{direction:"row",spacing:0,alignItems:"center",children:[Object(S.jsx)(kt,{sx:{boxShadow:0,mr:0},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:c(),alt:"",width:"32",height:"32"})}),Object(S.jsx)(kt,{sx:{boxShadow:0,ml:-1,mr:1},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:O(),alt:"",width:"32",height:"32"})}),Object(S.jsx)(kt,{sx:{boxShadow:0},children:Object(S.jsxs)(l.a,{sx:{fontSize:24,fontWeight:"normal"},color:"text.primary",gutterBottom:!0,children:[a()," / ",j(),":"]})})]}),Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"normal"},color:"text.primary",children:"Your Pool Share:"}),Object(S.jsxs)(l.a,{sx:{fontSize:16,fontWeight:"normal"},color:"text.primary",children:["Pooled ",a(),":"]}),Object(S.jsxs)(l.a,{sx:{fontSize:16,fontWeight:"normal"},color:"text.primary",children:["Pooled ",j(),":"]})]}),Object(S.jsxs)(k.a,{item:!0,xs:6,textAlign:"right",children:[Object(S.jsx)(l.a,{sx:{fontSize:24,fontWeight:"normal"},color:"text.primary",gutterBottom:!0,children:e.balance}),Object(S.jsxs)(l.a,{sx:{fontSize:16,fontWeight:"bold"},color:"text.primary",children:[re(s(),!0),"%"]}),Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"bold"},color:"text.primary",children:re(i())}),Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"bold"},color:"text.primary",children:re(m())})]})]})}),Object(S.jsx)(lt.a,{children:Object(S.jsx)(k.a,{item:!0,container:!0,justifyContent:"center",children:Object(S.jsx)(pt,{poolId:e.poolId,balance:e.balance,token1Symbol:a(),token2Symbol:j(),token1Icon:c(),token2Icon:O(),token1:o().address,token2:b().address,token1Amount:i(),token2Amount:m()})})})]})};var vt=function(){const[e]=Object(d.f)(E),[t]=Object(d.f)(A),[n,o]=Object(r.useState)((()=>new Map));return Object(r.useEffect)((()=>{async function n(e){const n=await(async(e,t)=>{const n=Object(m.getStarknet)();if(!t)return null;if(!1===n.isConnected)throw Error("starknet wallet not connected");let r=await n.provider.callContract({contract_address:q,entry_point_selector:U,calldata:[xe(e),xe(t)]});return ge(r.result[0],r.result[1])})(e,t);n&&o((t=>{let r=new Map(t);return r.set(e,n),r}))}t&&e.forEach((e=>{n(e.id)}))}),[t,e]),Object(S.jsx)("div",{children:(()=>{let e=[];return n.forEach(((t,n)=>{Object(u.BigNumber)(t).isZero()||(e.push(Object(S.jsx)(yt,{poolId:n,balance:t},n)),Oe(n))})),e})()})};var wt=function(){const[e]=Object(d.f)(C),[t]=Object(d.f)(E),[n,o]=Object(r.useState)(""),[a,c]=Object(r.useState)(""),[s,i]=Object(r.useState)(""),[b,O]=Object(r.useState)(""),[g,x]=Object(r.useState)(0),[p]=Object(d.f)(A),[v,w]=Object(r.useState)(!1),[N,I]=Object(r.useState)(0),[T]=Object(d.f)(z("add_liquidity")),[W,D]=Object(r.useState)({}),[M]=Object(d.f)(_);Object(r.useEffect)((()=>{}),[M,t]),Object(r.useEffect)((()=>{$e("pools")}),[]),Object(r.useEffect)((()=>{ce(T,W,w)}),[T,W]),Object(r.useEffect)((()=>{if(n&&s){let e=ke(n,s);if(x(e),N<=1)if(e>0){let e=Se(n,s,a);void 0!==e&&O(e)}else O(0);else if(e>0){let e=Se(s,n,b);void 0!==e&&c(e)}else c(0)}}),[n,s,a,b,N]),Object(Re.a)((async()=>{g>0?Oe(g):(n&&me(n),s&&me(s))}),15e3);const L=(e,t)=>{const r=/^(([0-9]+[.]?[0-9]*)|([.][0-9]+))$/;e!==n||""!==t&&!r.test(t)||(c(t),I(1)),e!==s||""!==t&&!r.test(t)||(O(t),I(2))},R=async()=>{w(!0);let e=parseFloat(Object(j.b)(P))/100,t=Object(u.BigNumber)(a).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(e))).toString(10),r=Object(u.BigNumber)(b).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(e))).toString(10);console.log("Add Liquidity slippage: ",e),console.log("Add Liquidity minAmountOut: ",t,ye(n,t));try{let e=await(async(e,t,n,r,o,a)=>{console.log("AMM_add_liquidity: ",n,xe(n));const c=Object(m.getStarknet)();let s=de();return!1!==c.isConnected&&s&&Ne()?await c.signer.invokeFunction(q,F,[xe(e),xe(t),xe(0),xe(n),xe(0),xe(r),xe(o),xe(0),xe(a),xe(0)]):null})(n,ye(n,a),ye(n,t),s,ye(s,b),ye(s,r));if(!e)throw Error("Cannot perform transaction");D((t=>({...t,[e.transaction_hash]:"new"})))}catch(o){be("User abort","error"),w(!1)}},U=t=>{let n=[];return e.forEach(((e,r)=>{t!==r&&n.push(Object(S.jsx)(f.a,{value:r,children:Object(S.jsxs)(k.a,{container:!0,direction:"row",children:[Object(S.jsx)(k.a,{sx:{mr:1,mb:-1},children:Object(S.jsx)("img",{src:e.icon,alt:"",width:"24",height:"24"})}),Object(S.jsx)(k.a,{children:Object(S.jsx)(l.a,{children:e.symbol||e.address})})]})},r))})),n};return Object(S.jsxs)("div",{children:[Object(S.jsxs)(h.a,{sx:{p:2,border:"0px solid",mt:1,mb:4,boxShadow:2},children:[Object(S.jsx)(k.a,{container:!0,sx:{mb:4},children:Object(S.jsx)(B,{name:"Add Liquidity"})}),Object(S.jsxs)(k.a,{container:!0,spacing:2,children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(Ce.a,{fullWidth:!0,children:[Object(S.jsx)(_e.a,{id:"token1-label",children:"Token 1:"}),Object(S.jsx)(Ie.a,{labelId:"token1-label",id:"token1-select",value:n,label:"Token 1",onChange:e=>{let t=e.target.value;o(t),me(t),Qe("pool-token1")},children:U(s)})]}),Object(S.jsx)(Ke,{token:n,amount:ie(n),showMaxButton:!0,setMaxAmountHandler:L})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(Ce.a,{fullWidth:!0,children:Object(S.jsx)(Te.a,{helperText:"Amount to provide",id:"token1-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount1"},value:a||"",onChange:e=>L(n,e.target.value),error:le(n,a)===ee,disabled:""===n})})})]}),Object(S.jsxs)(k.a,{container:!0,spacing:2,sx:{mt:2},children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(Ce.a,{fullWidth:!0,children:[Object(S.jsx)(_e.a,{id:"token2-label",children:"Token 2:"}),Object(S.jsx)(Ie.a,{labelId:"token2-label",id:"token2-select",value:s,label:"Token 2",onChange:e=>{let t=e.target.value;i(t),me(t),Qe("pool-token2")},children:U(n)})]}),Object(S.jsx)(Ke,{token:s,amount:ie(s),showMaxButton:!0,setMaxAmountHandler:L})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(Ce.a,{fullWidth:!0,children:Object(S.jsx)(Te.a,{helperText:"Amount to provide",id:"token2-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount2"},value:b||"",onChange:e=>L(s,e.target.value),error:le(s,b)===ee,disabled:""===s})})})]}),(()=>{let r=t.get(g);if(!a||!b||!g||!r)return Object(S.jsx)("div",{});let o=e.get(n).symbol,c=e.get(s).symbol;console.log("-----POOL SHARE: ",a,b,ve(r.token1,r.token1Amount)+Object(u.BigNumber)(a),ve(r.token2,r.token2Amount));let i=se(g,s,n),d=se(g,n,s),j=r.token1===n?Object(u.BigNumber)(a).div(Object(u.BigNumber)(a).plus(Object(u.BigNumber)(ve(r.token1,r.token1Amount)))):Object(u.BigNumber)(a).div(Object(u.BigNumber)(a).plus(Object(u.BigNumber)(ve(r.token2,r.token2Amount))));return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(k.a,{children:Object(S.jsxs)(Ae.a,{sx:{mb:2,mt:2,boxShadow:2},children:[Object(S.jsx)(rt.a,{children:Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"500",mb:0},gutterBottom:!0,children:"Pool Prices and Share"})}),Object(S.jsx)(Ae.a,{sx:{mb:0,mt:0},children:Object(S.jsxs)(k.a,{item:!0,container:!0,alignItems:"center",spacing:2,children:[Object(S.jsxs)(k.a,{item:!0,xs:4,children:[Object(S.jsx)(l.a,{sx:{textAlign:"center",lineHeight:2,mt:1,fontWeight:"bold"},children:re(i)}),Object(S.jsxs)(l.a,{sx:{textAlign:"center",fontSize:12,mb:1},children:[o," for ",c]})]}),Object(S.jsxs)(k.a,{item:!0,xs:4,children:[Object(S.jsx)(l.a,{sx:{textAlign:"center",lineHeight:2,mt:1,fontWeight:"bold"},children:re(d)}),Object(S.jsxs)(l.a,{sx:{textAlign:"center",fontSize:12,mb:1},children:[c," for ",o]})]}),Object(S.jsxs)(k.a,{item:!0,xs:4,children:[Object(S.jsxs)(l.a,{sx:{textAlign:"center",lineHeight:2,mt:1,fontWeight:"bold"},children:[re(j,!0),"%"]}),Object(S.jsx)(l.a,{sx:{textAlign:"center",fontSize:12,mb:1},children:"Share of Pool"})]})]})})]})})})})(),Object(S.jsxs)(Ae.a,{sx:{minWidth:275,mb:2,mt:3,boxShadow:2},children:[Object(S.jsx)(tt,{secondary:"true"}),Object(S.jsx)(Ge,{token:n,tokenAmount:a,activePoolId:g,tokenInRange:le(n,a)===te}),Object(S.jsx)(Ge,{token:s,tokenAmount:b,activePoolId:g,tokenInRange:le(s,b)===te}),(()=>{Qe("add-liquidity");let e=le(n,a),t=le(s,b);if(n&&s&&a>0&&b>0&&e===te&&t===te&&0!==g)return Object(S.jsx)(We.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!(p&&ae(n,a)&&ae(s,b)||v),loading:v,loadingPosition:"start",startIcon:Object(S.jsx)(at.a,{}),onClick:R,children:v?"ADDING LIQUIDITY":"ADD LIQUIDITY"});if(p&&n&&s&&a>0&&b>0&&(e!==te||t!==te))return Object(S.jsx)(We.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,loading:e===ne||t===ne,loadingPosition:"start",startIcon:Object(S.jsx)(Fe.a,{}),children:e===ee||t===ee?"AMOUNT EXCEEDS WALLET BALANCE":"CHECKING WALLET BALANCE"});if(n&&s&&0===g)return Object(S.jsx)(y.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,children:"NOT A VALID Pool"});if(p){let e="";if(n||s||(e="SELECT TOKENS"),(!n&&s||n&&!s)&&(e="SELECT TOKEN"),!n||!s||a&&b||(e="ENTER AMOUNT"),""!==e)return Object(S.jsx)(y.a,{color:"secondary",variant:"contained",fullWidth:!0,disabled:!0,children:e})}return Object(S.jsx)("div",{})})()]})]}),Object(S.jsx)(vt,{})]})},St=n(15),Nt=n(59);St.d.register(St.c,St.i,St.k,St.h,St.o,St.p,St.f);var Bt=function(){const e=["2021-12-14","2021-12-13","2021-12-12","2021-12-11","2021-12-10","2021-12-09","2021-12-08","2021-12-07","2021-12-06","2021-12-05"],t=[{id:1,label:"",data:[9.486967291294242,9.913585044383598,6.1093149832212585,8.888170412454828,9.644500380279675,5.592256920179448,1.6120884439497363,1.6694652914713426,9.780713359093626,6.9842512776941055]}];return Object(S.jsx)("div",{children:Object(S.jsxs)(Ae.a,{sx:{mb:0,mt:0},children:[Object(S.jsx)(l.a,{children:"Overview"}),Object(S.jsxs)(k.a,{item:!0,container:!0,alignItems:"center",spacing:2,children:[Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(Nt.a,{datasetIdKey:"id",data:{labels:e,datasets:t}})}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(Nt.a,{datasetIdKey:"id",data:{labels:e,datasets:t}})})]})]})})},At=n(294),Et=n(327);var Ct=()=>{const[e,t]=Object(r.useState)(0);return Object(S.jsxs)(h.a,{children:[Object(S.jsxs)(At.a,{sx:{mt:3,mb:2},value:e,onChange:(e,n)=>{t(n)},centered:!0,children:[Object(S.jsx)(Et.a,{className:"swap-tab",label:"Swap",sx:{fontSize:18}}),Object(S.jsx)(Et.a,{className:"provide-tab",label:"Pools",sx:{fontSize:18}}),Object(S.jsx)(Et.a,{className:"chart-tab",label:"Charts",sx:{fontSize:18}})]}),0===e&&Object(S.jsx)(nt,{}),1===e&&Object(S.jsx)(wt,{}),2===e&&Object(S.jsx)(Bt,{})]})};var _t=function(e){return Object(S.jsx)("div",{children:Object(S.jsxs)(y.a,{sx:{mr:2},variant:"contained",onClick:()=>{window.open("https://goerli.voyager.online/tx/"+e.hash,"_blank")},children:["Tx ",pe(e.hash)," ",e.transactionStatus]})})};var It=function(){const[e]=Object(d.f)(I);return Object(Re.a)((async()=>{e.forEach((async e=>{if(!e.dismiss){let t=await(async e=>{let t=await Object(m.getStarknet)().provider.getTransactionStatus(e),n=Object(j.b)(I);return n&&n.find((n=>n.hash===e&&n.status!==t.tx_status))?(console.log("getTransactionUpdate: ",t.tx_status,e),Object(j.c)(I,(n=>{let r=new Array;return n.forEach((n=>{if(console.log("Inside forEach: ",n.hash,n.status),n.hash===e){let e=Object.assign({},n);e.status=t.tx_status,"ACCEPTED_ON_L2"!==e.status&&"ACCEPTED_ON_L1"!==e.status||(e.dismiss=!0),r.push(e)}else r.push(n)})),r})),t.tx_status):null})(e.hash);null!==t&&(t.includes("RECEIVED")&&be("Transaction Sent","success"),t.includes("REJECTED")&&be("Transaction Rejected","error"),t.includes("PENDING")&&(be("Transaction Pending","success"),je(!1),ue()),t.includes("ACCEPTED")&&be("Transaction Accepted","success"))}}))}),1e4),Object(S.jsx)(S.Fragment,{children:(()=>{let t=[];return e.forEach((e=>{e.dismiss||t.push(Object(S.jsx)(_t,{hash:e.hash,transactionStatus:e.status,children:" "},e.hash))})),t})()})},Tt=n(301),Wt=n(296);var Pt=function(e){const[t,n]=o.a.useState(e.open),r=(e,t)=>{"clickaway"!==t&&n(!1)};return Object(S.jsx)(Tt.a,{className:"toast",open:t,autoHideDuration:6e3,onClose:r,children:Object(S.jsx)(Wt.a,{onClose:r,severity:e.type,sx:{width:"100%"},children:e.msg})})};var Dt=function(){const[e]=Object(d.f)(T);return Object(S.jsx)("div",{children:(()=>{let t=[];return e.forEach((e=>{e.dismiss||t.push(Object(S.jsx)(Pt,{open:!e.dismiss,msg:e.msg,type:e.type},e.hash))})),t})()})};St.d.register(St.c,St.i,St.k,St.h,St.o,St.p,St.f);n(232);var zt=function(){return Object(r.useEffect)((()=>{Ze.a.initialize("UA-215866683-1"),$e("/")}),[]),Object(r.useEffect)((()=>{(async()=>{(async()=>{const e=await fetch(`${Be}/amminfo`),t=await e.json();console.log("AMM info data:",t)})(),(async()=>{const e=await fetch(`${Be}/pools`),t=await e.json();let n=new Map;for(let r=1;r<=t.numberOfPools;r++){let e=t[r],o={id:r,name:e.poolName,token1:e.tokenAAddress,token1Amount:ge(e.tokenAReserves[0],e.tokenAReserves[1]),token2:e.tokenBAddress,token2Amount:ge(e.tokenBReserves[0],e.tokenBReserves[1]),fee:Number(e.feePercentage)/1e5,cfmm:Number(e.cfmm),shares:ge(e.shares[0],e.shares[1]),refresh:Date.now()};console.log("Pool = ",o),n.set(r,o)}Object(j.c)(E,n)})(),(async()=>{const e=await fetch(`${Be}/tokens`),t=await e.json();let n=new Map;for(let r=0;r<t.numberOfTokens;r++){let e=t[r],o={address:e.tokenAddress,id:r,name:e.tokenName,symbol:e.tokenSymbol,icon:e.tokenIcon,decimals:e.tokenDecimals};n.set(e.tokenAddress,o),console.log("Token = ",o)}Object(j.c)(C,n)})()})(),console.log("Finished updating static data"),je(!0)}),[]),Object(Re.a)((async()=>{je(!1)}),15e3),Object(S.jsxs)(d.a,{children:[Object(S.jsx)(j.a,{}),Object(S.jsxs)("div",{className:"App",children:[Object(S.jsx)(s.a,{position:"sticky",children:Object(S.jsxs)(i.a,{children:[Object(S.jsx)(l.a,{variant:"h4",color:"inherit",component:"div",sx:{flexGrow:1},children:"mySwap"}),Object(S.jsx)(It,{}),Object(S.jsx)(tt,{})]})}),Object(S.jsx)(b.a,{maxWidth:"sm",children:Object(S.jsx)(Ct,{})}),Object(S.jsx)(Dt,{})]})]})},Mt=n(292);c.a.render(Object(S.jsx)(o.a.StrictMode,{children:Object(S.jsx)(Mt.a,{children:Object(S.jsx)(zt,{})})}),document.getElementById("root"))}},[[239,1,2]]]);
//# sourceMappingURL=main.976f7aa7.chunk.js.map