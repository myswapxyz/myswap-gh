(this.webpackJsonpamm_app=this.webpackJsonpamm_app||[]).push([[0],{166:function(e,t,n){},193:function(e,t){},201:function(e,t){},202:function(e,t){},223:function(e,t){},240:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(41),c=n.n(a),s=(n(166),n(313)),i=n(315),l=n(317),b=n(329),d=n(12),j=n(14),u=n(7),h=n(24),O=n(16),m=n(312),g=n(316),x=n(146),f=n(300),p=n(318),k=n(307),y=n(308),w=n(137),v=n.n(w),S=n(1);const N="0.50";var E=function(e){const[t,n]=Object(o.useState)(N),[r,a]=Object(o.useState)(null),c=()=>{"Swap"===e.name&&Object(j.c)(W,t),"Add Liquidity"===e.name&&Object(j.c)(P,t),"Remove Liquidity"===e.name&&Object(j.c)(D,t),console.log("Slippage set to: ",t),a(null)};return Object(S.jsx)(m.a,{sx:{flexGrow:1},children:Object(S.jsx)(s.a,{position:"static",children:Object(S.jsxs)(i.a,{children:[Object(S.jsx)(g.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",onClick:e=>{a(e.currentTarget)},sx:{mr:2,position:"absolute",right:"0%"},children:Object(S.jsx)(v.a,{})}),Object(S.jsx)(l.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:e.name}),Object(S.jsx)("div",{children:Object(S.jsxs)(x.a,{id:"menuAppBar",sx:{boxShadow:1},anchorEl:r,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{width:250}},open:Boolean(r),onClose:c,children:[Object(S.jsx)(f.a,{sx:{fontSize:14,fontWeight:"bold"},children:"Transaction Settings"}),Object(S.jsxs)(f.a,{children:["Set Slippage",Object(S.jsx)(p.a,{sx:{ml:3,mb:0},value:t,size:"small",onChange:e=>{n(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&c()},inputProps:{step:.01,min:0,max:100,type:"number","aria-labelledby":"input-slider"}})]}),Object(S.jsx)(k.a,{item:!0,container:!0,justifyContent:"center",children:Object(S.jsx)(y.a,{variant:"contained",size:"small",sx:{textWeight:"bold",mt:1},onClick:c,children:"OK"})})]})})]})})})};const A=Object(d.b)({key:"walletAddressState",default:""}),B=(Object(d.b)({key:"isWalletConnectedState",default:0}),Object(d.b)({key:"poolsState",default:new Map})),C=Object(d.b)({key:"tokensState",default:new Map}),_=Object(d.b)({key:"tokensUserDataState",default:new Map}),T=Object(d.b)({key:"pendingTxsState",default:new Array}),I=Object(d.b)({key:"toastsState",default:new Array}),W=Object(d.b)({key:"swapSlippage",default:N}),P=Object(d.b)({key:"addLiquiditySlippage",default:N}),D=Object(d.b)({key:"withdrawLiquiditySlippage",default:N}),z=Object(d.d)({key:"transactionsStatusSelector",get:e=>({get:t})=>{let n=t(T);if(n)return n.filter((t=>t.type===e))}}),L=Object(d.c)({key:"walletAmountsSelector",get:({get:e})=>{let t=new Map;return e(_).forEach(((n,o)=>{if(void 0!==n.userBalance){let r=e(C).get(o);r&&r.decimals&&t.set(o,n.userBalance)}})),t}}),M=Object(d.c)({key:"walletAllowanceSelector",get:({get:e})=>{let t=new Map;return e(_).forEach(((n,o)=>{if(void 0!==n.userApproved){let r=e(C).get(o);r&&r.decimals&&t.set(o,n.userApproved)}})),t}}),R=(Object(d.c)({key:"pendingTxSelector",get:({get:e})=>{let t=new Map;return e(T).forEach((e=>{t.set(e.hash,e.status)})),t}}),Object(d.c)({key:"lastTxDoneSelector",get:({get:e})=>{let t=!0;return e(T).forEach((e=>{t=!1,("REJECTED"===e.status||e.status.includes("ACCEPTED"))&&(t=!0)})),t}})),F=Object(d.c)({key:"safeToSendTxSelector",get:({get:e})=>{const t=e(T).length;if(0===t)return!0;const n=e(T)[t-1];return!(!n.status.includes("REJECTED")&&!n.status.includes("ACCEPTED"))}}),U=h.stark.getSelectorFromName("swap"),q=h.stark.getSelectorFromName("add_liquidity"),G=h.stark.getSelectorFromName("withdraw_liquidity"),H=h.stark.getSelectorFromName("get_lp_balance"),K="0xfbcbc5f1db50c34094223c2b575e65fedb363ae6a0885613c25879b931d5e7",V=Object(u.BigNumber)(K).toString(10),Y=h.stark.getSelectorFromName("get_total_number_of_pools"),J=h.stark.getSelectorFromName("get_pool"),Z=h.stark.getSelectorFromName("get_total_shares"),$=h.stark.getSelectorFromName("approve"),Q=(h.stark.getSelectorFromName("mint"),h.stark.getSelectorFromName("name")),X=h.stark.getSelectorFromName("symbol"),ee=h.stark.getSelectorFromName("balanceOf"),te=h.stark.getSelectorFromName("allowance"),ne=h.stark.getSelectorFromName("decimals"),oe=0,re=1,ae=2,ce=(e,t=!1)=>{if(void 0===e||""===e)return"";if(t){let t=Object(u.BigNumber)(e).shiftedBy(2).sd(4,u.BigNumber.ROUND_DOWN).toPrecision(4);return Object(u.BigNumber)(t).lt(.01)?"<0.01":t}if(Object(u.BigNumber)(e).lt(1)){let t=Object(u.BigNumber)(e).sd(6).toFixed(18,u.BigNumber.ROUND_DOWN);return Object(u.BigNumber)(t).toString(10)}return Object(u.BigNumber)(e).toFixed(2)},se=e=>{let t=null;if(e){let n=Object(j.b)(_).get(e);n&&(t=n.userApproved)}return t},ie=(e,t)=>{try{let n=se(e);if(n&&Object(u.BigNumber)(n).gte(Object(u.BigNumber)(Ne(e,t))))return!0}catch(n){}return!1},le=(e,t,n)=>{console.log("Entered checkAndUpdateComponentTransactions..."),e&&e.forEach((e=>{console.log("checkAndUpdateComponentTransactions: ",e.status,e.hash,typeof e.hash,t,t.hasOwnProperty(e.hash)),t.hasOwnProperty(e.hash)&&(console.log("componentTxs has hash ",e.hash),["REJECTED","ACCEPTED"].some((t=>e.status.includes(t)))&&(console.log("Setting transaction in progress to false"),n(!1),delete t[e.hash]))}))},be=(e,t,n,o="1")=>{let r=Object(j.b)(B).get(e),a=Object(u.BigNumber)(1);return r&&(a=r.token1===t?Object(u.BigNumber)(Ee(n,r.token2Amount)).times(Object(u.BigNumber)(o)).div(Object(u.BigNumber)(Ee(t,r.token1Amount))):Object(u.BigNumber)(Ee(n,r.token1Amount)).times(Object(u.BigNumber)(o)).div(Object(u.BigNumber)(Ee(t,r.token2Amount)))),a.toString(10)},de=e=>{let t=he(),n=Object(j.b)(_).get(e);return t&&e&&n&&void 0!==n.userBalance?Ee(e,n.userBalance):""},je=(e,t)=>{let n=he(),o=Object(j.b)(_).get(e);if(!n)return ae;if(!e)return ae;if(!t)return re;if(!o)return ae;if(void 0===o.userBalance)return ae;let r=Ee(e,o.userBalance);return Object(u.BigNumber)(t).isPositive()&&Object(u.BigNumber)(t).lte(Object(u.BigNumber)(r))?re:oe},ue=(e,t)=>{let n={msg:e,type:t,dismiss:!1,hash:u.BigNumber.random(10).times(1e10).toString(16)};Object(j.c)(I,(e=>[...e,n]))},he=()=>Object(j.b)(A),Oe=async e=>{console.log("updatePoolsAndTokens");const t=Object(O.getStarknet)();let n=await t.provider.callContract({contract_address:K,entry_point_selector:Y,calldata:[]}),o=Number(n.result[0]),r=Object(j.b)(B),a=Object(j.b)(C),c=new Map,s=new Map(a);for(let i=1;i<=o;i++){let n=r.get(i);if(n&&n.refresh>Date.now()-6e4){c.set(i,n);continue}n?console.log("will fetch pool data for pool ",i," seconds passed=",(Date.now()-n.refresh)/1e3):console.log("will fetch pool data id=",i," since pool is null!");let o=await t.provider.callContract({contract_address:K,entry_point_selector:J,calldata:[i.toString()]}),a=await t.provider.callContract({contract_address:K,entry_point_selector:Z,calldata:[i.toString()]});console.log(o);let l={id:i,name:we(o.result[0]),token1:o.result[1],token1Amount:ke(o.result[2],o.result[3]),token2:o.result[4],token2Amount:ke(o.result[5],o.result[6]),fee:Number(o.result[7])/1e5,cfmm:Number(o.result[8]),shares:ke(a.result[0],a.result[1]),refresh:Date.now()};if(c.set(i,l),e){if(!s.get(l.token1)){let e=s.size;console.log("new token1 n=",e);let t={address:l.token1,id:e,name:"",symbol:"",icon:"https://github.com/myswapxyz/static_data/raw/master/icons8-exchange-96.png",decimals:0};s.set(l.token1,t)}if(!s.get(l.token2)){let e=s.size;console.log("new token2 n=",e);let t={address:l.token2,id:e,name:"",symbol:"",icon:"https://github.com/myswapxyz/static_data/raw/master/icons8-exchange-96.png",decimals:0};s.set(l.token2,t)}}}if(e){let e=[];s.forEach(((n,o)=>{let r=t.provider.callContract({contract_address:o,entry_point_selector:Q,calldata:[]}).then((e=>{const t=we(e.result[0]);console.log("name=",t),n.name=t}));e.push(r);let a=t.provider.callContract({contract_address:o,entry_point_selector:X,calldata:[]}).then((e=>{const t=we(e.result[0]);console.log("symbol=",t),n.symbol=t}));e.push(a);let c=t.provider.callContract({contract_address:o,entry_point_selector:ne,calldata:[]}).then((e=>{const t=Number(e.result[0]);n.decimals=t}));e.push(c)})),await Promise.allSettled(e),Object(j.c)(C,s),console.log("tokens=",s)}Object(j.c)(B,c)},me=async()=>{Object(j.b)(C).forEach(((e,t)=>{console.log("updateAllTokensDynamicData: token=",t),xe(t)}))},ge=async e=>{if(!(async e=>{let t=Object(j.b)(B).get(e),n=Date.now();if(t&&t.refresh>n-6e4)return console.log("not updating pool ",e," , not enough time since last update"),!1;const o=Object(O.getStarknet)();let r=await o.provider.callContract({contract_address:K,entry_point_selector:J,calldata:[e.toString()]}),a=await o.provider.callContract({contract_address:K,entry_point_selector:Z,calldata:[e.toString()]}),c={id:e,name:we(r.result[0]),token1:r.result[1],token1Amount:ke(r.result[2],r.result[3]),token2:r.result[4],token2Amount:ke(r.result[5],r.result[6]),fee:Number(r.result[7])/1e5,cfmm:Number(r.result[8]),shares:ke(a.result[0],a.result[1]),refresh:n};return Object(j.c)(B,(t=>{let n=new Map(t);return n.set(e,c),n})),console.log("updated pool ",e),!0})(e))return;if(!he())return null;let t=Object(j.b)(B),n=Object(j.b)(C);if(!1===Object(O.getStarknet)().isConnected)throw Error("starknet wallet not connected");let o=t.get(e);if(!o)throw Error("unknown pool "+e);let r=n.get(o.token1),a=n.get(o.token2);if(!r)throw Error("missing token "+o.token1);if(!a)throw Error("missing token "+o.token2);xe(o.token1),xe(o.token2)},xe=async e=>{if(!e)return null;const t=Object(O.getStarknet)();let n=[],o=he();if(!o)return null;let r=Object(j.b)(_).get(e);if(r){const e=Date.now()-6e4;if(r.refresh>e)return console.log("not enough time passed, not updating tud"),null}else Object(j.c)(_,(t=>{let n=new Map(t);if(!n.get(e)){let t={address:e,refresh:Date.now(),ammBalance:void 0,userBalance:void 0,userApproved:void 0};n.set(e,t)}return n}));console.log("updating tud, ",e);let a=t.provider.callContract({contract_address:e,entry_point_selector:ee,calldata:[V]}).then((t=>{const n=ke(t.result[0],t.result[1]);Object(j.c)(_,(t=>{let o=new Map(t),r=o.get(e);return r&&(r.ammBalance=n,r.refresh=Date.now(),o.set(r.address,r)),o}))}));n.push(a);let c=t.provider.callContract({contract_address:e,entry_point_selector:ee,calldata:[ye(o)]}).then((t=>{const n=ke(t.result[0],t.result[1]);Object(j.c)(_,(t=>{let o=new Map(t),r=o.get(e);return r&&(r.userBalance=n,r.refresh=Date.now(),o.set(r.address,r)),o}))}));n.push(c);let s=t.provider.callContract({contract_address:e,entry_point_selector:te,calldata:[ye(o),ye(K)]}).then((t=>{const n=ke(t.result[0],t.result[1]);Object(j.c)(_,(t=>{let o=new Map(t),r=o.get(e);return r&&(r.userApproved=n,r.refresh=Date.now(),o.set(r.address,r)),o}))}));n.push(s),await Promise.allSettled(n)};function fe(e,t){let n={hash:e,type:t,status:"new",dismiss:!1};Object(j.c)(T,(e=>[...e,n]))}const pe=async(e,t)=>{console.log("Entered approve");const n=Object(O.getStarknet)();if(!he())return null;if(!1===n.isConnected)throw Error("starknet wallet not connected");if(!Ce())return null;let o=await n.signer.invokeFunction(e,$,[ye(K),ye(t),ye(0)]);return console.log("Adding transaction - approve"),fe(o.transaction_hash,"approve"),o},ke=(e,t)=>Object(u.BigNumber)(e).plus(Object(u.BigNumber)(t).times(Object(u.BigNumber)(2).pow(128))).toString(10),ye=e=>Object(u.BigNumber)(e).toString(10);function we(e){for(var t=e.substr(2).toString(),n="",o=0;o<t.length;o+=2)n+=String.fromCharCode(parseInt(t.substr(o,2),16));return n}function ve(e){return e.length<=8?e:e.substr(0,5)+"..."+e.substr(-3)}const Se=(e,t)=>{let n=Object(j.b)(B),o=Object(j.b)(C);if(!o.get(e)||!o.get(t))throw Error("Unknown tokens");let[r,a]=function(e,t){return Object(u.BigNumber)(e).lt(Object(u.BigNumber)(t))?[e,t]:[t,e]}(e,t);for(let c=1;c<=n.size;c++){let e=n.get(c);if(!e)throw Error("missing pool "+c);if(e.token1===r&&e.token2===a)return c}return 0};function Ne(e,t){let n=Object(j.b)(C),o=n.get(e);return void 0===o?(ue("float_to_decimal_int: Undefined pool for token "+e+", tokens size="+n.size+" amount="+t,"warning"),"0"):Object(u.BigNumber)(t).shiftedBy(o.decimals).toFixed(0,u.BigNumber.ROUND_DOWN)}function Ee(e,t){let n=Object(j.b)(C),o=n.get(e);return void 0===o?(ue("decimal_int_to_float: Undefined pool for token "+e+", tokens size="+n.size+" amount="+t,"warning"),"0"):Object(u.BigNumber)(t).shiftedBy(-o.decimals).toString(10)}const Ae=(e,t,n,o)=>{let r=Se(e,t);if(0===r||void 0===n||null===n)return;if(""===n)return"";let a=Ne(e,n),c=Object(j.b)(B).get(r);if(void 0===c)return void ue("Undefined pool id="+r,"warning");let s="0",i="0";if(c.token1===e?(s=c.token1Amount,i=c.token2Amount):(s=c.token2Amount,i=c.token1Amount),Object(u.BigNumber)(s).lte(0)||Object(u.BigNumber)(i).lte(0))throw Error("token reserve cannot be 0");if(1===o){return Ee(t,Object(u.BigNumber)(i).times(Object(u.BigNumber)(a)).div(Object(u.BigNumber)(s).plus(Object(u.BigNumber)(a))).toFixed(0,u.BigNumber.ROUND_DOWN))}return Ee(t,Object(u.BigNumber)(i).times(Object(u.BigNumber)(a)).div(Object(u.BigNumber)(s).minus(Object(u.BigNumber)(a))).toFixed(0,u.BigNumber.ROUND_DOWN))},Be=(e,t,n)=>{let o=Se(e,t);if(0===o||void 0===n||null===n)return;if(""===n)return"";let r=Ne(e,n);if(void 0===Object(j.b)(B).get(o))return void ue("Undefined pool id="+o,"warning");let a=be(o,e,t,r);return console.log("Other Token Add Liquidity: ",a,r),Ee(t,a)},Ce=()=>!!Object(j.b)(F)||(ue("Previous Transaction still being processed by your wallet, try again later","error"),!1),_e="https://my-json-server.typicode.com/myswapxyz/static_data";var Te=n(319),Ie=n(320),We=n(321),Pe=n(303),De=n(299),ze=n(304),Le=n(296),Me=n(140),Re=n.n(Me),Fe=n(141),Ue=n.n(Fe),qe=n(59),Ge=n.n(qe),He=n(52),Ke=n(138),Ve=n.n(Ke);const Ye=BigInt(2**127-1).toString();var Je=function(e){const[t]=Object(d.f)(C),[n]=Object(d.f)(A),[r,a]=Object(o.useState)(!1),[c,s]=Object(o.useState)(0),[i]=Object(d.f)(z("approve")),[l,b]=Object(o.useState)({});let j=e.token,u=e.tokenAmount,h=e.activePoolId,O=e.tokenInRange;Object(o.useEffect)((()=>{le(i,l,a)}),[i,l]),Object(o.useEffect)((()=>{!1===r&&1===c&&(s(2),e.approveTxStatusUpdateCallback(!0))}),[r,c,e]),Object(o.useEffect)((()=>{a(!1),s(!1)}),[e.token,e.activePoolId,e.tokenAmount]);const m=async()=>{a(!0),s(1);let e=Ye||Ne(j,u);try{let t=await pe(j,e);if(!t)throw console.log("Approve Transaction returned = null"),Error("Cannot perform transaction");b((e=>({...e,[t.transaction_hash]:"new"})))}catch(t){"Cannot perform transaction"!==t.message&&ue("Approve user abort","error"),s(0),a(!1)}};if(n&&j&&u>0&&h>0&&O&&!ie(j,u)&&2!==c){let e=se(j),n=t.get(j);if(n)return Object(S.jsx)(Le.a,{color:"inherit",variant:"outlined",fullWidth:!0,loading:!(!r&&null!==e&&void 0!==e),loadingPosition:"start",startIcon:Object(S.jsx)(Ve.a,{}),onClick:m,children:null===e||void 0===e?"CHECKING "+n.symbol+" ALLOWANCE":r?"APPROVING "+n.symbol:"APPROVE "+n.symbol})}return Object(S.jsx)("div",{})};var Ze=function(e){let t=e.token,n=e.showMaxButton,o=e.setMaxAmountHandler,r=e.amount;return void 0===r||""===r?Object(S.jsx)("div",{}):Object(S.jsx)("div",{children:Object(S.jsxs)(k.a,{container:!0,children:[Object(S.jsx)(l.a,{fontSize:13,sx:{ml:2,mt:.5},children:"Balance: "+ce(r)}),n&&Object(S.jsx)(y.a,{size:"small",sx:{ml:-1.5,mt:-.2},onClick:()=>o(t,r),children:"max"})]})})};const $e=async()=>{try{const[e]=await Object(O.getStarknet)().enable();return e}catch{}},Qe=()=>{try{return Object(O.getStarknet)().provider.baseUrl.includes("alpha-mainnet.starknet.io")?"mainnet-alpha":"goerli-alpha"}catch{return"goerli-alpha"}},Xe=()=>"mainnet-alpha"===Qe()?"https://voyager.online":"https://goerli.voyager.online";var et=n(89);const tt=e=>{et.a.pageview(e)},nt=e=>{((e,t,n)=>{et.a.event({category:e,action:t,label:n})})("button","click",e)};var ot=n(139),rt=n.n(ot);var at=function(e){const[t,n]=Object(o.useState)(0),[r,a]=Object(o.useState)(""),[c,s]=Object(o.useState)(""),[i,l]=Object(o.useState)(!1),[b,j]=Object(d.f)(A),[u]=Object(d.f)(B),h=async()=>{nt("connect_wallet"),n(1);try{await(async()=>await Object(O.getStarknet)({showModal:!0}).enable())()}catch{return ue("Wallet not found","error"),void n(0)}j(await $e()),n(2),ue("Wallet connected","success")};if(Object(o.useEffect)((()=>{if(e.secondary)return;const t=async t=>{e.secondary||(console.log("handleWalletChange: ",t),j(await $e()),a(Xe()),s(Qe()),me(),ue("Wallet network/account change","success"))};console.log("address has changed, ",b),b&&(n(2),me(),a(Xe()),s(Qe()),e.secondary||i||((async e=>{Object(O.getStarknet)().on("accountsChanged",e)})(t),l(!0)))}),[b,e.secondary,i,j]),Object(o.useEffect)((()=>{e.secondary}),[u,e.secondary]),e.secondary)return""!==b||2===t?Object(S.jsx)("div",{}):1===t?Object(S.jsx)("div",{children:Object(S.jsx)(y.a,{color:"inherit",fullWidth:!0,variant:"outlined",disabled:!0,children:"Connecting..."})}):Object(S.jsx)("div",{children:Object(S.jsxs)(y.a,{className:"connect-wallet",color:"inherit",fullWidth:!0,variant:"contained",onClick:h,children:[Object(S.jsx)(Ge.a,{fontSize:"medium",sx:{mr:1}}),"CONNECT WALLET"]})});const m=async()=>{console.log("opening wallet"),window.open(r+"/contract/"+b,"_blank")};return 2===t?Object(S.jsx)("div",{children:Object(S.jsxs)(y.a,{color:"inherit",variant:"outlined",onClick:m,children:[Object(S.jsx)(rt.a,{sx:{mr:1},style:{fill:"lightgreen",fontSize:10}})," ",c," ",ve(b)," "]})}):1===t?Object(S.jsx)("div",{children:Object(S.jsx)(y.a,{color:"inherit",variant:"outlined",disabled:!0,children:"Connecting..."})}):Object(S.jsx)("div",{children:Object(S.jsx)(y.a,{color:"inherit",variant:"outlined",onClick:h,children:"Connect Wallet"})})};Number.MAX_SAFE_INTEGER;var ct=function(){const[e,t]=Object(o.useState)(0),[n,r]=Object(o.useState)(""),[a,c]=Object(o.useState)(""),[s,i]=Object(o.useState)(""),[b,h]=Object(o.useState)(""),[x,p]=Object(o.useState)(0),[w,v]=Object(o.useState)(!1),[N]=Object(d.f)(C),[T]=Object(d.f)(_),[I]=Object(d.f)(B),[P,D]=Object(o.useState)(!1),[L]=Object(d.f)(A),[M]=Object(d.f)(z("swap")),[R,F]=Object(o.useState)({});Object(o.useEffect)((()=>{tt("swap")}),[]),Object(o.useEffect)((()=>{le(M,R,v)}),[M,R]),Object(o.useEffect)((()=>{}),[T,I]),Object(He.a)((async()=>{e>0?ge(e):(n&&xe(n),s&&xe(s))}),15e3);const q=(e,t)=>{const o=/^(([0-9]+[.]?[0-9]*)|([.][0-9]+))$/;e!==n||""!==t&&!o.test(t)||(c(t),p(1)),e!==s||""!==t&&!o.test(t)||(h(t),p(2))};Object(o.useEffect)((()=>{if(n&&s){let e=Se(n,s);if(t(e),x<=1)if(e>0){let e=Ae(n,s,a,1);console.log("calcOtherTokenAmount: (token1 leading) ",e),void 0!==e&&e!==b&&h(e)}else h(0);else if(e>0){let e=Ae(s,n,b,2);console.log("calcOtherTokenAmount: (token2 leading) ",e),void 0!==e&&e<0?e=0:void 0!==e&&e!==a&&c(e)}else c(0)}else x<=1?h(""):c("")}),[n,s,a,b,x,I]);const G=e=>{let t=[];return N.forEach(((n,o)=>{e!==o&&t.push(Object(S.jsx)(f.a,{value:o,children:Object(S.jsxs)(k.a,{container:!0,direction:"row",children:[Object(S.jsx)(k.a,{sx:{mr:1,mb:-1},children:Object(S.jsx)("img",{src:n.icon,alt:"",width:"24",height:"24"})}),Object(S.jsx)(k.a,{children:Object(S.jsx)(l.a,{children:n.symbol||n.address})})]})},o))})),t},H=()=>{let e=parseFloat(Object(j.b)(W))/100;return Object(u.BigNumber)(b).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(e)))},V=async()=>{v(!0),nt("swap");let t=H();try{let o=await(async(e,t,n,o)=>{console.log("swap");const r=Object(O.getStarknet)();if(!he())return null;if(!1===r.isConnected)throw Error("starknet wallet not connected");if(!Ce())return null;let a=await r.signer.invokeFunction(K,U,[ye(e),ye(t),ye(n),ye(0),ye(o),ye(0)]);return fe(a.transaction_hash,"swap"),a})(e,n,Ne(n,a),Ne(s,t));if(!o)throw Error("Cannot perform transaction");F((e=>({...e,[o.transaction_hash]:"new"})))}catch(o){ue("Swap Request: User Aborted","error"),v(!1)}},[Y,J]=Object(o.useState)(0),[Z]=Object(d.f)(W);return Object(S.jsx)(m.a,{sx:{p:2,border:"0px solid",mt:1,mb:4,boxShadow:2},children:Object(S.jsxs)("div",{children:[Object(S.jsx)(k.a,{container:!0,sx:{mb:2},children:Object(S.jsx)(E,{name:"Swap"})}),Object(S.jsx)(Te.a,{sx:{p:2,boxShadow:2,mb:-4},children:Object(S.jsxs)(k.a,{container:!0,spacing:2,sx:{},children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(We.a,{fullWidth:!0,children:[Object(S.jsx)(Pe.a,{id:"token1-label",children:"Token 1:"}),Object(S.jsx)(De.a,{labelId:"token1-label",id:"token1-select",value:n,label:"Token 1",onChange:e=>{let t=e.target.value;r(t),D(!1),xe(t),nt("swap-token1")},children:G(s)})]}),Object(S.jsx)(Ze,{token:n,amount:de(n),showMaxButton:!0,setMaxAmountHandler:q})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(We.a,{fullWidth:!0,children:Object(S.jsx)(ze.a,{helperText:"Amount to swap",id:"token1-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount"},value:a||"",onChange:e=>q(n,e.target.value),error:je(n,a)===oe,disabled:""===n})})})]})}),Object(S.jsx)(k.a,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:Object(S.jsx)(g.a,{size:"large",disabled:!n&&!s,onClick:()=>{nt("swap-switchtokens");let e=n,t=a;r(s),i(e),c(b),h(t),p(1===x?2:1),D(!1)},children:Object(S.jsx)(Ue.a,{style:{fontSize:40}})})}),Object(S.jsx)(Te.a,{sx:{p:2,mt:-3,boxShadow:2},children:Object(S.jsxs)(k.a,{container:!0,spacing:2,children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(We.a,{fullWidth:!0,children:[Object(S.jsx)(Pe.a,{id:"token2-label",children:"Token 2:"}),Object(S.jsx)(De.a,{labelId:"token2-label",id:"token2-select",value:s,label:"Token 2",onChange:e=>{let t=e.target.value;i(t),D(!1),xe(t),nt("swap-token2")},children:G(n)})]}),Object(S.jsx)(Ze,{token:s,amount:de(s),showMaxButton:!1})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(We.a,{fullWidth:!0,children:Object(S.jsx)(ze.a,{helperText:"Estimated amount received",id:"token2-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount"},value:b||"",onChange:e=>q(s,e.target.value),disabled:""===s})})})]})}),(()=>{if(n&&s&&a&&!Object(u.BigNumber)(a).isZero()&&b&&!Object(u.BigNumber)(b).isZero()){let t=be(e,n,s);console.log("CurrentPrice: ",t);let o=H(),r=N.get(n).symbol,c=N.get(s).symbol,i=parseFloat(Z),d=Object(u.BigNumber)(b).div(Object(u.BigNumber)(a)),j=Object(u.BigNumber)(a).div(Object(u.BigNumber)(b)),h=Object(u.BigNumber)(1).minus(Object(u.BigNumber)(d).div(Object(u.BigNumber)(t))),O=h.gt(.05)?"tomato":h.gt(.03)?"orange":"inherit",m=Object(S.jsxs)(S.Fragment,{children:["1 ",r," = ",ce(d)," ",c]}),g=Object(S.jsxs)(S.Fragment,{children:["1 ",c," = ",ce(j)," ",r]});return Object(S.jsxs)(k.a,{children:[Object(S.jsx)(Te.a,{sx:{mb:.5,mt:2},children:Object(S.jsx)(Ie.a,{onClick:()=>J(!Y),children:Object(S.jsx)(l.a,{fontSize:13,fontWeight:"medium",sx:{ml:1,mr:1},children:Y?g:m})})}),Object(S.jsxs)(Te.a,{style:{backgroundColor:O},sx:{mb:2},children:[Object(S.jsxs)(l.a,{fontSize:13,fontWeight:"medium",sx:{ml:1,mr:1},children:["Minimum amount received (slippage=",i.toFixed(2),"%): ",ce(o)]}),Object(S.jsxs)(l.a,{fontSize:13,fontWeight:"medium",sx:{ml:1,mr:1},children:["Price impact: ",ce(h,!0),"%"]})]})]})}return Object(S.jsx)("div",{})})(),Object(S.jsxs)(Te.a,{sx:{minWidth:275,mb:2,mt:3,boxShadow:2},children:[Object(S.jsx)(at,{secondary:"true"}),Object(S.jsx)(Je,{token:n,tokenAmount:a,activePoolId:e,tokenInRange:je(n,a)===re,approveTxStatusUpdateCallback:D}),(()=>{let t=je(n,a),o=((e,t,n)=>{if(!t||e<=0)return!1;let o=Object(j.b)(B).get(e);if(!o)throw Error("missing pool "+e);let r=Ne(t,n);return o.token1===t?Object(u.BigNumber)(r).gt(Object(u.BigNumber)(o.token1Amount)):Object(u.BigNumber)(r).gt(Object(u.BigNumber)(o.token2Amount))})(e,s,b);if(s&&a>0&&0!==e&&t===re&&!o)return Object(S.jsx)(Le.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!(L&&ie(n,a)||w||P),loading:w,loadingPosition:"start",startIcon:Object(S.jsx)(Re.a,{}),onClick:V,children:w?"SWAPPING":"SWAP"});if(L&&a>0&&t!==re&&!o)return Object(S.jsx)(Le.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,loading:t===ae,loadingPosition:"start",startIcon:Object(S.jsx)(Ge.a,{}),children:t===oe?"AMOUNT EXCEEDS WALLET BALANCE":"CHECKING WALLET BALANCE"});if(n&&s&&0===e)return Object(S.jsx)(y.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,children:"NOT A VALID Pool"});if(n&&s&&e&&b&&o)return Object(S.jsx)(y.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,children:"INSUFFICIENT LIQUIDITY IN POOL"});if(L){let e="";if(n||s||(e="SELECT TOKENS"),(!n&&s||n&&!s)&&(e="SELECT TOKEN"),!n||!s||a&&b||(e="ENTER AMOUNT"),""!==e)return Object(S.jsx)(y.a,{color:"secondary",variant:"contained",fullWidth:!0,disabled:!0,children:e})}return Object(S.jsx)("div",{})})()]})]})})},st=n(326),it=n(143),lt=n.n(it),bt=n(3),dt=n(314),jt=n(292),ut=n(327),ht=n(310),Ot=n(311),mt=n(323),gt=n(301),xt=n(324),ft=n(325),pt=n(142),kt=n.n(pt);const yt=Object(bt.a)(dt.a)((({theme:e})=>({...e.typography.body2,padding:e.spacing(0),textAlign:"left",color:e.palette.text.secondary}))),wt=Object(bt.a)(p.a)`
    width: 42px;
`;function vt(e){const[t,n]=Object(o.useState)(!0),[r,a]=Object(o.useState)(25),[c,s]=Object(o.useState)(""),[i,b]=Object(o.useState)(""),[h,g]=Object(o.useState)(!1),[x]=Object(d.f)(z("withdraw_liquidity")),[f,p]=Object(o.useState)({});Object(o.useEffect)((()=>{le(x,f,g)}),[x,f]);Object(o.useEffect)((()=>{Object(u.BigNumber)(c).isZero()&&b("0"),Object(u.BigNumber)(i).isZero()&&s("0"),s(ce(Object(u.BigNumber)(e.token1Amount).times(r).shiftedBy(-2))),b(ce(Object(u.BigNumber)(e.token2Amount).times(r).shiftedBy(-2))),g(!1)}),[t,c,i,r,e.token1Amount,e.token2Amount]);const w=()=>{g(!1),n(!1),e.openRemoveLiquidity(!1)},v=t=>{a(t),(t=>{s(ce(Object(u.BigNumber)(e.token1Amount).times(t).shiftedBy(-2))),b(ce(Object(u.BigNumber)(e.token2Amount).times(t).shiftedBy(-2)))})(t),console.log("Remove Liquidity, updateState: ",c,i,e.token1Amount,e.token2Amount)};return Object(S.jsx)("div",{children:Object(S.jsx)(ht.a,{open:t,onClose:w,children:Object(S.jsxs)(m.a,{sx:{p:2,border:"0px solid",boxShadow:2},children:[Object(S.jsx)(k.a,{container:!0,sx:{mb:2},children:Object(S.jsx)(E,{name:"Remove Liquidity"})}),Object(S.jsxs)(Ot.a,{children:[Object(S.jsxs)(Te.a,{sx:{p:2,border:"0px solid",boxShadow:2,mb:2},children:[Object(S.jsx)(mt.a,{children:"Choose amount of liquidity shares to remove"}),Object(S.jsx)(m.a,{sx:{width:500,mt:3,ml:2},children:Object(S.jsxs)(k.a,{container:!0,spacing:2,alignItems:"center",children:[Object(S.jsx)(k.a,{item:!0,xs:!0,sx:{mt:2,ml:2,mr:2},children:Object(S.jsx)(gt.a,{"aria-label":"Custom marks",defaultValue:25,valueLabelDisplay:"auto",marks:[{value:0,label:"0%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:75,label:"75%"},{value:100,label:"100%"}],value:"number"===typeof r?r:0,onChange:(e,t)=>{v(t)},"aria-labelledby":"input-slider"})}),Object(S.jsx)(k.a,{item:!0,sx:{ml:2,mr:4},children:Object(S.jsx)(wt,{value:r,size:"small",onChange:e=>{let t=""===e.target.value?"":Number(e.target.value);v(t),console.log("handle input change")},onBlur:()=>{r<0?a(0):r>100&&a(100)},inputProps:{step:1,min:0,max:100,type:"number","aria-labelledby":"input-slider"}})})]})})]}),Object(S.jsxs)(Te.a,{sx:{p:2,border:"0px solid",boxShadow:2,mb:0},children:[Object(S.jsx)(xt.a,{title:"Amount Received",disableTypography:!0,sx:{fontSize:18,mt:0}}),Object(S.jsxs)(k.a,{item:!0,container:!0,alignItems:"center",spacing:2,sx:{width:400,ml:2},children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(jt.a,{direction:"row",spacing:0,alignItems:"center",children:[Object(S.jsx)(yt,{sx:{boxShadow:0,mr:1},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:e.token1Icon,alt:"",width:"32",height:"32"})}),Object(S.jsx)(yt,{sx:{boxShadow:0},children:Object(S.jsxs)(l.a,{sx:{fontSize:18},children:[e.token1Symbol,":"]})})]}),Object(S.jsxs)(jt.a,{direction:"row",spacing:0,alignItems:"center",children:[Object(S.jsx)(yt,{sx:{boxShadow:0,mr:1},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:e.token2Icon,alt:"",width:"32",height:"32"})}),Object(S.jsx)(yt,{sx:{boxShadow:0},children:Object(S.jsxs)(l.a,{sx:{fontSize:18},children:[e.token2Symbol,":"]})})]})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsxs)(jt.a,{children:[Object(S.jsx)(yt,{sx:{boxShadow:0},children:Object(S.jsx)(l.a,{sx:{fontSize:18},children:ce(c)})}),Object(S.jsx)(yt,{sx:{boxShadow:0},children:Object(S.jsx)(l.a,{sx:{fontSize:18},children:ce(i)})})]})})]})]})]}),Object(S.jsxs)(ft.a,{children:[Object(S.jsx)(y.a,{variant:"contained",style:{backgroundColor:"gray"},onClick:w,children:"Cancel"}),Object(S.jsx)(Le.a,{color:"primary",variant:"contained",disabled:!("0"!==c&&"0"!==i&&!h),loading:!0===h,loadingPosition:"start",startIcon:Object(S.jsx)(kt.a,{}),onClick:async()=>{console.log("Withdraw percent: ",r);let t=parseFloat(Object(j.b)(D))/100,n=Object(u.BigNumber)(e.balance).times(Object(u.BigNumber)(r)).shiftedBy(-2).toFixed(2,u.BigNumber.ROUND_DOWN),o=Object(u.BigNumber)(c).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(t).shiftedBy(-2))).toString(10,u.BigNumber.ROUND_DOWN),a=Object(u.BigNumber)(i).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(t).shiftedBy(-2))).toString(10,u.BigNumber.ROUND_DOWN);if(console.log("handleWithdraw: ",n,o,a),e.token1>e.token2){let e=o;o=a,a=e}g(!0);try{let t=await(async(e,t,n,o)=>{console.log("withdraw_liquidity");const r=Object(O.getStarknet)();let a=he();if(!1===r.isConnected||!a)return null;if(console.log("Calling Starknet: withdraw_liquidity with ",e,t,n,o),!Ce())return null;let c=await r.signer.invokeFunction(K,G,[ye(e),ye(t),ye(0),ye(n),ye(0),ye(o),ye(0)]);return fe(c.transaction_hash,"withdraw_liquidity"),c})(e.poolId,n,Ne(e.token1,o),Ne(e.token2,a));if(!t)throw Error("Cannot perform transaction");p((e=>({...e,[t.transaction_hash]:"new"})))}catch(s){ue("Remove Liquidity: User Aborted","error"),g(!1)}w()},children:h?"REMOVING":"REMOVE"})]})]})})})}const St=Object(bt.a)(dt.a)((({theme:e})=>({...e.typography.body2,padding:e.spacing(0),textAlign:"left",color:e.palette.text.secondary})));var Nt=function(e){const[t]=Object(d.f)(C),[n]=Object(d.f)(B),[r,a]=Object(o.useState)(!1);let c=n.get(e.poolId);if(!c||!c.shares)return Object(S.jsx)("div",{});const s=()=>{let o=n.get(e.poolId).token1;return t.get(o)},i=()=>s(e.poolId).symbol,b=()=>s(e.poolId).icon,j=()=>{let t=n.get(e.poolId);return t.shares?Object(u.BigNumber)(e.balance).div(Object(u.BigNumber)(t.shares)):"0"},h=()=>Ee(c.token1,(()=>{let t=n.get(e.poolId),o=j();return Object(u.BigNumber)(o).times(t.token1Amount)})()),O=()=>{let o=n.get(e.poolId).token2;return t.get(o)},m=()=>O(e.poolId).symbol,g=()=>O(e.poolId).icon,x=()=>Ee(c.token1,(()=>{let t=n.get(e.poolId),o=j();return Object(u.BigNumber)(o).times(t.token2Amount)})());return Object(S.jsxs)(Te.a,{sx:{p:2,border:"0px solid",boxShadow:2,mb:5},children:[Object(S.jsx)(l.a,{sx:{fontSize:18,fontWeight:"500"},children:"Your Position"}),Object(S.jsx)(st.a,{children:Object(S.jsxs)(k.a,{item:!0,container:!0,direction:"row",alignItems:"center",children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(jt.a,{direction:"row",spacing:0,alignItems:"center",children:[Object(S.jsx)(St,{sx:{boxShadow:0,mr:0},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:b(),alt:"",width:"32",height:"32"})}),Object(S.jsx)(St,{sx:{boxShadow:0,ml:-1,mr:1},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:g(),alt:"",width:"32",height:"32"})}),Object(S.jsx)(St,{sx:{boxShadow:0},children:Object(S.jsxs)(l.a,{sx:{fontSize:24,fontWeight:"normal"},color:"text.primary",gutterBottom:!0,children:[i()," / ",m(),":"]})})]}),Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"normal"},color:"text.primary",children:"Your Pool Share:"}),Object(S.jsxs)(l.a,{sx:{fontSize:16,fontWeight:"normal"},color:"text.primary",children:["Pooled ",i(),":"]}),Object(S.jsxs)(l.a,{sx:{fontSize:16,fontWeight:"normal"},color:"text.primary",children:["Pooled ",m(),":"]})]}),Object(S.jsxs)(k.a,{item:!0,xs:6,textAlign:"right",children:[Object(S.jsx)(l.a,{sx:{fontSize:24,fontWeight:"normal"},color:"text.primary",gutterBottom:!0,children:ce((()=>{let t=s().decimals,n=O().decimals,o=Math.floor((t+n)/2);return Object(u.BigNumber)(e.balance).shiftedBy(-o).toString(10)})())}),Object(S.jsxs)(l.a,{sx:{fontSize:16,fontWeight:"bold"},color:"text.primary",children:[ce(j(),!0),"%"]}),Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"bold"},color:"text.primary",children:ce(h())}),Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"bold"},color:"text.primary",children:ce(x())})]})]})}),Object(S.jsx)(ut.a,{children:Object(S.jsxs)(k.a,{item:!0,container:!0,justifyContent:"center",children:[Object(S.jsx)(y.a,{variant:"contained",sx:{textWeight:"bold"},onClick:()=>{a(!0)},children:"WITHDRAW"}),(()=>{if(r)return Object(S.jsx)(vt,{poolId:e.poolId,balance:e.balance,token1Symbol:i(),token2Symbol:m(),token1Icon:b(),token2Icon:g(),token1:s().address,token2:O().address,token1Amount:h(),token2Amount:x(),openRemoveLiquidity:a})})()]})})]})};var Et=function(){const[e]=Object(d.f)(B),[t]=Object(d.f)(A),[n,r]=Object(o.useState)((()=>new Map));return Object(He.a)((async()=>{n.forEach(((e,t)=>{Object(u.BigNumber)(e).isZero()||ge(t)}))}),6e4),Object(o.useEffect)((()=>{async function n(e){const n=await(async(e,t)=>{const n=Object(O.getStarknet)();if(!t)return null;if(!1===n.isConnected)throw Error("starknet wallet not connected");let o=await n.provider.callContract({contract_address:K,entry_point_selector:H,calldata:[ye(e),ye(t)]});return ke(o.result[0],o.result[1])})(e,t);n&&r((t=>{let o=new Map(t);return o.set(e,n),o}))}t&&e.forEach((e=>{n(e.id)}))}),[t,e]),Object(S.jsx)("div",{children:(()=>{let e=[];return n.forEach(((t,n)=>{Object(u.BigNumber)(t).isZero()||e.push(Object(S.jsx)(Nt,{poolId:n,balance:t},n))})),e})()})};var At=function(){const[e]=Object(d.f)(C),[t]=Object(d.f)(B),[n,r]=Object(o.useState)(""),[a,c]=Object(o.useState)(""),[s,i]=Object(o.useState)(""),[b,h]=Object(o.useState)(""),[g,x]=Object(o.useState)(0),[p]=Object(d.f)(A),[w,v]=Object(o.useState)(!1),[N,T]=Object(o.useState)(0),[I,W]=Object(o.useState)(!1),[D,L]=Object(o.useState)(!1),[M]=Object(d.f)(z("add_liquidity")),[R]=Object(d.f)(_),[F,U]=Object(o.useState)({});Object(o.useEffect)((()=>{tt("pools")}),[]),Object(o.useEffect)((()=>{console.log("Add Liquidity: called checkAndUpdateComponentTransactions ",F),le(M,F,v)}),[M,F]),Object(o.useEffect)((()=>{}),[R,t]),Object(o.useEffect)((()=>{if(n&&s){let e=Se(n,s);if(x(e),N<=1)if(e>0){let e=Be(n,s,a);void 0!==e&&h(e)}else h(0);else if(e>0){let e=Be(s,n,b);void 0!==e&&c(e)}else c(0)}}),[n,s,a,b,N,t]),Object(He.a)((async()=>{g>0?ge(g):(n&&xe(n),s&&xe(s))}),15e3);const G=(e,t)=>{const o=/^(([0-9]+[.]?[0-9]*)|([.][0-9]+))$/;e!==n||""!==t&&!o.test(t)||(c(t),T(1)),e!==s||""!==t&&!o.test(t)||(h(t),T(2))},H=async()=>{v(!0),nt("add-liquidity");let e=parseFloat(Object(j.b)(P))/100,t=Object(u.BigNumber)(a).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(e))).toString(10),o=Object(u.BigNumber)(b).times(Object(u.BigNumber)(1).minus(Object(u.BigNumber)(e))).toString(10);console.log("Add Liquidity slippage: ",e),console.log("Add Liquidity minAmountOut: ",t,Ne(n,t));try{let e=await(async(e,t,n,o,r,a)=>{console.log("AMM_add_liquidity: ",n,ye(n));const c=Object(O.getStarknet)();let s=he();if(!1===c.isConnected||!s)return null;if(!Ce())return null;let i=await c.signer.invokeFunction(K,q,[ye(e),ye(t),ye(0),ye(n),ye(0),ye(o),ye(r),ye(0),ye(a),ye(0)]);return console.log("add_liquidity: adding tx to pending transactions atom"),fe(i.transaction_hash,"add_liquidity"),i})(n,Ne(n,a),Ne(n,t),s,Ne(s,b),Ne(s,o));if(!e)throw Error("Cannot perform transaction");U((t=>({...t,[e.transaction_hash]:"new"}))),console.log("Add Liquidity: Setting component transaction ",typeof e.transaction_hash,F)}catch(r){ue("User abort","error"),v(!1)}},V=t=>{let n=[];return e.forEach(((e,o)=>{t!==o&&n.push(Object(S.jsx)(f.a,{value:o,children:Object(S.jsxs)(k.a,{container:!0,direction:"row",children:[Object(S.jsx)(k.a,{sx:{mr:1,mb:-1},children:Object(S.jsx)("img",{src:e.icon,alt:"",width:"24",height:"24"})}),Object(S.jsx)(k.a,{children:Object(S.jsx)(l.a,{children:e.symbol||e.address})})]})},o))})),n};return Object(S.jsxs)("div",{children:[Object(S.jsxs)(m.a,{sx:{p:2,border:"0px solid",mt:1,mb:4,boxShadow:2},children:[Object(S.jsx)(k.a,{container:!0,sx:{mb:4},children:Object(S.jsx)(E,{name:"Add Liquidity"})}),Object(S.jsxs)(k.a,{container:!0,spacing:2,children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(We.a,{fullWidth:!0,children:[Object(S.jsx)(Pe.a,{id:"token1-label",children:"Token 1:"}),Object(S.jsx)(De.a,{labelId:"token1-label",id:"token1-select",value:n,label:"Token 1",onChange:e=>{let t=e.target.value;r(t),W(!1),L(!1),xe(t),nt("pool-token1")},children:V(s)})]}),Object(S.jsx)(Ze,{token:n,amount:de(n),showMaxButton:!0,setMaxAmountHandler:G})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(We.a,{fullWidth:!0,children:Object(S.jsx)(ze.a,{helperText:"Amount to provide",id:"token1-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount1"},value:a||"",onChange:e=>G(n,e.target.value),error:je(n,a)===oe,disabled:""===n})})})]}),Object(S.jsxs)(k.a,{container:!0,spacing:2,sx:{mt:2},children:[Object(S.jsxs)(k.a,{item:!0,xs:6,children:[Object(S.jsxs)(We.a,{fullWidth:!0,children:[Object(S.jsx)(Pe.a,{id:"token2-label",children:"Token 2:"}),Object(S.jsx)(De.a,{labelId:"token2-label",id:"token2-select",value:s,label:"Token 2",onChange:e=>{let t=e.target.value;i(t),W(!1),L(!1),xe(t),nt("pool-token2")},children:V(n)})]}),Object(S.jsx)(Ze,{token:s,amount:de(s),showMaxButton:!0,setMaxAmountHandler:G})]}),Object(S.jsx)(k.a,{item:!0,xs:6,children:Object(S.jsx)(We.a,{fullWidth:!0,children:Object(S.jsx)(ze.a,{helperText:"Amount to provide",id:"token2-amount",inputProps:{variant:"outlined",placeholder:"0.00",type:"string",autoComplete:"off","aria-labelledby":"input-amount2"},value:b||"",onChange:e=>G(s,e.target.value),error:je(s,b)===oe,disabled:""===s})})})]}),(()=>{let o=t.get(g);if(!a||!b||!g||!o)return Object(S.jsx)("div",{});let r=e.get(n).symbol,c=e.get(s).symbol,i=be(g,s,n),d=be(g,n,s),j=o.token1===n?Object(u.BigNumber)(a).div(Object(u.BigNumber)(a).plus(Object(u.BigNumber)(Ee(o.token1,o.token1Amount)))):Object(u.BigNumber)(a).div(Object(u.BigNumber)(a).plus(Object(u.BigNumber)(Ee(o.token2,o.token2Amount))));return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(k.a,{children:Object(S.jsxs)(Te.a,{sx:{mb:2,mt:2,boxShadow:2},children:[Object(S.jsx)(st.a,{children:Object(S.jsx)(l.a,{sx:{fontSize:16,fontWeight:"500",mb:0},gutterBottom:!0,children:"Pool Prices and Share"})}),Object(S.jsx)(Te.a,{sx:{mb:0,mt:0},children:Object(S.jsxs)(k.a,{item:!0,container:!0,alignItems:"center",spacing:2,children:[Object(S.jsxs)(k.a,{item:!0,xs:4,children:[Object(S.jsx)(l.a,{sx:{textAlign:"center",lineHeight:2,mt:1,fontWeight:"bold"},children:ce(i)}),Object(S.jsxs)(l.a,{sx:{textAlign:"center",fontSize:12,mb:1},children:[r," for ",c]})]}),Object(S.jsxs)(k.a,{item:!0,xs:4,children:[Object(S.jsx)(l.a,{sx:{textAlign:"center",lineHeight:2,mt:1,fontWeight:"bold"},children:ce(d)}),Object(S.jsxs)(l.a,{sx:{textAlign:"center",fontSize:12,mb:1},children:[c," for ",r]})]}),Object(S.jsxs)(k.a,{item:!0,xs:4,children:[Object(S.jsxs)(l.a,{sx:{textAlign:"center",lineHeight:2,mt:1,fontWeight:"bold"},children:[ce(j,!0),"%"]}),Object(S.jsx)(l.a,{sx:{textAlign:"center",fontSize:12,mb:1},children:"Share of Pool"})]})]})})]})})})})(),Object(S.jsxs)(Te.a,{sx:{minWidth:275,mb:2,mt:3,boxShadow:2},children:[Object(S.jsx)(at,{secondary:"true"}),Object(S.jsx)(Je,{token:n,tokenAmount:a,activePoolId:g,tokenInRange:je(n,a)===re,approveTxStatusUpdateCallback:W}),Object(S.jsx)(Je,{token:s,tokenAmount:b,activePoolId:g,tokenInRange:je(s,b)===re,approveTxStatusUpdateCallback:L}),(()=>{let e=je(n,a),t=je(s,b);if(n&&s&&a>0&&b>0&&e===re&&t===re&&0!==g)return Object(S.jsx)(Le.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!(p&&ie(n,a)&&ie(s,b)||w||D&&ie(n,a)||I&&ie(s,b)),loading:w,loadingPosition:"start",startIcon:Object(S.jsx)(lt.a,{}),onClick:H,children:w?"ADDING LIQUIDITY":"ADD LIQUIDITY"});if(p&&n&&s&&a>0&&b>0&&(e!==re||t!==re))return Object(S.jsx)(Le.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,loading:e===ae||t===ae,loadingPosition:"start",startIcon:Object(S.jsx)(Ge.a,{}),children:e===oe||t===oe?"AMOUNT EXCEEDS WALLET BALANCE":"CHECKING WALLET BALANCE"});if(n&&s&&0===g)return Object(S.jsx)(y.a,{color:"primary",variant:"contained",fullWidth:!0,disabled:!0,children:"NOT A VALID Pool"});if(p){let e="";if(n||s||(e="SELECT TOKENS"),(!n&&s||n&&!s)&&(e="SELECT TOKEN"),!n||!s||a&&b||(e="ENTER AMOUNT"),""!==e)return Object(S.jsx)(y.a,{color:"secondary",variant:"contained",fullWidth:!0,disabled:!0,children:e})}return Object(S.jsx)("div",{})})()]})]}),Object(S.jsx)(Et,{})]})},Bt=n(47);Bt.b.register(Bt.a,Bt.e,Bt.f,Bt.d,Bt.g,Bt.h,Bt.c);var Ct=function(){return Object(S.jsx)("div",{children:Object(S.jsx)(k.a,{alignItems:"center",children:Object(S.jsx)(l.a,{variant:"subtitle1",align:"center",sx:{mt:20},style:{fontSize:40,fontWeight:"500",color:"gray",justifyContent:"center"},children:"Coming Soon"})})})},_t=n(295),Tt=n(328);var It=()=>{const[e,t]=Object(o.useState)(0);return Object(S.jsxs)(m.a,{children:[Object(S.jsxs)(_t.a,{sx:{mt:3,mb:2},value:e,onChange:(e,n)=>{t(n)},centered:!0,children:[Object(S.jsx)(Tt.a,{className:"swap-tab",label:"Swap",sx:{fontSize:18}}),Object(S.jsx)(Tt.a,{className:"provide-tab",label:"Pools",sx:{fontSize:18}}),Object(S.jsx)(Tt.a,{className:"chart-tab",label:"Charts",sx:{fontSize:18}})]}),0===e&&Object(S.jsx)(ct,{}),1===e&&Object(S.jsx)(At,{}),2===e&&Object(S.jsx)(Ct,{})]})};var Wt=function(e){return Object(S.jsx)("div",{children:Object(S.jsxs)(y.a,{sx:{mr:2},variant:"contained",onClick:()=>{window.open("https://goerli.voyager.online/tx/"+e.hash,"_blank")},children:["Tx ",ve(e.hash)," ",e.transactionStatus]})})};var Pt=function(){const[e]=Object(d.f)(T);return Object(He.a)((async()=>{e.forEach((async e=>{if(!e.dismiss){let t=await(async e=>{let t=await Object(O.getStarknet)().provider.getTransactionStatus(e),n=Object(j.b)(T);return n&&n.find((n=>n.hash===e&&n.status!==t.tx_status))?(console.log("getTransactionUpdate: ",t.tx_status,e),Object(j.c)(T,(n=>{let o=new Array;return n.forEach((n=>{if(console.log("Inside forEach: ",n.hash,n.status),n.hash===e){let e=Object.assign({},n);e.status=t.tx_status,"ACCEPTED_ON_L2"!==e.status&&"ACCEPTED_ON_L1"!==e.status||(e.dismiss=!0),o.push(e)}else o.push(n)})),o})),t.tx_status):null})(e.hash),n=e.type.split(/ |_/).map((e=>e[0].toUpperCase()+e.slice(1))).join(" ");null!==t&&(t.includes("RECEIVED")&&ue(n+" Transaction Sent","success"),t.includes("REJECTED")&&ue(n+" Transaction Rejected","error"),t.includes("PENDING")&&(ue(n+" Transaction Pending","success"),Oe(!1),me()),t.includes("ACCEPTED")&&ue(n+" Transaction Accepted","success"))}}))}),1e4),Object(S.jsx)(S.Fragment,{children:(()=>{let t=[];return e.forEach((e=>{e.dismiss||t.push(Object(S.jsx)(Wt,{hash:e.hash,transactionStatus:e.status,children:" "},e.hash))})),t})()})},Dt=n(302),zt=n(297);var Lt=function(e){const[t,n]=r.a.useState(e.open),o=(e,t)=>{"clickaway"!==t&&n(!1)};return Object(S.jsx)(Dt.a,{className:"toast",open:t,autoHideDuration:6e3,onClose:o,children:Object(S.jsx)(zt.a,{onClose:o,severity:e.type,sx:{width:"100%"},children:e.msg})})};var Mt=function(){const[e]=Object(d.f)(I);return Object(S.jsx)("div",{children:(()=>{let t=[];return e.forEach((e=>{e.dismiss||t.push(Object(S.jsx)(Lt,{open:!e.dismiss,msg:e.msg,type:e.type},e.hash))})),t})()})},Rt=n(147),Ft=n(18);var Ut=function(){const[e,t]=Object(o.useState)(new Map),[n,r]=Object(o.useState)([]),[a]=Object(d.f)(C),[c]=Object(d.f)(A),[b]=Object(d.f)(L),[j]=Object(d.f)(M),[u]=Object(d.f)(R),[h,O]=Object(o.useState)(!1);Object(o.useEffect)((()=>{console.log("minter tokens effect"),a.forEach(((n,o)=>{console.log(o),e.get(o)||t((e=>{let t=new Map(e);return t.set(o,0),t}))}))}),[a]);const g={0:"...",1:"WIPING",2:"WIPED"},x=()=>{console.log("waiting:",n);let e=[...n],t=e.shift();console.log("address: ",t),pe(t,"0"),r(e)};return Object(o.useEffect)((()=>{console.log("lastTxDone changed, val=",u," waitingToWipe=",n),u&&n.length>0&&x(),O(!1)}),[u]),Object(o.useEffect)((()=>{h&&u&&n.length>0&&x()}),[h]),Object(S.jsxs)(m.a,{children:[Object(S.jsx)(k.a,{container:!0,sx:{mt:2,mb:2},children:Object(S.jsx)(m.a,{sx:{flexGrow:1},children:Object(S.jsx)(s.a,{position:"static",children:Object(S.jsx)(i.a,{children:Object(S.jsx)(l.a,{children:"Wipe allowances"})})})})}),Object(S.jsxs)(k.a,{container:!0,spacing:2,sx:{},children:[Object(S.jsx)(k.a,{item:!0,xs:12,children:Object(S.jsx)(y.a,{color:"inherit",variant:"outlined",fullWidth:!0,disabled:!c,onClick:async()=>{console.log("will wipe..."),console.log(e.entries());let n=[];for(const o of e.entries()){console.log(o);let e=o[0],r=o[1];console.log("handleWipe address=",e," minted=",r);let c=a.get(e),s=j.get(e);console.log("token=",e," approvedAmount=",s),0===r&&c&&s&&"0"!==s&&(n.push((" "+e).slice(1)),console.log("xx=",n),t((t=>{let n=new Map(t);return n.set(e,1),n})))}r(n),O(!0)},children:c?"WIPE":"PLEASE CONNECT WALLET"})}),Object(S.jsx)(k.a,{item:!0,xs:12,children:(()=>{console.log("myTokensList!");let t=[];return e.forEach(((e,n)=>{let o=a.get(n),r=b.get(n),c=j.get(n);o&&t.push(Object(S.jsx)(Te.a,{sx:{mt:1},children:Object(S.jsxs)(k.a,{container:!0,direction:"row",children:[Object(S.jsx)(k.a,{sx:{mr:1,mb:-1},children:Object(S.jsx)("img",{src:o.icon,alt:"",width:"24",height:"24"})}),Object(S.jsx)(k.a,{children:Object(S.jsx)(l.a,{children:o.name||o.address})}),Object(S.jsx)(k.a,{sx:{ml:2},children:Object(S.jsxs)(l.a,{children:[" ","in wallet: ",r?"YES":"NONE"]})}),Object(S.jsx)(k.a,{sx:{ml:2},children:Object(S.jsxs)(l.a,{children:[" ","approved:"," ",c&&"0"!==c?"YES":"NO"]})}),Object(S.jsx)(k.a,{container:!0,direction:"row",justifyContent:"flex-end",sx:{mr:1,mt:-3},children:g[e]})]})},n))})),t})()}),"waiting to wipe:",Object(S.jsx)(k.a,{item:!0,xs:12,children:(()=>{let e=[];console.log(n);for(const t of n)e.push(Object(S.jsxs)("div",{children:["token ",t]}));return e})()})]})]})};var qt=function(){return Object(o.useEffect)((()=>{et.a.initialize("UA-215866683-1"),tt("/")}),[]),Object(o.useEffect)((()=>{(async()=>{(async()=>{const e=await fetch(`${_e}/amminfo`),t=await e.json();console.log("AMM info data:",t)})(),(async()=>{const e=await fetch(`${_e}/pools`),t=await e.json();let n=new Map;for(let o=1;o<=t.numberOfPools;o++){let e=t[o],r={id:o,name:e.poolName,token1:e.tokenAAddress,token1Amount:ke(e.tokenAReserves[0],e.tokenAReserves[1]),token2:e.tokenBAddress,token2Amount:ke(e.tokenBReserves[0],e.tokenBReserves[1]),fee:Number(e.feePercentage)/1e5,cfmm:Number(e.cfmm),shares:ke(e.shares[0],e.shares[1]),refresh:Date.now()};console.log("Pool = ",r),n.set(o,r)}Object(j.c)(B,n)})(),(async()=>{const e=await fetch(`${_e}/tokens`),t=await e.json();let n=new Map;for(let o=0;o<t.numberOfTokens;o++){let e=t[o],r={address:e.tokenAddress,id:o,name:e.tokenName,symbol:e.tokenSymbol,icon:e.tokenIcon,decimals:e.tokenDecimals};n.set(e.tokenAddress,r),console.log("Token = ",r)}Object(j.c)(C,n)})()})(),console.log("Finished updating static data"),Oe(!0)}),[]),Object(S.jsx)(Rt.a,{children:Object(S.jsxs)(d.a,{children:[Object(S.jsx)(j.a,{}),Object(S.jsxs)("div",{className:"App",children:[Object(S.jsx)(s.a,{position:"sticky",children:Object(S.jsxs)(i.a,{children:[Object(S.jsx)(l.a,{variant:"h4",color:"inherit",component:"div",sx:{flexGrow:1},children:"mySwap"}),Object(S.jsx)(Pt,{}),Object(S.jsx)(at,{})]})}),Object(S.jsxs)(Ft.c,{children:[Object(S.jsx)(Ft.a,{exact:!0,path:"/",children:Object(S.jsx)(b.a,{maxWidth:"sm",children:Object(S.jsx)(It,{})})}),Object(S.jsx)(Ft.a,{path:"/charts",children:Object(S.jsx)(Ct,{})}),Object(S.jsx)(Ft.a,{path:"/wipe",children:Object(S.jsx)(b.a,{maxWidth:"sm",children:Object(S.jsx)(Ut,{})})})]}),Object(S.jsx)(Mt,{})]})]})})},Gt=n(293);console.log=()=>{},c.a.render(Object(S.jsx)(r.a.StrictMode,{children:Object(S.jsx)(Gt.a,{children:Object(S.jsx)(qt,{})})}),document.getElementById("root"))}},[[240,1,2]]]);
//# sourceMappingURL=main.8802005e.chunk.js.map