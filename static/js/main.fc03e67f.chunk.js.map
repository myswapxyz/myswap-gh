{"version":3,"sources":["../node_modules/typescript/lib sync","components/BoxHeader.js","atoms.ts","services/amm.ts","services/static_data.ts","components/Approve.js","components/Balance.js","services/wallet.service.ts","services/ga.js","components/ConnectWallet.js","components/Swap.js","components/RemoveLiquidity.js","components/LiquidityPool.js","components/Positions.js","components/Provide.js","components/Charts.js","components/Main.js","components/PendingTransaction.js","components/PendingTransactions.js","components/Toast.js","components/Toasts.js","components/Info.js","components/Minter.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","DEFAULT_SLIPPAGE","BoxHeader","props","useState","slippage","setSlippage","anchorEl","setAnchorEl","handleClose","name","setRecoil","swapSlippage","addLiquiditySlippage","withdrawLiquiditySlippage","console","log","Box","sx","flexGrow","AppBar","position","Toolbar","IconButton","size","edge","color","aria-label","onClick","event","currentTarget","mr","right","Typography","variant","component","Menu","boxShadow","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","PaperProps","style","width","open","Boolean","onClose","MenuItem","fontSize","fontWeight","Input","ml","mb","value","onChange","target","onKeyPress","key","inputProps","step","min","max","type","Grid","item","container","justifyContent","Button","textWeight","mt","walletAddressState","atom","default","poolsState","Map","tokensState","tokensUserDataState","pendingTxsState","Array","toastsState","transactionsStatusSelector","selectorFamily","get","componentName","pendingTx","filter","t","walletAmountsSelector","selector","r","forEach","tud","address","undefined","userBalance","token","decimals","set","lastTxDoneSelector","userApproved","tx","hash","status","done","includes","safeToSendTxSelector","n","length","swapSelector","stark","getSelectorFromName","addLiquiditySelector","withdrawLiquiditySelector","getLPBalanceSelector","amm_contract","amm_contract_decimal","BigNumber","toString","selector_get_total_number_of_pools","selector_get_pool","selector_get_total_shares","approveSelector","mintSelector","selector_name","selector_symbol","selector_balanceOf","selector_allowance","selector_decimals","WALLET_SUFFICIENT_BALANCE","numFormat","num","isPercent","res","shiftedBy","sd","ROUND_DOWN","toPrecision","lt","toFixed","tokenAllowanceForAMM","ret","getRecoil","isTokenApproved","amount","tokenAllowance","gte","float_to_decimal_int","checkAndUpdateComponentTransactions","transactionsStatus","componentTxs","setAddLiquidityInProgress","hasOwnProperty","some","s","getPoolPriceForTokenA","poolId","token_in","token_out","otherAmount","pools","pool","ratio","token1","token2Amount","decimal_int_to_float","times","div","token1Amount","getWalletTokenAmount","activeAccount","walletAddress","isSufficientBalanceInWallet","tokenWalletAmount","isPositive","lte","addToastMsg","msg","dismiss","random","current","updatePoolsAndTokens","alsoUpdateTokens","a","starknet","getStarknet","provider","callContract","contract_address","entry_point_selector","calldata","numPools","Number","result","tokens","new_pools","new_tokens","i","currentPool","refresh","Date","now","SECS_TO_REFRESH_POOL_DATA","data","shares","hex_to_ascii","composeUInt256","token2","fee","cfmm","symbol","icon","promises","p","then","push","p1","p2","Promise","allSettled","updateAllTokensDynamicData","_","updateTokenDynamicData","updatePoolDynamicData","isConnected","token_address","tokensDynamic","current_token","t_thresh","currentTud","newMap","ammBalance","balance","numberToCallParam","p3","addPendingTx","approve","tokenFrom","safeToSend","signer","invokeFunction","transaction_hash","ERC20_mint","swap","swapAmount","minAmountOut","getLPBalance","pool_id","low","high","plus","pow","str1","hex","substr","str","String","fromCharCode","parseInt","human_readable_hash","getTransactionUpdate","getTransactionStatus","pendingTxs","find","tx_status","currTxs","tx_","Object","assign","getPoolIdFromTokens","sortTokens","t1","t2","calcOtherTokenAmount","token_leading","token_other","token_leading_amount_float","leading_token_number","token_leading_amount","token_leading_reserve","token_other_reserve","minus","calcOtherTokenRequiredAmountForLiquidity","token_a","token_b","token_a_float","token_a_amount","price","add_liquidity","token_a_address","token_a_min_amount","token_b_address","token_b_amount","token_b_min_amount","withdraw_liquidity","SERVER_URL","updatePoolsAndTokensStatic","fetchAmmInfo","fetch","json","fetchPools","numberOfPools","d","poolName","tokenAAddress","tokenAReserves","tokenBAddress","tokenBReserves","feePercentage","fetchTokens","numberOfTokens","tokenAddress","tokenName","tokenSymbol","tokenIcon","tokenDecimals","DEFAULT_APPROVE_AMOUNT","BigInt","Approve","useRecoilState","connectedAddress","tokenApproveInProgress","setTokenApproveInProgress","setComponentTxs","useEffect","tokenAmount","activePoolId","tokenInRange","handleApproveToken","approveAmount","prevState","token_obj","LoadingButton","fullWidth","loading","loadingPosition","startIcon","Balance","showMaxButton","setMaxAmountHandler","walletAmount","connectWallet","showModal","enable","networkId","baseUrl","getExplorerUrlBase","addWalletChangeListener","handleEvent","on","GApage","page","ReactGA","pageview","GAbutton","label","cat","action","category","GAtrack","ConnectWallet","walletConnectionStatus","setWalletConnectionStatus","voyagerBaseUrl","setVoyagerBaseUrl","networkName","setNetworkName","changeListenerRegistered","setChangeListenerRegistered","setAddress","handleClick","secondary","handleWalletChange","accounts","disabled","className","handleConnectedClick","window","fill","MAX_SAFE_INTEGER","Swap","setActivePoolId","setToken1","setToken1Amount","setToken2","setToken2Amount","leadingToken","setLeadingToken","swapInProgress","setSwapInProgress","tuds","updateTokensIntervalCallback","useInterval","handleTokenAmountChange","regex","test","menuItems","otherSelectedToken","direction","src","alt","height","calcToken2MinAmount","parseFloat","handleSwap","priceDirection","setPriceDirection","border","Card","spacing","xs","FormControl","InputLabel","Select","labelId","TextField","helperText","placeholder","autoComplete","error","alignItems","tmpToken","tmpAmount","isZero","currentPrice","minAmount","token1Symbol","token2Symbol","floatSlippage","transactionPrice","transactionPriceInv","priceImpact","backgroundColor","gt","displayPrice1","displayPrice2","CardActionArea","priceAndSlippage","minWidth","token1SufficientBalance","token2InsufficientPoolBalance","floatAmount","decimalAmount","isInsufficientBalanceInPool","instruction","swapButton","Item","styled","Paper","theme","typography","body2","padding","textAlign","palette","text","MuiInput","RemoveLiquidity","setOpen","percent","setPercent","removeLiquidityInProgress","setRemoveLiquidityInProgress","updateState","newPercent","setAmounts","handleWithdraw","sharesToWithdraw","minToken1Amount","minToken2Amount","Dialog","DialogContent","DialogContentText","Slider","defaultValue","valueLabelDisplay","marks","aria-labelledby","onBlur","CardHeader","title","disableTypography","Stack","token1Icon","token2Icon","DialogActions","LiquidityPool","userPoolShare","userToken1Amount","user_share","userToken1AmountDecimal","userToken2Amount","userToken2AmountDecimal","CardContent","gutterBottom","CardActions","Positions","userPools","setUserPools","prev","m","fetchBalance","allPools","Provide","addLiquidityInProgress","handleAddLiquidity","minAmount1Out","minAmount2Out","symbol1","symbol2","priceForToken1","priceForToken2","pool_share","lineHeight","priceAndShare","token2SufficientBalance","addLiquidityButton","ChartJS","register","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","Charts","labels","datasets","datasetIdKey","Main","selectedTab","setSelectedTab","Tabs","newValue","centered","Tab","PendingTransaction","transactionStatus","PendingTransactions","txs","updateTransactionsStatus","pendingTransactions","Toast","React","reason","Snackbar","autoHideDuration","Alert","severity","Toasts","toasts","allActiveToasts","activeToasts","Info","options","responsive","plugins","legend","display","Minter","mintAmount","setMintAmount","mintedTokens","setMintedTokens","waitingToMint","setWaitingToMint","walletAmounts","lastTxDone","mintedState","0","1","2","mintNextToken","x","shift","handleMint","entries","entry","minted","curr","mintedTokensList","waitingToMintList","App","initialize","updateAMMIntervalCallback","RecoilNexus","exact","path","Container","maxWidth","ReactDOM","render","StrictMode","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.fc03e67f.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 166;","import React, { useState } from 'react'\nimport { setRecoil } from 'recoil-nexus'\nimport { swapSlippage, addLiquiditySlippage, withdrawLiquiditySlippage } from '../atoms'\nimport {\n    MenuItem,\n    Typography,\n    AppBar,\n    Box,\n    Toolbar,\n    IconButton,\n    Input,\n    Button,\n    Grid,\n    Menu\n} from '@mui/material'\nimport SettingsIcon from '@mui/icons-material/Settings'\n\nexport const DEFAULT_SLIPPAGE = '0.50'\n\nfunction BoxHeader(props) {\n    const [slippage, setSlippage] = useState(DEFAULT_SLIPPAGE)\n    const [anchorEl, setAnchorEl] = useState(null)\n\n    const handleSlippageChange = (event) => {\n        setSlippage(event.target.value)\n    }\n\n    const handleMenu = (event) => {\n        setAnchorEl(event.currentTarget)\n    }\n\n    const handleClose = () => {\n        if (props.name === 'Swap') setRecoil(swapSlippage, slippage)\n        if (props.name === 'Add Liquidity') setRecoil(addLiquiditySlippage, slippage)\n        if (props.name === 'Remove Liquidity')\n            setRecoil(withdrawLiquiditySlippage, slippage)\n\n        console.log('Slippage set to: ', slippage)\n        setAnchorEl(null)\n    }\n\n    return (\n        <Box sx={{ flexGrow: 1 }}>\n            <AppBar position='static'>\n                <Toolbar>\n                    <IconButton\n                        size='large'\n                        edge='start'\n                        color='inherit'\n                        aria-label='menu'\n                        onClick={handleMenu}\n                        sx={{ mr: 2, position: 'absolute', right: '0%' }}>\n                        <SettingsIcon></SettingsIcon>\n                    </IconButton>\n                    <Typography variant='h6' component='div' sx={{ flexGrow: 1 }}>\n                        {props.name}\n                    </Typography>\n                    <div>\n                        <Menu\n                            id='menuAppBar'\n                            sx={{ boxShadow: 1 }}\n                            anchorEl={anchorEl}\n                            anchorOrigin={{\n                                vertical: 'top',\n                                horizontal: 'right'\n                            }}\n                            keepMounted\n                            transformOrigin={{\n                                vertical: 'top',\n                                horizontal: 'right'\n                            }}\n                            PaperProps={{\n                                style: {\n                                    width: 250\n                                }\n                            }}\n                            open={Boolean(anchorEl)}\n                            onClose={handleClose}>\n                            <MenuItem sx={{ fontSize: 14, fontWeight: 'bold' }}>\n                                Transaction Settings\n                            </MenuItem>\n                            <MenuItem>\n                                Set Slippage\n                                <Input\n                                    sx={{ ml: 3, mb: 0 }}\n                                    value={slippage}\n                                    size='small'\n                                    onChange={handleSlippageChange}\n                                    onKeyPress={(event) => {\n                                        if (event.key === 'Enter') handleClose()\n                                    }}\n                                    inputProps={{\n                                        step: 0.01,\n                                        min: 0,\n                                        max: 100,\n                                        type: 'number',\n                                        'aria-labelledby': 'input-slider'\n                                    }}\n                                />\n                            </MenuItem>\n                            <Grid item container justifyContent='center'>\n                                <Button\n                                    variant='contained'\n                                    size='small'\n                                    sx={{ textWeight: 'bold', mt: 1 }}\n                                    onClick={handleClose}>\n                                    OK\n                                </Button>\n                            </Grid>\n                        </Menu>\n                    </div>\n                </Toolbar>\n            </AppBar>\n        </Box>\n    )\n}\n\nexport default BoxHeader\n","import { atom, selector, selectorFamily } from 'recoil'\nimport { DEFAULT_SLIPPAGE } from './components/BoxHeader'\n\n//const { persistAtom } = recoilPersist() // not currently used\n\nexport interface Pool {\n    id: number\n    name: string\n    token1: string\n    token1Amount: string // dynamic TODO: | undefined\n    token2: string\n    token2Amount: string // dynamic TODO: | undefined\n    refresh: number // when is the last time we refreshed this pool's data\n    fee: number\n    shares: string\n    cfmm: number\n}\n\n// static Token data\nexport interface Token {\n    name: string\n    symbol: string\n    address: string\n    decimals: number\n    id: number\n    icon: string // url\n}\n\n// dynamic Token data\nexport interface TokenUserData {\n    address: string\n    ammBalance: string | undefined\n    userBalance: string | undefined\n    userApproved: string | undefined\n    refresh: number // when is the last time we refreshed the user data for this token\n}\n\nexport interface Transaction {\n    hash: string\n    type: string\n    status: string\n    dismiss: boolean // TODO : remove\n    // TODO add acceptance time\n}\n\nexport interface ToastMsg {\n    msg: string\n    type: string\n    dismiss: boolean\n    hash: string // for uniqueness\n}\n\nexport const walletAddressState = atom({\n    key: 'walletAddressState',\n    default: ''\n})\n\nexport const isWalletConnectedState = atom({\n    key: 'isWalletConnectedState',\n    default: 0 // 0-not connected, 1=being connected, 2=connected\n})\n\nexport const poolsState = atom({\n    key: 'poolsState',\n    //    effects_UNSTABLE: [persistAtom],\n    default: new Map<number, Pool>()\n})\n\nexport const tokensState = atom({\n    key: 'tokensState',\n    //  effects_UNSTABLE: [persistAtom],\n    default: new Map<string, Token>()\n})\n\nexport const tokensUserDataState = atom({\n    key: 'tokensUserDataState',\n    default: new Map<string, TokenUserData>()\n})\n\nexport const pendingTxsState = atom({\n    key: 'pendingTxsState',\n    default: new Array<Transaction>()\n})\n\nexport const toastsState = atom({\n    key: 'toastsState',\n    default: new Array<ToastMsg>()\n})\n\nexport const swapSlippage = atom({\n    key: 'swapSlippage',\n    default: DEFAULT_SLIPPAGE\n})\n\nexport const addLiquiditySlippage = atom({\n    key: 'addLiquiditySlippage',\n    default: DEFAULT_SLIPPAGE\n})\n\nexport const withdrawLiquiditySlippage = atom({\n    key: 'withdrawLiquiditySlippage',\n    default: DEFAULT_SLIPPAGE\n})\n\n\n// Selectors\n\nexport const transactionsStatusSelector = selectorFamily ({\n    key: 'transactionsStatusSelector',\n    get: (componentName: string) => ({ get }): Array<Transaction> | undefined => {\n        let pendingTx = get(pendingTxsState)\n        if (pendingTx)\n            return pendingTx.filter(t => t.type === componentName)\n        return undefined\n    }\n})\n\nexport const walletAmountsSelector = selector({\n    key: 'walletAmountsSelector',\n    get: ({ get }): Map<string, string> => {\n        let r = new Map<string, string>()\n        get(tokensUserDataState).forEach((tud, address) => {\n            if (tud.userBalance !== undefined) {\n                let token = get(tokensState).get(address)\n                if (token && token.decimals) {\n                    r.set(address, tud.userBalance)\n                }\n            }\n        })\n        return r\n    }\n})\n\nexport const walletAllowanceSelector = selector({\n    key: 'walletAllowanceSelector',\n    get: ({ get }): Map<string, string> => {\n        let r = new Map<string, string>()\n        get(tokensUserDataState).forEach((tud, address) => {\n            if (tud.userApproved !== undefined) {\n                let token = get(tokensState).get(address)\n                if (token && token.decimals) {\n                    r.set(address, tud.userApproved)\n                }\n            }\n        })\n        return r\n    }\n})\n\nexport const pendingTxSelector = selector({\n    key: 'pendingTxSelector',\n    get: ({ get }): Map<string, string> => {\n        let r = new Map<string, string>()\n        get(pendingTxsState).forEach((tx) => {\n            r.set(tx.hash, tx.status)\n        })\n        return r\n    }\n})\n\nexport const lastTxDoneSelector = selector({\n    key: 'lastTxDoneSelector',\n    get: ({ get }): boolean => {\n        let done = true\n        get(pendingTxsState).forEach((tx) => {\n            done = false\n            if (tx.status === 'RECEIVED' || tx.status.includes('ACCEPTED')) done = true // Yaron: what about rejected\n        })\n        return done\n    }\n})\n\nexport const safeToSendTxSelector = selector({\n    key: 'safeToSendTxSelector',\n    get: ({ get }): boolean => {\n        const n = get(pendingTxsState).length\n        if (n === 0) return true\n\n        const tx = get(pendingTxsState)[n - 1]\n        if (tx.status.includes('REJECTED') || tx.status.includes('ACCEPTED')) return true //TODO: once Argent fix starknet.js, we need to add 'PENDING' as well\n\n        return false\n    }\n})\n","import { getRecoil, setRecoil } from 'recoil-nexus'\nimport { BigNumber } from 'bignumber.js'\nimport { stark } from 'starknet'\nimport { getStarknet } from '@argent/get-starknet'\n\nimport {\n    walletAddressState,\n    poolsState,\n    tokensState,\n    tokensUserDataState,\n    Pool,\n    Token,\n    TokenUserData,\n    pendingTxsState,\n    Transaction,\n    ToastMsg,\n    toastsState,\n    safeToSendTxSelector\n} from '../atoms'\n\n\n\n// amm\nconst swapSelector = stark.getSelectorFromName('swap')\nconst addLiquiditySelector = stark.getSelectorFromName('add_liquidity')\nconst withdrawLiquiditySelector = stark.getSelectorFromName('withdraw_liquidity')\nconst getLPBalanceSelector = stark.getSelectorFromName('get_lp_balance')\nconst amm_contract = '0x008fb0ec84a7025839faafbf9eeee6b6e9957d50bd418a334d00740fbb9f6170'\nconst amm_contract_decimal = BigNumber(amm_contract).toString(10)\n\nconst selector_get_total_number_of_pools = stark.getSelectorFromName(\n    'get_total_number_of_pools'\n)\nconst selector_get_pool = stark.getSelectorFromName('get_pool')\nconst selector_get_total_shares = stark.getSelectorFromName('get_total_shares')\n//const selector_get_pool_token_balance = stark.getSelectorFromName(\"get_pool_token_balance\")\n\n// ERC20\nconst approveSelector = stark.getSelectorFromName('approve')\nconst mintSelector = stark.getSelectorFromName('mint')\n\nconst selector_name = stark.getSelectorFromName('name')\nconst selector_symbol = stark.getSelectorFromName('symbol')\nconst selector_balanceOf = stark.getSelectorFromName('balanceOf')\nconst selector_allowance = stark.getSelectorFromName('allowance')\nconst selector_decimals = stark.getSelectorFromName('decimals')\n\nconst SECS_TO_REFRESH_POOL_DATA = 60\n\nexport const WALLET_SUFFICIENT_BALANCE = {\n    FALSE: 0,\n    TRUE: 1,\n    UNKNOWN: 2\n}\n\nconst is_dev = () : boolean => {\n    //return (process.env.NODE_ENV) === 'development'\n    return false\n}\n\n\nexport const numFormat = (num: string, isPercent = false): string => {\n    if (num === undefined || num === '' ) return ''\n\n    if (isPercent) {\n        let res = BigNumber(num).shiftedBy(2).sd(4, BigNumber.ROUND_DOWN).toPrecision(4)\n        if (BigNumber(res).lt(0.01)) return '<0.01'\n        return res\n    }\n\n    if (BigNumber(num).lt(1)) {\n        // BigNumber(0.012340000).sd(2).toString(10) --> '0.012'\n        let res = BigNumber(num).sd(6).toFixed(18, BigNumber.ROUND_DOWN)    // FIXME: need to align to token decimals (not 18).... 6 is a magic number...\n        // patch:\n        return BigNumber(res).toString(10)\n    }\n    return BigNumber(num).toFixed(2)\n}\n\n\nexport const tokenAllowanceForAMM = (token: string) => {\n    let ret = null\n    if (token) {\n        let tokensUserData = getRecoil(tokensUserDataState)\n        let tud = tokensUserData.get(token)\n        if (tud) {\n            ret = tud.userApproved\n            console.log('tokenAllowanceForAMM tud.userApproved = ', tud.userApproved)\n        }\n    }\n    return ret\n}\n\nexport const isTokenApproved = (token: string, amount: string): boolean => {\n    // Yaron: why do we need try-catch here? this is not an async function, how can it fail?\n    try {\n        let tokenAllowance = tokenAllowanceForAMM(token)    // should return a string\n        if (\n            tokenAllowance &&\n            BigNumber(tokenAllowance).gte(BigNumber(float_to_decimal_int(token, amount)))\n        ) {\n            return true\n        }\n    } catch (e) {}\n    return false\n}\n\n\nexport const checkAndUpdateComponentTransactions = (\n    transactionsStatus: Array<Transaction>,\n    componentTxs: Record<string, string>,\n    setAddLiquidityInProgress: (b: boolean) => any\n) => {\n    if (transactionsStatus) {\n        transactionsStatus.forEach((tx) => {\n            console.log('checkAndUpdateComponentTransactions: ', tx.status, tx.hash)\n\n            // check if transaction was already handled\n            if (componentTxs.hasOwnProperty(tx.hash)) {\n                if (\n                    ['REJECTED', 'PENDING', 'ACCEPTED'].some((s) => tx.status.includes(s))\n                ) {\n                    setAddLiquidityInProgress(false)\n                    delete componentTxs[tx.hash]\n                }\n            }\n        })\n    }\n}\n\n\nexport const getPoolPriceForTokenA = (poolId: number, token_in: string, token_out: string, otherAmount='1'): string => {\n    let pools = getRecoil(poolsState)\n    let pool = pools.get(poolId)\n    let ratio = BigNumber(1.0)\n\n    if (pool) {\n\n        if (pool.token1 === token_in) {\n            console.log('here',pool.token2Amount)\n            ratio = BigNumber(decimal_int_to_float(token_out, pool.token2Amount)).times(BigNumber(otherAmount)).div(\n                BigNumber(decimal_int_to_float(token_in, pool.token1Amount))\n            )\n        } else {\n            ratio = BigNumber(decimal_int_to_float(token_out, pool.token1Amount)).times(BigNumber(otherAmount)).div(\n                BigNumber(decimal_int_to_float(token_in, pool.token2Amount))\n            )\n        }\n    }\n    console.log('Ratio', ratio.toString(10))\n    return ratio.toString(10)\n}\n\n\nexport const getWalletTokenAmount = (token: string) : string => {\n    if (is_dev()) console.log('amm: getWalletTokemAmount, token=',token)\n\n    let activeAccount: string = walletAddress()\n    let tokensUserData = getRecoil(tokensUserDataState)\n    let tud = tokensUserData.get(token)     // expecting that tud values will be strings\n\n    if (!activeAccount || !token || !tud || tud.userBalance === undefined) return ''\n\n    return decimal_int_to_float(token, tud.userBalance)\n}\n\n\nexport const isSufficientBalanceInWallet = (token: string, amount: string) => {\n\n    if (is_dev()) console.log('amm: isSufficientBalanceInWallet, token=',token,' amount=',amount)\n\n\n    let activeAccount: string = walletAddress()\n    let tokensUserData = getRecoil(tokensUserDataState)\n    let tud = tokensUserData.get(token)\n\n    if (!activeAccount) return WALLET_SUFFICIENT_BALANCE.UNKNOWN\n    if (!token) return WALLET_SUFFICIENT_BALANCE.UNKNOWN\n    if (!amount) return WALLET_SUFFICIENT_BALANCE.TRUE\n    if (!tud) return WALLET_SUFFICIENT_BALANCE.UNKNOWN\n    if (tud.userBalance === undefined) return WALLET_SUFFICIENT_BALANCE.UNKNOWN\n\n    // The actual check:\n    let tokenWalletAmount = decimal_int_to_float(token, tud.userBalance)\n\n    if (\n        BigNumber(amount).isPositive() &&\n        BigNumber(amount).lte(BigNumber(tokenWalletAmount))\n    )\n        return WALLET_SUFFICIENT_BALANCE.TRUE\n\n    return WALLET_SUFFICIENT_BALANCE.FALSE\n}\n\nexport const isInsufficientBalanceInPool = (\n    poolId: number,\n    token: string,\n    floatAmount: string\n) : boolean => {\n\n    if (is_dev()) console.log('amm: isInsufficientBalanceInPool, pool=',poolId,' token=',token,' amount=',floatAmount)\n\n    if (!token || poolId <= 0) return false\n\n    let pools = getRecoil(poolsState)\n    let pool: Pool | undefined = pools.get(poolId)\n    if (!pool) throw Error('missing pool ' + poolId)\n\n    let decimalAmount = float_to_decimal_int(token, floatAmount)\n\n    if (pool.token1 === token) {\n        return BigNumber(decimalAmount).gt(BigNumber(pool.token1Amount))\n    } else {\n        return BigNumber(decimalAmount).gt(BigNumber(pool.token2Amount))\n    }\n}\n\nexport const addToastMsg = (msg: string, type: string) => {\n    let t: ToastMsg = { msg: msg, type: type, dismiss: false, hash: BigNumber.random(10).times(1e10).toString(16) }\n    setRecoil(toastsState, (current: Array<ToastMsg>) => {\n        return [...current, t]\n    })\n}\n\nconst walletAddress = () => {\n    return getRecoil(walletAddressState)\n}\n\nexport const updatePoolsAndTokens = async (alsoUpdateTokens: boolean): Promise<any> => {\n    console.log('updatePoolsAndTokens')\n    if (is_dev()) addToastMsg('updatePoolsAndTokens, tokens='+alsoUpdateTokens, 'info')\n\n    const starknet = getStarknet()\n\n    let r = await starknet.provider.callContract({\n        contract_address: amm_contract,\n        entry_point_selector: selector_get_total_number_of_pools,\n        calldata: []\n    })\n\n    let numPools = Number(r.result[0])\n    let pools = getRecoil(poolsState)\n    let tokens = getRecoil(tokensState)\n    let new_pools = new Map<number, Pool>()\n    let new_tokens = new Map(tokens)\n\n    for (let i = 1; i <= numPools; i++) {\n        let currentPool = pools.get(i)\n        if (\n            currentPool &&\n            currentPool.refresh > Date.now() - SECS_TO_REFRESH_POOL_DATA * 1000\n        ) {\n            new_pools.set(i, currentPool)\n            continue // don't refresh\n        }\n\n        let data = await starknet.provider.callContract({\n            contract_address: amm_contract,\n            entry_point_selector: selector_get_pool,\n            calldata: [i.toString()]\n        })\n\n        let shares = await starknet.provider.callContract({\n            contract_address: amm_contract,\n            entry_point_selector: selector_get_total_shares,\n            calldata: [i.toString()]\n        })\n\n        console.log(data)\n        let pool: Pool = {\n            id: i,\n            name: hex_to_ascii(data.result[0]),\n            token1: data.result[1],\n            token1Amount: composeUInt256(data.result[2], data.result[3]),\n            token2: data.result[4],\n            token2Amount: composeUInt256(data.result[5], data.result[6]),\n            fee: Number(data.result[7]) / 1e5,\n            cfmm: Number(data.result[8]),\n            shares: composeUInt256(shares.result[0], shares.result[1]),\n            refresh: Date.now()\n        }\n        new_pools.set(i, pool)\n\n        if (alsoUpdateTokens) {\n            if (!new_tokens.get(pool.token1)) {\n                let n = new_tokens.size\n                console.log('new token1 n=', n)\n                let t: Token = {\n                    address: pool.token1,\n                    id: n,\n                    name: '',\n                    symbol: '',\n                    icon: '',\n                    decimals: 0\n                }\n                new_tokens.set(pool.token1, t)\n            }\n            if (!new_tokens.get(pool.token2)) {\n                let n = new_tokens.size\n                console.log('new token2 n=', n)\n                let t: Token = {\n                    address: pool.token2,\n                    id: n,\n                    name: '',\n                    symbol: '',\n                    icon: '',\n                    decimals: 0\n                }\n                new_tokens.set(pool.token2, t)\n            }\n        }\n    }\n\n    // fetch token names and precision\n    if (alsoUpdateTokens) {\n        let promises: Array<Promise<any>> = []\n        new_tokens.forEach((value: Token, address: string) => {\n            let p = starknet.provider\n                .callContract({\n                    contract_address: address,\n                    entry_point_selector: selector_name,\n                    calldata: []\n                })\n                .then((data: any) => {\n                    const name = hex_to_ascii(data.result[0])\n                    console.log('name=', name)\n                    value.name = name\n                })\n            promises.push(p)\n            let p1 = starknet.provider\n                .callContract({\n                    contract_address: address,\n                    entry_point_selector: selector_symbol,\n                    calldata: []\n                })\n                .then((data: any) => {\n                    const name = hex_to_ascii(data.result[0])\n                    console.log('symbol=', name)\n                    value.symbol = name\n                })\n            promises.push(p1)\n\n            let p2 = starknet.provider\n                .callContract({\n                    contract_address: address,\n                    entry_point_selector: selector_decimals,\n                    calldata: []\n                })\n                .then((data: any) => {\n                    const decimals = Number(data.result[0])\n                    value.decimals = decimals\n                })\n            promises.push(p2)\n        })\n        await Promise.allSettled(promises)\n\n        // update tokens in recoil (before pools!)\n        setRecoil(tokensState, new_tokens)\n        console.log('tokens=', new_tokens)\n    }\n\n    // update pools in recoil\n    setRecoil(poolsState, new_pools)\n}\n\nexport const updateAllTokensDynamicData = async (): Promise<any> => {\n    let tokens = getRecoil(tokensState)\n    tokens.forEach((_, token) => {\n        console.log('updateAllTokensDynamicData: token=', token)\n        updateTokenDynamicData(token)\n    })\n}\n\nexport const updatePoolDynamicData = async (poolId: number): Promise<any> => {\n    console.log('updatePoolDynamicData')\nif (is_dev()) addToastMsg('updatePoolDynamicData, pool='+poolId, 'info')\n\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n\n    let pools = getRecoil(poolsState)\n    let tokens = getRecoil(tokensState)\n\n    const starknet = getStarknet()\n\n    // checks that enable succeeded\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    let pool: Pool | undefined = pools.get(poolId)\n    if (!pool) throw Error('unknown pool ' + poolId)\n\n    let token1: Token | undefined = tokens.get(pool.token1)\n    let token2: Token | undefined = tokens.get(pool.token2)\n    if (!token1) throw Error('missing token ' + pool.token1)\n    if (!token2) throw Error('missing token ' + pool.token2)\n\n    // so far everything must have been stored in recoil\n    // now we update dynamic data: per token in pool\n    updateTokenDynamicData(pool.token1)\n    updateTokenDynamicData(pool.token2)\n}\n\nexport const updateTokenDynamicData = async (token_address: string): Promise<any> => {\n    if (!token_address) return null\n    if (is_dev()) addToastMsg('updateTokenDynamicData, token='+token_address, 'info')\n\n    const starknet = getStarknet()\n    let promises: Array<Promise<any>> = []\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n\n    let tokensDynamic = getRecoil(tokensUserDataState)\n    let current_token = tokensDynamic.get(token_address)\n    if (current_token) {\n        const t_thresh = Date.now() - SECS_TO_REFRESH_POOL_DATA * 1000\n        if (current_token.refresh > t_thresh) {\n            return null\n        }\n    } else {\n        // new token - first store an empty shell in Recoil, then the async requests will update it\n        setRecoil(tokensUserDataState, (currentTud: Map<string, TokenUserData>) => {\n            let newMap = new Map(currentTud)\n            if (!newMap.get(token_address)) {\n                let tud: TokenUserData = {\n                    address: token_address,\n                    refresh: Date.now(),\n                    ammBalance: undefined,\n                    userBalance: undefined,\n                    userApproved: undefined\n                }\n                newMap.set(token_address, tud)\n            }\n            return newMap\n        })\n    }\n\n    let p1 = starknet.provider\n        .callContract({\n            contract_address: token_address,\n            entry_point_selector: selector_balanceOf,\n            calldata: [amm_contract_decimal]\n        })\n        .then((data: any) => {\n            const balance = composeUInt256(data.result[0], data.result[1])\n            // update balance directly in recoil\n            setRecoil(tokensUserDataState, (currentTud: Map<string, TokenUserData>) => {\n                let newMap = new Map(currentTud)\n                let tud = newMap.get(token_address)\n                if (tud) {\n                    tud.ammBalance = balance\n                    newMap.set(tud.address, tud)\n                }\n                return newMap\n            })\n\n        })\n    promises.push(p1)\n\n    let p2 = starknet.provider\n        .callContract({\n            contract_address: token_address,\n            entry_point_selector: selector_balanceOf,\n            calldata: [numberToCallParam(activeAccount)]\n        })\n        .then((data: any) => {\n            // update balance directly in recoil\n            const balance = composeUInt256(data.result[0], data.result[1])\n            setRecoil(tokensUserDataState, (currentTud: Map<string, TokenUserData>) => {\n                let newMap = new Map(currentTud)\n                let tud = newMap.get(token_address)\n                if (tud) {\n                    tud.userBalance = balance\n                    newMap.set(tud.address, tud)\n                }\n                return newMap\n            })\n        })\n    promises.push(p2)\n\n    let p3 = starknet.provider\n        .callContract({\n            contract_address: token_address,\n            entry_point_selector: selector_allowance,\n            calldata: [numberToCallParam(activeAccount), numberToCallParam(amm_contract)]\n        })\n        .then((data: any) => {\n            const balance = composeUInt256(data.result[0], data.result[1])\n            setRecoil(tokensUserDataState, (currentTud: Map<string, TokenUserData>) => {\n                let newMap = new Map(currentTud)\n                let tud = newMap.get(token_address)\n                if (tud) {\n                    tud.userApproved = balance\n                    newMap.set(tud.address, tud)\n                }\n                return newMap\n            })\n        })\n    promises.push(p3)\n\n    await Promise.allSettled(promises)\n}\n\nfunction addPendingTx(hash: string, type: string) {\n    // fixme: use 'type' as enum and not freestyle strings\n    let tx: Transaction = {\n        hash: hash,\n        type: type,\n        status: 'new',\n        dismiss: false\n    }\n    setRecoil(pendingTxsState, (current: Array<Transaction>) => {\n        return [...current, tx]\n    })\n}\n\nexport const approve = async (tokenFrom: string, amount: string): Promise<any> => {\n    console.log('approve')\n\n    const starknet = getStarknet()\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    if (!safeToSend()) return null\n\n    let tx = await starknet.signer.invokeFunction(\n        tokenFrom, // to (ERC-20 contract)\n        approveSelector, // selector (approve)\n        [numberToCallParam(amm_contract), numberToCallParam(amount), numberToCallParam(0)]\n    )\n\n    addPendingTx(tx.transaction_hash, 'approve')\n\n    return tx\n}\n\nexport const getAllowance = async (tokenFrom: string): Promise<any> => {\n    console.log('getAllowance')\n    const starknet = getStarknet()\n\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n\n    // checks that enable succeeded\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    return ERC20_allowance(tokenFrom, activeAccount, amm_contract)\n}\n\nexport const ERC20_balanceOf = async (token: string, account: string): Promise<any> => {\n    const starknet = getStarknet()\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    let data = await starknet.provider.callContract({\n        contract_address: token,\n        entry_point_selector: selector_balanceOf,\n        calldata: [numberToCallParam(account)]\n    })\n\n    const balance = composeUInt256(data.result[0], data.result[1])\n\n    return balance\n}\n\nexport const ERC20_allowance = async (\n    token: string,\n    owner: string,\n    spender: string\n): Promise<any> => {\n    const starknet = getStarknet()\n\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    let data = await starknet.provider.callContract({\n        contract_address: token,\n        entry_point_selector: selector_allowance,\n        calldata: [numberToCallParam(owner), numberToCallParam(spender)]\n    })\n\n    const balance = composeUInt256(data.result[0], data.result[1])\n    return balance\n}\n\nexport const ERC20_mint = async (token: string, amount: string): Promise<any> => {\n    const starknet = getStarknet()\n\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    if (!safeToSend()) return null\n\n    let tx = await starknet.signer.invokeFunction(\n        token, // to (ERC-20 contract)\n        mintSelector, // selector (mint)\n        [\n            numberToCallParam(activeAccount),\n            numberToCallParam(amount),\n            numberToCallParam(0)\n        ]\n    )\n\n    addPendingTx(tx.transaction_hash, 'mint')\n\n    return tx\n}\n\nexport const swap = async (\n    poolId: number,\n    tokenFrom: string,\n    swapAmount: string,\n    minAmountOut: string\n): Promise<any> => {\n    console.log('swap')\n\n    const starknet = getStarknet()\n\n    let activeAccount: string = walletAddress()\n\n    if (!activeAccount) {\n        return null\n    }\n\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    if (!safeToSend()) return null\n\n    let tx = await starknet.signer.invokeFunction(\n        amm_contract, // to\n        swapSelector, // selector (swap)\n        [\n            numberToCallParam(poolId),\n            numberToCallParam(tokenFrom),\n            numberToCallParam(swapAmount),\n            numberToCallParam(0),\n            numberToCallParam(minAmountOut),\n            numberToCallParam(0)\n        ]\n    )\n\n    addPendingTx(tx.transaction_hash, 'swap')\n    return tx\n}\n\nexport const getLPBalance = async (pool_id: number, address: string): Promise<any> => {\n    const starknet = getStarknet()\n\n    if (!address) {\n        return null\n    }\n    if (starknet.isConnected === false) throw Error('starknet wallet not connected')\n\n    let data = await starknet.provider.callContract({\n        contract_address: amm_contract,\n        entry_point_selector: getLPBalanceSelector,\n        calldata: [numberToCallParam(pool_id), numberToCallParam(address)]\n    })\n\n    const balance = composeUInt256(data.result[0], data.result[1])\n\n    return balance\n}\n\nexport const composeUInt256 = (low: string, high: string): string => {\n    return BigNumber(low).plus(BigNumber(high).times(BigNumber(2).pow(128))).toString(10)\n}\n\n// fixme: probably redundant, consider remove\nconst numberToCallParam = (n: number | string): string => {\n    return BigNumber(n).toString(10)\n    //not good: return number.toBN(n).toString()\n}\n\n// fixme substr is deprecated\nfunction hex_to_ascii(str1: string): string {\n    var hex = str1.substr(2).toString()\n    var str = ''\n    for (var n = 0; n < hex.length; n += 2) {\n        str += String.fromCharCode(parseInt(hex.substr(n, 2), 16))\n    }\n    return str\n}\n\nexport function human_readable_hash(hash: string): string {\n    if (hash.length <= 8) return hash\n    return hash.substr(0, 5) + '...' + hash.substr(-3)\n}\n\nexport const waitForTransaction = async (hash: string) => {\n    await getStarknet().provider.waitForTx(hash)\n}\n\nexport const getTransactionUpdate = async (hash: string): Promise<string | null> => {\n    let t = await getStarknet().provider.getTransactionStatus(hash)\n\n    // check if transaction status has changed and update Recoil\n    let pendingTxs = getRecoil(pendingTxsState)\n    if (\n        pendingTxs &&\n        pendingTxs.find((tx) => tx.hash === hash && tx.status !== t.tx_status)\n    ) {\n        console.log('getTransactionUpdate: ', t.tx_status, hash)\n        setRecoil(pendingTxsState, (currTxs: Array<Transaction>) => {\n            let r = new Array<Transaction>()\n            currTxs.forEach((tx) => {\n                console.log('Inside forEach: ', tx.hash, tx.status)\n                if (tx.hash === hash) {\n                    // dup and change\n                    let tx_: Transaction = Object.assign({}, tx)\n                    tx_.status = t.tx_status\n                    if (\n                        //tx_.status === 'PENDING' ||                        \n                        tx_.status === 'ACCEPTED_ON_L2' ||\n                        tx_.status === 'ACCEPTED_ON_L1' \n                    )\n                        tx_.dismiss = true\n                    \n                    // we can delete the transaction here if on L1...\n\n                    r.push(tx_)\n                } else {\n                    r.push(tx)\n                }\n            })\n            return r\n        })\n        return t.tx_status\n    }\n    return null\n}\n\nfunction sortTokens(token1: string, token2: string): string[] {\n    return BigNumber(token1) < BigNumber(token2) ? [token1, token2] : [token2, token1]\n}\n\nexport const getPoolIdFromTokens = (token1: string, token2: string): number => {\n    // check that we know these tokens\n    let pools = getRecoil(poolsState)\n    let tokens = getRecoil(tokensState)\n    if (!tokens.get(token1) || !tokens.get(token2)) throw Error('Unknown tokens')\n\n    let [t1, t2] = sortTokens(token1, token2)\n    for (let id = 1; id <= pools.size; id++) {\n        let pool: Pool | undefined = pools.get(id)\n        if (!pool) throw Error('missing pool ' + id)\n        if (pool.token1 === t1 && pool.token2 === t2) return id\n    }\n    return 0\n}\n\nexport function float_to_decimal_int(token_address: string, amount: string): string {\n    let tokens = getRecoil(tokensState)\n    let token: Token | undefined = tokens.get(token_address)\n    if (token === undefined) {\n        // throw Error('undefined pool')\n        addToastMsg(\n            'float_to_decimal_int: Undefined pool for token ' +\n                token_address +\n                ', tokens size=' +\n                tokens.size +\n                ' amount=' +\n                amount,\n            'warning'\n        )\n        return '0'\n    }\n\n    return BigNumber(amount).shiftedBy(token.decimals).toFixed(0, BigNumber.ROUND_DOWN)\n}\n\nexport function decimal_int_to_float(token_address: string, amount: string): string {\n    let tokens = getRecoil(tokensState)\n    let token: Token | undefined = tokens.get(token_address)\n    if (token === undefined) {\n        //throw Error('undefined pool')\n        addToastMsg(\n            'decimal_int_to_float: Undefined pool for token ' +\n                token_address +\n                ', tokens size=' +\n                tokens.size +\n                ' amount=' +\n                amount,\n            'warning'\n        )\n        return '0'\n    }\n\n    return BigNumber(amount).shiftedBy(-token.decimals).toString(10)    // should have exactly 'decimals' floating point\n}\n\nexport const calcOtherTokenAmount = (\n    token_leading: string,\n    token_other: string,\n    token_leading_amount_float: string,\n    leading_token_number: number // either 1, or 2\n): string | undefined => {\n\n    let poolId = getPoolIdFromTokens(token_leading, token_other)\n    if (\n        poolId === 0 ||\n        token_leading_amount_float === undefined ||\n        token_leading_amount_float === null\n    )\n        return undefined\n\n    if (token_leading_amount_float === '')\n        return ''\n\n    let token_leading_amount = float_to_decimal_int(\n        token_leading,\n        token_leading_amount_float\n    )\n\n    let pools = getRecoil(poolsState)\n    let pool: Pool | undefined = pools.get(poolId)\n\n    if (pool === undefined) {\n        addToastMsg('Undefined pool id=' + poolId, 'warning')\n        return undefined\n    }\n\n    // check reserves\n    let token_leading_reserve = '0'\n    let token_other_reserve = '0'\n\n    if (pool.token1 === token_leading) {\n        token_leading_reserve = pool.token1Amount\n        token_other_reserve = pool.token2Amount\n    } else {\n        token_leading_reserve = pool.token2Amount\n        token_other_reserve = pool.token1Amount\n    }\n\n    if (BigNumber(token_leading_reserve).lte(0) || BigNumber(token_other_reserve).lte(0))\n        throw Error('token reserve cannot be 0')\n\n    if (leading_token_number === 1) {\n        let token_out_expected_amount =\n            BigNumber(token_other_reserve).times(BigNumber(token_leading_amount))\n            .div(\n                BigNumber(token_leading_reserve).plus(BigNumber(token_leading_amount))\n                )\n            .toFixed(0, BigNumber.ROUND_DOWN)\n\n        return decimal_int_to_float(token_other, token_out_expected_amount)\n    } else {\n        // leading token is 2, calc what should be the output in order to get\n        let token_in_calculated_amount =\n        BigNumber(token_other_reserve).times(BigNumber(token_leading_amount))\n        .div(\n            BigNumber(token_leading_reserve).minus(BigNumber(token_leading_amount))\n            )\n        .toFixed(0, BigNumber.ROUND_DOWN)\n\n        return decimal_int_to_float(token_other, token_in_calculated_amount)\n    }\n}\n\nexport const calcOtherTokenRequiredAmountForLiquidity = (\n    token_a: string,\n    token_b: string,\n    token_a_float: string\n): string | undefined => {\n    let poolId = getPoolIdFromTokens(token_a, token_b)\n    if (\n        poolId === 0 ||\n        token_a_float === undefined ||\n        token_a_float === null\n    )\n        return undefined\n\n    if (token_a_float === '') return ''\n\n    let token_a_amount = float_to_decimal_int(token_a, token_a_float)\n\n    let pools = getRecoil(poolsState)\n    let pool: Pool | undefined = pools.get(poolId)\n\n    if (pool === undefined) {\n        // throw Error('undefined pool')\n        addToastMsg('Undefined pool id=' + poolId, 'warning')\n        return undefined\n    }\n\n    let price = getPoolPriceForTokenA(poolId, token_a, token_b, token_a_amount)\n\n    console.log('Other Token Add Liquidity: ', price, token_a_amount)\n    //let token_b_amount = BigNumber(price).times(BigNumber(token_a_amount)).toFixed(0, BigNumber.ROUND_DOWN)\n    //return decimal_int_to_float(token_b, token_b_amount)\n\n\n    return decimal_int_to_float(token_b, price)\n}\n\nexport const add_liquidity = async (\n    token_a_address: string,\n    token_a_amount: string,\n    token_a_min_amount: string,\n    token_b_address: string,\n    token_b_amount: string,\n    token_b_min_amount: string\n) => {\n    console.log('AMM_add_liquidity: ', token_a_min_amount, numberToCallParam(token_a_min_amount))\n\n    const starknet = getStarknet()\n    let activeAccount: string = walletAddress()\n\n    if (starknet.isConnected === false || !activeAccount) {\n        // Need to convert to a toast\n        return null\n    }\n\n    if (!safeToSend()) return null\n\n    let tx = await starknet.signer.invokeFunction(\n        amm_contract, // to\n        addLiquiditySelector, // 'add_liquidity' selector\n        [\n            numberToCallParam(token_a_address),\n            numberToCallParam(token_a_amount),\n            numberToCallParam(0),\n            numberToCallParam(token_a_min_amount),\n            numberToCallParam(0),\n            numberToCallParam(token_b_address),\n            numberToCallParam(token_b_amount),\n            numberToCallParam(0),\n            numberToCallParam(token_b_min_amount),\n            numberToCallParam(0)\n        ]\n    )\n\n\n    return tx\n}\n\nexport const withdraw_liquidity = async (\n    pool_id: number,\n    shares: string,\n    token_a_min_amount: string,\n    token_b_min_amount: string\n) => {\n    console.log('withdraw_liquidity')\n\n    const starknet = getStarknet()\n    let activeAccount: string = walletAddress()\n\n    if (starknet.isConnected === false || !activeAccount) {\n        // Need to convert to a toast\n        return null\n    }\n\n    console.log(\n        'Calling Starknet: withdraw_liquidity with ',\n        pool_id,\n        shares,\n        token_a_min_amount,\n        token_b_min_amount\n    )\n\n    if (!safeToSend()) return null\n\n    let tx = await starknet.signer.invokeFunction(\n        amm_contract, // to\n        withdrawLiquiditySelector, // 'add_liquidity' selector\n        [\n            numberToCallParam(pool_id),\n            numberToCallParam(shares),\n            numberToCallParam(0),\n            numberToCallParam(token_a_min_amount),\n            numberToCallParam(0),\n            numberToCallParam(token_b_min_amount),\n            numberToCallParam(0)\n        ]\n    )\n\n    addPendingTx(tx.transaction_hash, 'withdraw_liquidity')\n\n    return tx\n}\n\nconst safeToSend = () : boolean => {\n    if (getRecoil(safeToSendTxSelector)) return true\n\n    addToastMsg('Previous Transaction still being processed by your wallet, try again later','error')\n    return false\n}","import { setRecoil } from 'recoil-nexus'\nimport { Pool, poolsState, Token, tokensState } from '../atoms'\nimport { composeUInt256 } from './amm'\n\n// Fixme: decide which server to go with\n//const SERVER_URL = \"http://localhost:7000\"\n//const SERVER_URL = \"https://mottyl.github.io/static_data/data/amm.json\"\nconst SERVER_URL = 'https://my-json-server.typicode.com/mottyl/static_data'\n\nexport const updatePoolsAndTokensStatic = async () => {\n    // Fetch AMM Info\n    const fetchAmmInfo = async () => {\n        const res = await fetch(`${SERVER_URL}/amminfo`)\n        const data = await res.json()\n        console.log('AMM info data:', data)\n    }\n\n    // Fetch Pools\n    const fetchPools = async () => {\n        const res = await fetch(`${SERVER_URL}/pools`)\n        const data = await res.json()\n        let new_pools = new Map<number, Pool>()\n        for (let i = 1; i <= data.numberOfPools; i++) {\n            let d = data[i]\n            let pool: Pool = {\n                id: i,\n                name: d.poolName,\n                token1: d.tokenAAddress,\n                token1Amount: composeUInt256(d.tokenAReserves[0], d.tokenAReserves[1]),\n                token2: d.tokenBAddress,\n                token2Amount: composeUInt256(d.tokenBReserves[0], d.tokenBReserves[1]),\n                fee: Number(d.feePercentage) / 1e5,\n                cfmm: Number(d.cfmm),\n                shares: composeUInt256(d.shares[0], d.shares[1]),\n                refresh: Date.now()\n            }\n            console.log('Pool = ', pool)\n            new_pools.set(i, pool)\n        }\n        // Save to Recoil\n        setRecoil(poolsState, new_pools)\n    }\n\n    // Fetch Tokens\n    const fetchTokens = async () => {\n        const res = await fetch(`${SERVER_URL}/tokens`)\n        const data = await res.json()\n\n        let new_tokens = new Map<string, Token>()\n        for (let i = 0; i < data.numberOfTokens; i++) {\n            let d = data[i]\n            let token: Token = {\n                address: d.tokenAddress,\n                id: i,\n                name: d.tokenName,\n                symbol: d.tokenSymbol,\n                icon: d.tokenIcon,\n                decimals: d.tokenDecimals\n            }\n            new_tokens.set(d.tokenAddress, token)\n            console.log('Token = ', token)\n        }\n        setRecoil(tokensState, new_tokens)\n    }\n\n    fetchAmmInfo()\n    fetchPools()\n    fetchTokens()\n}\n","import React, { useState, useEffect } from 'react'\nimport LoadingButton from '@mui/lab/LoadingButton'\nimport PendingActionsIcon from '@mui/icons-material/PendingActions'\nimport {\n    approve,\n    isTokenApproved,\n    tokenAllowanceForAMM,\n    float_to_decimal_int,\n    addToastMsg,\n    checkAndUpdateComponentTransactions\n} from '../services/amm'\nimport { tokensState, walletAddressState, transactionsStatusSelector } from '../atoms'\nimport { useRecoilState } from 'recoil'\n\nconst DEFAULT_APPROVE_AMOUNT = BigInt(2 ** 127 - 1).toString()\n\nfunction Approve(props) {\n    const [tokens] = useRecoilState(tokensState)\n    const [connectedAddress] = useRecoilState(walletAddressState)\n    const [tokenApproveInProgress, setTokenApproveInProgress] = useState(false)\n    const [transactionsStatus] = useRecoilState(transactionsStatusSelector('approve'))\n    const [componentTxs, setComponentTxs] = useState({})\n\n    useEffect(() => {\n        checkAndUpdateComponentTransactions(\n            transactionsStatus,\n            componentTxs,\n            setTokenApproveInProgress\n        )\n    }, [transactionsStatus, componentTxs])\n\n    let token = props.token\n    let tokenAmount = props.tokenAmount\n    let activePoolId = props.activePoolId\n    let tokenInRange = props.tokenInRange\n\n    const handleApproveToken = async () => {\n        setTokenApproveInProgress(true)\n        let approveAmount = DEFAULT_APPROVE_AMOUNT\n            ? DEFAULT_APPROVE_AMOUNT\n            : float_to_decimal_int(token, tokenAmount)\n        try {\n            let tx = await approve(token, approveAmount)\n\n            if (!tx) throw Error('Cannot perform transaction')\n\n            setComponentTxs((prevState) => ({\n                ...prevState,\n                [tx.transaction_hash]: 'new'\n            }))\n        } catch (e) {\n            addToastMsg('Approve user abort', 'error')\n            setTokenApproveInProgress(false)\n        }\n    }\n\n    if (\n        connectedAddress &&\n        token &&\n        tokenAmount > 0 &&\n        activePoolId > 0 &&\n        tokenInRange &&\n        !isTokenApproved(token, tokenAmount)\n    ) {\n        let token_obj = tokens.get(token)\n        if (token_obj) {\n            return (\n                <LoadingButton\n                    color='inherit'\n                    variant='outlined'\n                    fullWidth={true}\n                    loading={\n                        tokenApproveInProgress ||\n                        tokenAllowanceForAMM(token) === null ||\n                        tokenAllowanceForAMM(token) === undefined\n                            ? true\n                            : false\n                    }\n                    loadingPosition='start'\n                    startIcon={<PendingActionsIcon />}\n                    onClick={handleApproveToken}>\n                    {tokenAllowanceForAMM(token) === null ||\n                    tokenAllowanceForAMM(token) === undefined\n                        ? 'CHECKING ' + token_obj.symbol + ' ALLOWANCE'\n                        : 'APPROVE ' + token_obj.symbol}\n                </LoadingButton>\n            )\n        }\n    }\n\n    return <div></div>\n}\n\nexport default Approve\n","import React from 'react'\n\nimport { Grid, Button, Typography } from '@mui/material'\n\nimport { numFormat } from '../services/amm'\n\nfunction Balance(props) {\n    let token = props.token\n    let showMaxButton = props.showMaxButton\n    let setMaxAmountHandler = props.setMaxAmountHandler\n    let walletAmount = props.amount\n\n    if (walletAmount === undefined || walletAmount === '') return <div></div>\n\n    return (\n        <div>\n            <Grid container>\n                <Typography fontSize={13} sx={{ ml: 2, mt: 0.5 }}>\n                    {/* {displayBalance()} */}\n                    {'Balance: ' + numFormat(walletAmount)}\n                </Typography>\n                {showMaxButton && (\n                    <Button\n                        size='small'\n                        sx={{ ml: -1.5, mt: -0.2 }}\n                        onClick={() => setMaxAmountHandler(token, walletAmount)}>\n                        max\n                    </Button>\n                )}\n            </Grid>\n        </div>\n    )\n}\n\nexport default Balance\n","import { getStarknet } from '@argent/get-starknet'\n\nimport { erc20TokenAddressByNetwork } from './token.service'\n\nexport const isWalletConnected = (): boolean => !!getStarknet()?.isConnected\n\nexport const connectWallet = async () => await getStarknet({ showModal: true }).enable()\n\nexport const walletAddress = async (): Promise<string | undefined> => {\n    try {\n        const [address] = await getStarknet().enable()\n        return address\n    } catch {}\n}\n\nexport const networkId = (): keyof typeof erc20TokenAddressByNetwork => {\n    try {\n        const baseUrl = getStarknet().provider.baseUrl\n        if (baseUrl.includes('alpha-mainnet.starknet.io')) {\n            return 'mainnet-alpha'\n        } else {\n            return 'goerli-alpha'\n        }\n    } catch {\n        return 'goerli-alpha'\n    }\n}\n\nexport const getExplorerUrlBase = (): string => {\n    if (networkId() === 'mainnet-alpha') {\n        return 'https://voyager.online'\n    } else {\n        return 'https://goerli.voyager.online'\n    }\n}\n\nexport const networkUrl = (): string | undefined => {\n    try {\n        return getStarknet().provider.baseUrl\n    } catch {}\n}\n\nexport const waitForTransaction = async (hash: string) =>\n    await getStarknet().provider.waitForTx(hash)\n\nexport const addWalletChangeListener = async (\n    handleEvent: (accounts: string[]) => void\n) => {\n    getStarknet().on('accountsChanged', handleEvent)\n}\n","import ReactGA from 'react-ga'\n\nexport const GAinit = () => {\n    // Google Analytics Set Up\n    const gaTrackingId = 'UA-215866683-1'\n    ReactGA.initialize(gaTrackingId)\n}\n\nexport const GApage = (page) => {\n    ReactGA.pageview(page)\n}\n\nexport const GAtrack = (cat, action, label) => {\n    ReactGA.event({\n        category: cat,\n        action: action,\n        label: label\n    })\n}\n\nexport const GAbutton = (label) => {\n    GAtrack('button', 'click', label)\n}\n","import React, { useState, useEffect } from 'react'\n\nimport { walletAddressState, poolsState } from '../atoms'\n\nimport {\n    updateAllTokensDynamicData,\n    human_readable_hash,\n    addToastMsg\n} from '../services/amm'\nimport {\n    addWalletChangeListener,\n    connectWallet,\n    getExplorerUrlBase,\n    networkId,\n    walletAddress\n} from '../services/wallet.service'\n\nimport { GAbutton } from '../services/ga.js'\n\nimport { Button } from '@mui/material'\nimport CircleIcon from '@mui/icons-material/Circle'\nimport AccountBalanceWalletIcon from '@mui/icons-material/AccountBalanceWallet'\n\nimport { useRecoilState } from 'recoil'\n\nfunction ConnectWallet(props) {\n    const [walletConnectionStatus, setWalletConnectionStatus] = useState(0)\n    const [voyagerBaseUrl, setVoyagerBaseUrl] = useState('')\n    const [networkName, setNetworkName] = useState('')\n    const [changeListenerRegistered, setChangeListenerRegistered] = useState(false)\n    const [address, setAddress] = useRecoilState(walletAddressState)\n    const [pools] = useRecoilState(poolsState)\n\n    const handleClick = async () => {\n        GAbutton('connect_wallet')\n\n        setWalletConnectionStatus(1)\n        try {\n            await connectWallet()\n        } catch {\n            // this means no argent wallet is available\n            addToastMsg('Wallet not found', 'error')\n            setWalletConnectionStatus(0)\n            return\n        }\n        setAddress(await walletAddress())\n        setWalletConnectionStatus(2)\n\n        addToastMsg('Wallet connected', 'success')\n    }\n\n    useEffect(() => {\n        if (props.secondary) return\n\n        const handleWalletChange = async (accounts) => {\n            if (props.secondary) return\n            console.log('handleWalletChange: ', accounts)\n            setAddress(await walletAddress())\n            setVoyagerBaseUrl(getExplorerUrlBase())\n            setNetworkName(networkId())\n\n            updateAllTokensDynamicData()\n            addToastMsg('Wallet network/account change', 'success')\n        }\n\n        console.log('address has changed, ', address)\n        if (address) {\n            setWalletConnectionStatus(2)\n            updateAllTokensDynamicData()\n            setVoyagerBaseUrl(getExplorerUrlBase())\n            setNetworkName(networkId())\n            if (!props.secondary && !changeListenerRegistered) {\n                addWalletChangeListener(handleWalletChange)\n                setChangeListenerRegistered(true) // do this only once, otherwise for every change a new listener will be registered\n            }\n        }\n    }, [address, props.secondary, changeListenerRegistered, setAddress])\n\n    useEffect(() => {\n        if (props.secondary) return\n        // Yaron: why do we need this? it doesn't do anything...\n        // console.log('pools have changed', pools)\n    }, [pools, props.secondary])\n\n    // Handle wallet connect button inside the screen (aka secondary)\n    if (props.secondary) {\n        // If already connected no need to display button\n        if (address !== '' || walletConnectionStatus === 2) {\n            return <div></div>\n        }\n\n        // Secondary connect button - short-circuit all hooks\n        if (walletConnectionStatus === 1) {\n            return (\n                <div>\n                    <Button color='inherit' fullWidth={true} variant='outlined' disabled>\n                        Connecting...\n                    </Button>\n                </div>\n            )\n        }\n\n        // Display button\n        return (\n            <div>\n                <Button\n                    className='connect-wallet'\n                    color='inherit'\n                    fullWidth={true}\n                    variant='contained'\n                    onClick={handleClick}>\n                    <AccountBalanceWalletIcon fontSize='medium' sx={{ mr: 1 }} />\n                    CONNECT WALLET\n                </Button>\n            </div>\n        )\n    }\n\n    const handleConnectedClick = async () => {\n        console.log('opening wallet')\n        window.open(voyagerBaseUrl + '/contract/' + address, '_blank')\n    }\n\n    if (walletConnectionStatus === 2) {\n        console.log('Wallet is connected!', address)\n        return (\n            <div>\n                <Button color='inherit' variant='outlined' onClick={handleConnectedClick}>\n                    <CircleIcon\n                        sx={{ mr: 1 }}\n                        style={{ fill: 'lightgreen', fontSize: 10 }}\n                    />{' '}\n                    {networkName} {human_readable_hash(address)}{' '}\n                </Button>\n            </div>\n        )\n    } else if (walletConnectionStatus === 1) {\n        console.log('Wallet is being connected!', address)\n        return (\n            <div>\n                <Button color='inherit' variant='outlined' disabled>\n                    Connecting...\n                </Button>\n            </div>\n        )\n    } else {\n        return (\n            <div>\n                <Button color='inherit' variant='outlined' onClick={handleClick}>\n                    Connect Wallet\n                </Button>\n            </div>\n        )\n    }\n}\n\nexport default ConnectWallet\n","import React, { useState, useEffect } from 'react'\nimport { useRecoilState } from 'recoil'\nimport { getRecoil } from 'recoil-nexus'\nimport { BigNumber } from 'bignumber.js'\n\nimport {\n    FormControl,\n    InputLabel,\n    Select,\n    MenuItem,\n    TextField,\n    Grid,\n    Box,\n    Card,\n    CardActionArea,\n    Typography,\n    Button,\n    IconButton\n} from '@mui/material'\nimport LoadingButton from '@mui/lab/LoadingButton'\nimport SwapHorizIcon from '@mui/icons-material/SwapHoriz'\nimport SwapVertSharpIcon from '@mui/icons-material/SwapVertSharp'\nimport AccountBalanceWalletIcon from '@mui/icons-material/AccountBalanceWallet'\n\nimport {\n    tokensState,\n    swapSlippage,\n    walletAddressState,\n    transactionsStatusSelector,\n    tokensUserDataState,\n    poolsState\n} from '../atoms'\n\nimport {\n    getWalletTokenAmount,\n    updateTokenDynamicData,\n    updatePoolDynamicData,\n    swap,\n    numFormat,\n    addToastMsg,\n    isTokenApproved,\n    getPoolPriceForTokenA,\n    getPoolIdFromTokens,\n    calcOtherTokenAmount,\n    float_to_decimal_int,\n    isSufficientBalanceInWallet,\n    isInsufficientBalanceInPool,\n    checkAndUpdateComponentTransactions,\n    WALLET_SUFFICIENT_BALANCE\n} from '../services/amm'\n\nimport { useInterval } from 'usehooks-ts'\n\nimport Approve from './Approve.js'\nimport Balance from './Balance.js'\nimport BoxHeader from './BoxHeader.js'\nimport ConnectWallet from './ConnectWallet.js'\n\nimport { GApage, GAbutton } from '../services/ga.js'\n\nexport const DEFAULT_APPROVE_AMOUNT = Number.MAX_SAFE_INTEGER // Need to change it to: (2**127 - 1) -- given that 'toBN' supports...\n\nfunction Swap() {\n    const [activePoolId, setActivePoolId] = useState(0)\n    const [token1, setToken1] = useState('')\n    const [token1Amount, setToken1Amount] = useState('')\n    const [token2, setToken2] = useState('')\n    const [token2Amount, setToken2Amount] = useState('')\n    const [leadingToken, setLeadingToken] = useState(0) // 0 is no token, 1/2 is the last updated token\n    const [swapInProgress, setSwapInProgress] = useState(false)\n    const [tokens] = useRecoilState(tokensState)\n    const [tuds] = useRecoilState(tokensUserDataState)\n    const [pools] = useRecoilState(poolsState)\n\n    const [connectedAddress] = useRecoilState(walletAddressState)\n    const [transactionsStatus] = useRecoilState(transactionsStatusSelector('swap'))\n    const [componentTxs, setComponentTxs] = useState({})\n\n    useEffect(() => {\n        GApage('swap')\n    }, [])\n\n    useEffect(() => {\n        checkAndUpdateComponentTransactions(\n            transactionsStatus,\n            componentTxs,\n            setSwapInProgress\n        )\n    }, [transactionsStatus, componentTxs])\n\n    useEffect(() => {}, [tuds, pools])\n\n    const updateTokensIntervalCallback = async () => {\n        // Allow periodic update only if both tokens are selected\n        if (activePoolId > 0) {\n            updatePoolDynamicData(activePoolId)\n        } else {\n            if (token1) updateTokenDynamicData(token1)\n            if (token2) updateTokenDynamicData(token2)\n        }\n    }\n\n    // Timer to update active pool and tokens user data (allowance, amount)\n    useInterval(updateTokensIntervalCallback, 15000)\n\n    const handleToken1Select = (event) => {\n        let token_address = event.target.value\n        setToken1(token_address)\n        updateTokenDynamicData(token_address)\n\n        GAbutton('swap-token1')\n    }\n\n    const handleToken2Select = (event) => {\n        let token_address = event.target.value\n        setToken2(token_address)\n        updateTokenDynamicData(token_address)\n\n        GAbutton('swap-token2')\n    }\n\n    const handleTokenAmountChange = (token, amount) => {\n        // fixme: consider limit decimals input according to token decimals\n        const regex = /^(([0-9]+[.]?[0-9]*)|([.][0-9]+))$/\n\n        if (token === token1 && (amount === '' || regex.test(amount))) {\n            setToken1Amount(amount)\n            setLeadingToken(1)\n        }\n        if (token === token2 && (amount === '' || regex.test(amount))) {\n            setToken2Amount(amount)\n            setLeadingToken(2)\n        }\n    }\n\n    useEffect(() => {\n        if (token1 && token2) {\n            let poolId = getPoolIdFromTokens(token1, token2)\n            setActivePoolId(poolId)\n\n            // follow the leader\n            if (leadingToken <= 1) {\n                // cannot be 0, but just for safety\n                if (poolId > 0) {\n                    // calc token2 amount\n                    let amount = calcOtherTokenAmount(token1, token2, token1Amount, 1)\n                    console.log('calcOtherTokenAmount: (token1 leading) ', amount)\n                    if (amount !== undefined && amount !== token2Amount) {\n                        setToken2Amount(amount)\n                    }\n                } else {\n                    setToken2Amount(0)\n                }\n            } else {\n                if (poolId > 0) {\n                    // calc token2 amount\n                    let amount = calcOtherTokenAmount(token2, token1, token2Amount, 2)\n                    console.log('calcOtherTokenAmount: (token2 leading) ', amount)\n                    if (amount !== undefined && amount < 0) amount = 0\n                    else if (amount !== undefined && amount !== token1Amount) {\n                        setToken1Amount(amount)\n                    }\n                } else {\n                    setToken1Amount(0)\n                }\n            }\n        } else {\n            // follow the leader\n            if (leadingToken <= 1) {\n                // cannot be 0, but just for safety\n                setToken2Amount('')\n            } else {\n                setToken1Amount('')\n            }\n        }\n    }, [token1, token2, token1Amount, token2Amount, leadingToken])\n\n    const menuItems = (otherSelectedToken) => {\n        let r = []\n        tokens.forEach((value, address) => {\n            if (otherSelectedToken !== address) {\n                r.push(\n                    <MenuItem key={address} value={address}>\n                        <Grid container direction='row'>\n                            <Grid sx={{ mr: 1, mb: -1 }}>\n                                <img src={value.icon} alt='' width='24' height='24' />\n                            </Grid>\n                            <Grid>\n                                <Typography>{value.symbol || value.address}</Typography>\n                            </Grid>\n                        </Grid>\n                    </MenuItem>\n                )\n            }\n        })\n        return r\n    }\n\n    const calcToken2MinAmount = () => {\n        let slippage = parseFloat(getRecoil(swapSlippage)) / 100\n        return BigNumber(token2Amount).times(BigNumber(1).minus(BigNumber(slippage)))\n    }\n\n    const handleSwap = async () => {\n        setSwapInProgress(true)\n        let minAmountOut = calcToken2MinAmount()\n        try {\n            let tx = await swap(\n                activePoolId,\n                token1,\n                float_to_decimal_int(token1, token1Amount),\n                float_to_decimal_int(token2, minAmountOut)\n            )\n\n            if (!tx) throw Error('Cannot perform transaction')\n\n            setComponentTxs((prevState) => ({\n                ...prevState,\n                [tx.transaction_hash]: 'new'\n            }))\n        } catch (e) {\n            addToastMsg('Swap Request: User Aborted', 'error')\n            setSwapInProgress(false)\n        }\n    }\n\n    const swapButton = () => {\n        GAbutton('swap')\n\n        let token1SufficientBalance = isSufficientBalanceInWallet(token1, token1Amount)\n        let token2InsufficientPoolBalance = isInsufficientBalanceInPool(\n            activePoolId,\n            token2,\n            token2Amount\n        )\n\n        if (\n            token2 &&\n            token1Amount > 0 &&\n            activePoolId !== 0 &&\n            token1SufficientBalance === WALLET_SUFFICIENT_BALANCE.TRUE &&\n            !token2InsufficientPoolBalance\n        ) {\n            // Display SWAP button\n            return (\n                <LoadingButton\n                    color='primary'\n                    variant='contained'\n                    fullWidth={true}\n                    disabled={\n                        (connectedAddress && isTokenApproved(token1, token1Amount)) ||\n                        swapInProgress\n                            ? false\n                            : true\n                    }\n                    loading={swapInProgress}\n                    loadingPosition='start'\n                    startIcon={<SwapHorizIcon />}\n                    onClick={handleSwap}>\n                    {swapInProgress ? 'SWAPPING' : 'SWAP'}\n                </LoadingButton>\n            )\n        }\n\n        if (\n            connectedAddress &&\n            token1Amount > 0 &&\n            token1SufficientBalance !== WALLET_SUFFICIENT_BALANCE.TRUE &&\n            !token2InsufficientPoolBalance\n        ) {\n            // Amount either exceeds wallet balance, or wallet balance is unknown yet\n            return (\n                <LoadingButton\n                    color='primary'\n                    variant='contained'\n                    fullWidth={true}\n                    disabled={true}\n                    loading={\n                        token1SufficientBalance === WALLET_SUFFICIENT_BALANCE.UNKNOWN\n                    }\n                    loadingPosition='start'\n                    startIcon={<AccountBalanceWalletIcon />}>\n                    {token1SufficientBalance === WALLET_SUFFICIENT_BALANCE.FALSE\n                        ? 'AMOUNT EXCEEDS WALLET BALANCE'\n                        : 'CHECKING WALLET BALANCE'}\n                </LoadingButton>\n            )\n        }\n\n        if (token1 && token2 && activePoolId === 0) {\n            // No pool for token pair selected\n            return (\n                <Button\n                    color='primary'\n                    variant='contained'\n                    fullWidth={true}\n                    disabled={true}>\n                    NOT A VALID Pool\n                </Button>\n            )\n        }\n\n        if (\n            token1 &&\n            token2 &&\n            activePoolId &&\n            token2Amount &&\n            token2InsufficientPoolBalance\n        ) {\n            return (\n                <Button\n                    color='primary'\n                    variant='contained'\n                    fullWidth={true}\n                    disabled={true}>\n                    INSUFFICIENT LIQUIDITY IN POOL\n                </Button>\n            )\n        }\n\n        if (connectedAddress) {\n            // Wallet is connected\n            let instruction = ''\n            if (!token1 && !token2) instruction = 'SELECT TOKENS'\n            if ((!token1 && token2) || (token1 && !token2)) instruction = 'SELECT TOKEN'\n            if (token1 && token2 && (!token1Amount || !token2Amount))\n                instruction = 'ENTER AMOUNT'\n\n            if (instruction !== '')\n                return (\n                    <Button\n                        color='secondary'\n                        variant='contained'\n                        fullWidth={true}\n                        disabled={true}>\n                        {instruction}\n                    </Button>\n                )\n        }\n\n        return <div></div>\n    }\n\n    const switchTokensAndAmounts = () => {\n        GAbutton('swap-switchtokens')\n\n        let tmpToken = token1\n        let tmpAmount = token1Amount\n        setToken1(token2)\n        setToken2(tmpToken)\n        setToken1Amount(token2Amount)\n        setToken2Amount(tmpAmount)\n        setLeadingToken(leadingToken === 1 ? 2 : 1)\n    }\n\n    const isToken1InputDisabled = () => {\n        return token1 === '' ? true : false\n    }\n    const isToken2InputDisabled = () => {\n        return token2 === '' ? true : false\n    }\n\n    const [priceDirection, setPriceDirection] = useState(0)\n    const [slippage] = useRecoilState(swapSlippage)\n\n    const priceAndSlippage = () => {\n        if (\n            token1 &&\n            token2 &&\n            token1Amount &&\n            !BigNumber(token1Amount).isZero() &&\n            token2Amount &&\n            !BigNumber(token2Amount).isZero()\n        ) {\n            // currentPrice = How much token2 for 1 token1\n            let currentPrice = getPoolPriceForTokenA(activePoolId, token1, token2)\n            console.log('CurrentPrice: ', currentPrice)\n            let minAmount = calcToken2MinAmount()\n            let token1Symbol = tokens.get(token1).symbol\n            let token2Symbol = tokens.get(token2).symbol\n            let floatSlippage = parseFloat(slippage)\n            // transactionPrice = How much token2 for 1 token1\n            let transactionPrice = BigNumber(token2Amount).div(BigNumber(token1Amount))\n            let transactionPriceInv = BigNumber(token1Amount).div(BigNumber(token2Amount))\n\n            let priceImpact = BigNumber(1).minus(\n                BigNumber(transactionPrice).div(BigNumber(currentPrice))\n            )\n\n            let backgroundColor = priceImpact.gt(0.05)\n                ? 'tomato'\n                : priceImpact.gt(0.03)\n                ? 'orange'\n                : 'inherit'\n\n            let displayPrice1 = (\n                <>\n                    1 {token1Symbol} = {numFormat(transactionPrice)} {token2Symbol}\n                </>\n            )\n            let displayPrice2 = (\n                <>\n                    1 {token2Symbol} = {numFormat(transactionPriceInv)} {token1Symbol}\n                </>\n            )\n            //console.log('Price: ', displayPrice1, displayPrice2, priceDirection, transactionPrice.toString(10))\n\n            return (\n                <Grid>\n                    <Card sx={{ mb: 0.5, mt: 2 }}>\n                        <CardActionArea\n                            onClick={() => setPriceDirection(!priceDirection)}>\n                            <Typography\n                                fontSize={13}\n                                fontWeight='medium'\n                                sx={{ ml: 1, mr: 1 }}>\n                                {priceDirection ? displayPrice2 : displayPrice1}\n                            </Typography>\n                        </CardActionArea>\n                    </Card>\n                    <Card style={{ backgroundColor: backgroundColor }} sx={{ mb: 2 }}>\n                        <Typography\n                            fontSize={13}\n                            fontWeight='medium'\n                            sx={{ ml: 1, mr: 1 }}>\n                            Minimum amount received (slippage={floatSlippage.toFixed(2)}\n                            %): {numFormat(minAmount)}\n                        </Typography>\n                        <Typography\n                            fontSize={13}\n                            fontWeight='medium'\n                            sx={{ ml: 1, mr: 1 }}>\n                            Price impact: {numFormat(priceImpact, true)}%\n                        </Typography>\n                    </Card>\n                </Grid>\n            )\n        }\n        return <div></div>\n    }\n\n    return (\n        <Box sx={{ p: 2, border: '0px solid', mt: 1, mb: 4, boxShadow: 2 }}>\n            <div>\n                <Grid container sx={{ mb: 2 }}>\n                    <BoxHeader name='Swap' />\n                </Grid>\n\n                <Card sx={{ p: 2, boxShadow: 2, mb: -4 }}>\n                    <Grid container spacing={2} sx={{}}>\n                        <Grid item xs={6}>\n                            <FormControl fullWidth>\n                                <InputLabel id='token1-label'>Token 1:</InputLabel>\n                                <Select\n                                    labelId='token1-label'\n                                    id='token1-select'\n                                    value={token1}\n                                    label='Token 1'\n                                    onChange={handleToken1Select}>\n                                    {menuItems(token2)}\n                                </Select>\n                            </FormControl>\n                            <Balance\n                                token={token1}\n                                amount={getWalletTokenAmount(token1)}\n                                showMaxButton={true}\n                                setMaxAmountHandler={handleTokenAmountChange}\n                            />\n                        </Grid>\n                        <Grid item xs={6}>\n                            <FormControl fullWidth>\n                                <TextField\n                                    helperText='Amount to swap'\n                                    id='token1-amount'\n                                    inputProps={{\n                                        variant: 'outlined',\n                                        placeholder: '0.00',\n                                        type: 'string',\n                                        autoComplete: 'off',\n                                        'aria-labelledby': 'input-amount'\n                                    }}\n                                    value={token1Amount ? token1Amount : ''}\n                                    onChange={(e) =>\n                                        handleTokenAmountChange(token1, e.target.value)\n                                    }\n                                    error={\n                                        isSufficientBalanceInWallet(\n                                            token1,\n                                            token1Amount\n                                        ) === WALLET_SUFFICIENT_BALANCE.FALSE\n                                            ? true\n                                            : false\n                                    }\n                                    disabled={isToken1InputDisabled()}\n                                />\n                            </FormControl>\n                        </Grid>\n                    </Grid>\n                </Card>\n                <Grid\n                    container\n                    direction='row'\n                    justifyContent='center'\n                    alignItems='center'>\n                    <IconButton\n                        size='large'\n                        disabled={!token1 && !token2}\n                        onClick={switchTokensAndAmounts}>\n                        <SwapVertSharpIcon style={{ fontSize: 40 }} />\n                    </IconButton>\n                </Grid>\n\n                <Card sx={{ p: 2, mt: -3, boxShadow: 2 }}>\n                    <Grid container spacing={2}>\n                        <Grid item xs={6}>\n                            <FormControl fullWidth>\n                                <InputLabel id='token2-label'>Token 2:</InputLabel>\n                                <Select\n                                    labelId='token2-label'\n                                    id='token2-select'\n                                    value={token2}\n                                    label='Token 2'\n                                    onChange={handleToken2Select}>\n                                    {menuItems(token1)}\n                                </Select>\n                            </FormControl>\n                            <Balance\n                                token={token2}\n                                amount={getWalletTokenAmount(token2)}\n                                showMaxButton={false}\n                            />\n                        </Grid>\n                        <Grid item xs={6}>\n                            <FormControl fullWidth>\n                                <TextField\n                                    helperText='Estimated amount received'\n                                    id='token2-amount'\n                                    inputProps={{\n                                        variant: 'outlined',\n                                        placeholder: '0.00',\n                                        type: 'string',\n                                        autoComplete: 'off',\n                                        'aria-labelledby': 'input-amount'\n                                    }}\n                                    value={token2Amount ? token2Amount : ''}\n                                    onChange={(e) =>\n                                        handleTokenAmountChange(token2, e.target.value)\n                                    }\n                                    disabled={isToken2InputDisabled()}\n                                />\n                            </FormControl>\n                        </Grid>\n                    </Grid>\n                </Card>\n\n                {priceAndSlippage()}\n\n                <Card sx={{ minWidth: 275, mb: 2, mt: 3, boxShadow: 2 }}>\n                    <ConnectWallet secondary='true' />\n                    <Approve\n                        token={token1}\n                        tokenAmount={token1Amount}\n                        activePoolId={activePoolId}\n                        tokenInRange={\n                            isSufficientBalanceInWallet(token1, token1Amount) ===\n                            WALLET_SUFFICIENT_BALANCE.TRUE\n                        }\n                    />\n                    {swapButton()}\n                </Card>\n            </div>\n        </Box>\n    )\n}\n\nexport default Swap\n","import React, { useState, useEffect } from 'react'\nimport { getRecoil } from 'recoil-nexus'\nimport { useRecoilState } from 'recoil'\nimport { BigNumber } from 'bignumber.js'\nimport BoxHeader from './BoxHeader.js'\nimport {\n    addToastMsg,\n    withdraw_liquidity,\n    numFormat,\n    float_to_decimal_int,\n    checkAndUpdateComponentTransactions\n} from '../services/amm'\nimport { withdrawLiquiditySlippage, transactionsStatusSelector } from '../atoms'\n\nimport {\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    Card,\n    Box,\n    Grid,\n    CardHeader,\n    Button,\n    Typography,\n    Slider,\n    Stack,\n    Paper\n} from '@mui/material'\nimport MuiInput from '@mui/material/Input'\nimport LoadingButton from '@mui/lab/LoadingButton'\nimport ExitToAppRoundedIcon from '@mui/icons-material/ExitToAppRounded'\nimport { styled } from '@mui/material/styles'\n\nconst Item = styled(Paper)(({ theme }) => ({\n    ...theme.typography.body2,\n    padding: theme.spacing(0),\n    textAlign: 'left',\n    color: theme.palette.text.secondary\n}))\n\nconst Input = styled(MuiInput)`\n    width: 42px;\n`\n\nexport default function RemoveLiquidity(props) {\n    const [open, setOpen] = useState(false)\n    const [percent, setPercent] = useState(25)\n    const [token1Amount, setToken1Amount] = useState('') // fixme: what happens if token1amount / pool share changes during op\n    const [token2Amount, setToken2Amount] = useState('')\n    const [removeLiquidityInProgress, setRemoveLiquidityInProgress] = useState(0)\n    const [transactionsStatus] = useRecoilState(\n        transactionsStatusSelector('withdraw_liquidity')\n    )\n    const [componentTxs, setComponentTxs] = useState({})\n\n    useEffect(() => {\n        checkAndUpdateComponentTransactions(\n            transactionsStatus,\n            componentTxs,\n            setRemoveLiquidityInProgress\n        )\n    }, [transactionsStatus, componentTxs])\n\n    const marks = [\n        { value: 0, label: '0%' },\n        { value: 25, label: '25%' },\n        { value: 50, label: '50%' },\n        { value: 75, label: '75%' },\n        { value: 100, label: '100%' }\n    ]\n\n    useEffect(() => {\n        // if one of the tokens is '0' then set the other one to zero as well\n        if (BigNumber(token1Amount).isZero()) setToken2Amount('0')\n        if (BigNumber(token2Amount).isZero()) setToken1Amount('0')\n\n        // fixme: not sure why can't I call setAmounts\n        setToken1Amount(\n            numFormat(BigNumber(props.token1Amount).times(percent).shiftedBy(-2))\n        )\n        setToken2Amount(\n            numFormat(BigNumber(props.token2Amount).times(percent).shiftedBy(-2))\n        )\n\n        setRemoveLiquidityInProgress(0) // fixme: we don't know it is safe to send another transaction...\n    }, [\n        open,\n        token1Amount,\n        token2Amount,\n        percent,\n        props.token1Amount,\n        props.token2Amount\n    ])\n\n    const handleClose = () => {\n        setRemoveLiquidityInProgress(0) // fixme: we don't know it is safe to send anouther transaction on re-open\n        setOpen(false)\n    }\n\n    const handleClickOpen = () => {\n        setOpen(true)\n    }\n\n    const setAmounts = (percent) => {\n        setToken1Amount(\n            numFormat(BigNumber(props.token1Amount).times(percent).shiftedBy(-2))\n        )\n        setToken2Amount(\n            numFormat(BigNumber(props.token2Amount).times(percent).shiftedBy(-2))\n        )\n    }\n\n    const updateState = (newPercent) => {\n        setPercent(newPercent)\n        setAmounts(newPercent)\n        console.log(\n            'Remove Liquidity, updateState: ',\n            token1Amount,\n            token2Amount,\n            props.token1Amount,\n            props.token2Amount\n        )\n    }\n\n    const handleSliderChange = (event, newPercent) => {\n        updateState(newPercent)\n    }\n\n    const handleInputChange = (event) => {\n        let newPercent = event.target.value === '' ? '' : Number(event.target.value)\n        updateState(newPercent)\n        console.log('handle input change')\n    }\n\n    const handleBlur = () => {\n        if (percent < 0) {\n            setPercent(0)\n        } else if (percent > 100) {\n            setPercent(100)\n        }\n    }\n\n    const handleWithdraw = async () => {\n        console.log('Withdraw percent: ', percent)\n        let slippage = parseFloat(getRecoil(withdrawLiquiditySlippage)) / 100\n        let sharesToWithdraw = BigNumber(props.balance)\n            .times(BigNumber(percent))\n            .shiftedBy(-2)\n            .toFixed(2, BigNumber.ROUND_DOWN)\n        let minToken1Amount = BigNumber(token1Amount)\n            .times(BigNumber(1).minus(BigNumber(slippage).shiftedBy(-2)))\n            .toString(10, BigNumber.ROUND_DOWN)\n        let minToken2Amount = BigNumber(token2Amount)\n            .times(BigNumber(1).minus(BigNumber(slippage).shiftedBy(-2)))\n            .toString(10, BigNumber.ROUND_DOWN)\n\n        setRemoveLiquidityInProgress(1)\n\n        console.log(\n            'handleWithdraw: ',\n            sharesToWithdraw,\n            minToken1Amount,\n            minToken2Amount\n        )\n        try {\n            let tx = await withdraw_liquidity(\n                props.poolId,\n                sharesToWithdraw,\n                float_to_decimal_int(props.token1, minToken1Amount),\n                float_to_decimal_int(props.token2, minToken2Amount)\n            )\n\n            if (!tx) throw Error('Cannot perform transaction')\n\n            setComponentTxs((prevState) => ({\n                ...prevState,\n                [tx.transaction_hash]: 'new'\n            }))\n        } catch (e) {\n            addToastMsg('Remove Liquidity: User Aborted', 'error')\n            setRemoveLiquidityInProgress(0)\n        }\n        handleClose()\n    }\n\n    return (\n        <div>\n            <Button\n                variant='contained'\n                sx={{ textWeight: 'bold' }}\n                onClick={handleClickOpen}>\n                WITHDRAW\n            </Button>\n            <Dialog open={open} onClose={handleClose}>\n                <Box sx={{ p: 2, border: '0px solid', boxShadow: 2 }}>\n                    <Grid container sx={{ mb: 2 }}>\n                        <BoxHeader name='Remove Liquidity' />\n                    </Grid>\n                    <DialogContent>\n                        <Card sx={{ p: 2, border: '0px solid', boxShadow: 2, mb: 2 }}>\n                            <DialogContentText>\n                                Choose amount of liquidity shares to remove\n                            </DialogContentText>\n\n                            <Box sx={{ width: 500, mt: 3, ml: 2 }}>\n                                <Grid container spacing={2} alignItems='center'>\n                                    <Grid item xs sx={{ mt: 2, ml: 2, mr: 2 }}>\n                                        <Slider\n                                            aria-label='Custom marks'\n                                            defaultValue={25}\n                                            valueLabelDisplay='auto'\n                                            marks={marks}\n                                            value={\n                                                typeof percent === 'number' ? percent : 0\n                                            }\n                                            onChange={handleSliderChange}\n                                            aria-labelledby='input-slider'\n                                        />\n                                    </Grid>\n                                    <Grid item sx={{ ml: 2, mr: 4 }}>\n                                        <Input\n                                            value={percent}\n                                            size='small'\n                                            onChange={handleInputChange}\n                                            onBlur={handleBlur}\n                                            inputProps={{\n                                                step: 1,\n                                                min: 0,\n                                                max: 100,\n                                                type: 'number',\n                                                'aria-labelledby': 'input-slider'\n                                            }}\n                                        />\n                                    </Grid>\n                                </Grid>\n                            </Box>\n                        </Card>\n                        <Card sx={{ p: 2, border: '0px solid', boxShadow: 2, mb: 0 }}>\n                            <CardHeader\n                                title='Amount Received'\n                                disableTypography={true}\n                                sx={{ fontSize: 18, mt: 0 }}></CardHeader>\n                            <Grid\n                                item\n                                container\n                                alignItems='center'\n                                spacing={2}\n                                sx={{ width: 400, ml: 2 }}>\n                                <Grid item xs={6}>\n                                    <Stack\n                                        direction='row'\n                                        spacing={0}\n                                        alignItems='center'>\n                                        <Item\n                                            sx={{ boxShadow: 0, mr: 1 }}\n                                            style={{ backgroundColor: 'transparent' }}>\n                                            <img\n                                                src={props.token1Icon}\n                                                alt=''\n                                                width='32'\n                                                height='32'\n                                            />\n                                        </Item>\n                                        <Item sx={{ boxShadow: 0 }}>\n                                            <Typography sx={{ fontSize: 18 }}>\n                                                {props.token1Symbol}:\n                                            </Typography>\n                                        </Item>\n                                    </Stack>\n                                    <Stack\n                                        direction='row'\n                                        spacing={0}\n                                        alignItems='center'>\n                                        <Item\n                                            sx={{ boxShadow: 0, mr: 1 }}\n                                            style={{ backgroundColor: 'transparent' }}>\n                                            <img\n                                                src={props.token2Icon}\n                                                alt=''\n                                                width='32'\n                                                height='32'\n                                            />\n                                        </Item>\n                                        <Item sx={{ boxShadow: 0 }}>\n                                            <Typography sx={{ fontSize: 18 }}>\n                                                {props.token2Symbol}:\n                                            </Typography>\n                                        </Item>\n                                    </Stack>\n                                </Grid>\n                                <Grid item xs={6}>\n                                    <Stack>\n                                        <Item sx={{ boxShadow: 0 }}>\n                                            <Typography sx={{ fontSize: 18 }}>\n                                                {numFormat(token1Amount)}\n                                            </Typography>\n                                        </Item>\n                                        <Item sx={{ boxShadow: 0 }}>\n                                            <Typography sx={{ fontSize: 18 }}>\n                                                {numFormat(token2Amount)}\n                                            </Typography>\n                                        </Item>\n                                    </Stack>\n                                </Grid>\n                            </Grid>\n                        </Card>\n                    </DialogContent>\n                    <DialogActions>\n                        <Button\n                            variant='contained'\n                            style={{ backgroundColor: 'gray' }}\n                            onClick={handleClose}>\n                            Cancel\n                        </Button>\n                        <LoadingButton\n                            color='primary'\n                            variant='contained'\n                            disabled={\n                                token1Amount === '0' ||\n                                token2Amount === '0' ||\n                                removeLiquidityInProgress\n                                    ? true\n                                    : false\n                            }\n                            loading={removeLiquidityInProgress === 1} // Fixme: need to know when to dismiss this - only after transaction PENDING\n                            loadingPosition='start'\n                            startIcon={<ExitToAppRoundedIcon />}\n                            onClick={handleWithdraw}>\n                            {removeLiquidityInProgress ? 'REMOVING' : 'REMOVE'}\n                        </LoadingButton>\n                    </DialogActions>\n                </Box>\n            </Dialog>\n        </div>\n    )\n}\n","import React from 'react'\nimport { useRecoilState } from 'recoil'\nimport { BigNumber } from 'bignumber.js'\nimport {\n    Card,\n    Grid,\n    CardActions,\n    CardContent,\n    Typography,\n    Stack,\n    Paper,\n    styled\n} from '@mui/material'\n\nimport { tokensState, poolsState } from '../atoms'\nimport { decimal_int_to_float, numFormat } from '../services/amm'\nimport RemoveLiquidity from './RemoveLiquidity'\n\nconst Item = styled(Paper)(({ theme }) => ({\n    ...theme.typography.body2,\n    padding: theme.spacing(0),\n    textAlign: 'left',\n    color: theme.palette.text.secondary\n}))\n\nfunction LiquidityPool(props) {\n    const [tokens] = useRecoilState(tokensState)\n    const [pools] = useRecoilState(poolsState)\n\n    let pool = pools.get(props.poolId)\n    if (!pool || !pool.shares) return <div></div>\n\n    const token1 = () => {\n        let pool = pools.get(props.poolId)\n        let token_address = pool.token1\n        let token = tokens.get(token_address)\n        return token\n    }\n\n    const token1Symbol = () => {\n        let token = token1(props.poolId)\n        return token.symbol\n    }\n\n    const token1Icon = () => {\n        let token = token1(props.poolId)\n        return token.icon\n    }\n\n    const userPoolShare = () => {\n        let pool = pools.get(props.poolId)\n        if (!pool.shares) return '0'\n        return BigNumber(props.balance).div(BigNumber(pool.shares))\n    }\n\n    const userToken1AmountDecimal = () => {\n        let pool = pools.get(props.poolId)\n        let user_share = userPoolShare()\n        return BigNumber(user_share).times(pool.token1Amount)\n    }\n\n    const userToken1Amount = () => {\n        return decimal_int_to_float(pool.token1, userToken1AmountDecimal())\n    }\n\n    const token2 = () => {\n        let pool = pools.get(props.poolId)\n        let token_address = pool.token2\n        let token = tokens.get(token_address)\n        return token\n    }\n\n    const token2Symbol = () => {\n        let token = token2(props.poolId)\n        return token.symbol\n    }\n\n    const token2Icon = () => {\n        let token = token2(props.poolId)\n        return token.icon\n    }\n\n    const userToken2AmountDecimal = () => {\n        let pool = pools.get(props.poolId)\n        let user_share = userPoolShare()\n        return BigNumber(user_share).times(pool.token2Amount)\n    }\n\n    const userToken2Amount = () => {\n        return decimal_int_to_float(pool.token1, userToken2AmountDecimal())\n    }\n\n    return (\n        <Card sx={{ p: 2, border: '0px solid', boxShadow: 2, mb: 5 }}>\n            <Typography sx={{ fontSize: 18, fontWeight: '500' }}>\n                Your Position\n            </Typography>\n            <CardContent>\n                <Grid item container direction='row' alignItems='center'>\n                    <Grid item xs={6}>\n                        <Stack direction='row' spacing={0} alignItems='center'>\n                            <Item\n                                sx={{ boxShadow: 0, mr: 0 }}\n                                style={{ backgroundColor: 'transparent' }}>\n                                <img src={token1Icon()} alt='' width='32' height='32' />\n                            </Item>\n                            <Item\n                                sx={{ boxShadow: 0, ml: -1, mr: 1 }}\n                                style={{ backgroundColor: 'transparent' }}>\n                                <img src={token2Icon()} alt='' width='32' height='32' />\n                            </Item>\n                            <Item sx={{ boxShadow: 0 }}>\n                                <Typography\n                                    sx={{ fontSize: 24, fontWeight: 'normal' }}\n                                    color='text.primary'\n                                    gutterBottom>\n                                    {token1Symbol()} / {token2Symbol()}:\n                                </Typography>\n                            </Item>\n                        </Stack>\n                        <Typography\n                            sx={{ fontSize: 16, fontWeight: 'normal' }}\n                            color='text.primary'>\n                            Your Pool Share:\n                        </Typography>\n                        <Typography\n                            sx={{ fontSize: 16, fontWeight: 'normal' }}\n                            color='text.primary'>\n                            Pooled {token1Symbol()}:\n                        </Typography>\n                        <Typography\n                            sx={{ fontSize: 16, fontWeight: 'normal' }}\n                            color='text.primary'>\n                            Pooled {token2Symbol()}:\n                        </Typography>\n                    </Grid>\n                    <Grid item xs={6} textAlign='right'>\n                        <Typography\n                            sx={{ fontSize: 24, fontWeight: 'normal' }}\n                            color='text.primary'\n                            gutterBottom>\n                            {props.balance}\n                        </Typography>\n                        <Typography\n                            sx={{ fontSize: 16, fontWeight: 'bold' }}\n                            color='text.primary'>\n                            {numFormat(userPoolShare(), true)}%\n                        </Typography>\n                        <Typography\n                            sx={{ fontSize: 16, fontWeight: 'bold' }}\n                            color='text.primary'>\n                            {numFormat(userToken1Amount())}\n                        </Typography>\n                        <Typography\n                            sx={{ fontSize: 16, fontWeight: 'bold' }}\n                            color='text.primary'>\n                            {numFormat(userToken2Amount())}\n                        </Typography>\n                    </Grid>\n                </Grid>\n            </CardContent>\n            <CardActions>\n                <Grid item container justifyContent='center'>\n                    <RemoveLiquidity\n                        poolId={props.poolId}\n                        balance={props.balance}\n                        token1Symbol={token1Symbol()}\n                        token2Symbol={token2Symbol()}\n                        token1Icon={token1Icon()}\n                        token2Icon={token2Icon()}\n                        token1={token1().address}\n                        token2={token2().address}\n                        token1Amount={userToken1Amount()}\n                        token2Amount={userToken2Amount()}\n                    />\n                </Grid>\n            </CardActions>\n        </Card>\n    )\n}\n\nexport default LiquidityPool\n","import React, { useState, useEffect } from 'react'\nimport { useRecoilState } from 'recoil'\nimport { BigNumber } from 'bignumber.js'\n\nimport LiquidityPool from './LiquidityPool'\nimport { poolsState, walletAddressState } from '../atoms'\nimport { getLPBalance, updatePoolDynamicData } from '../services/amm'\n\nfunction Positions() {\n    const [pools] = useRecoilState(poolsState)\n    const [connectedAddress] = useRecoilState(walletAddressState)\n    const [userPools, setUserPools] = useState(() => new Map())\n\n    useEffect(() => {\n        async function fetchBalance(poolId) {\n            const balance = await getLPBalance(poolId, connectedAddress)\n            if (balance) {\n                setUserPools((prev) => {\n                    let m = new Map(prev)\n                    m.set(poolId, balance)\n                    return m\n                })\n            }\n        }\n        if (connectedAddress) {\n            pools.forEach((pool) => {\n                fetchBalance(pool.id)\n            })\n        }\n    }, [connectedAddress, pools])\n\n    const allPools = () => {\n        let r = []\n        userPools.forEach((balance, poolId) => {\n            if (!BigNumber(balance).isZero()) {\n                r.push(<LiquidityPool key={poolId} poolId={poolId} balance={balance} />)\n                updatePoolDynamicData(poolId)\n            }\n        })\n        return r\n    }\n\n    return <div>{allPools()}</div>\n}\n\nexport default Positions\n","import React, { useState, useEffect } from 'react'\nimport { useRecoilState } from 'recoil'\nimport { getRecoil } from 'recoil-nexus'\nimport { BigNumber } from 'bignumber.js'\n\nimport {\n    tokensState,\n    poolsState,\n    tokensUserDataState,\n    walletAddressState,\n    addLiquiditySlippage,\n    transactionsStatusSelector\n} from '../atoms'\n\nimport {\n    add_liquidity,\n    updateTokenDynamicData,\n    updatePoolDynamicData,\n    getPoolIdFromTokens,\n    decimal_int_to_float,\n    float_to_decimal_int,\n    addToastMsg,\n    getPoolPriceForTokenA,\n    numFormat,\n    isTokenApproved,\n    calcOtherTokenRequiredAmountForLiquidity,\n    checkAndUpdateComponentTransactions,\n    isSufficientBalanceInWallet,\n    getWalletTokenAmount,\n    WALLET_SUFFICIENT_BALANCE\n} from '../services/amm'\n\nimport {\n    FormControl,\n    InputLabel,\n    Select,\n    MenuItem,\n    TextField,\n    Grid,\n    Button,\n    Box,\n    Card,\n    CardContent,\n    Typography\n} from '@mui/material'\nimport LoadingButton from '@mui/lab/LoadingButton'\nimport MonetizationOnIcon from '@mui/icons-material/MonetizationOn'\nimport AccountBalanceWalletIcon from '@mui/icons-material/AccountBalanceWallet'\n\nimport { useInterval } from 'usehooks-ts'\n\nimport { GApage, GAbutton } from '../services/ga.js'\n\nimport BoxHeader from './BoxHeader.js'\nimport Positions from './Positions.js'\nimport ConnectWallet from './ConnectWallet.js'\nimport Approve from './Approve.js'\nimport Balance from './Balance.js'\n\nfunction Provide() {\n    const [tokens] = useRecoilState(tokensState)\n    const [pools] = useRecoilState(poolsState)\n    const [token1, setToken1] = useState('')\n    const [token1Amount, setToken1Amount] = useState('')\n    const [token2, setToken2] = useState('')\n    const [token2Amount, setToken2Amount] = useState('')\n    const [activePoolId, setActivePoolId] = useState(0)\n    const [connectedAddress] = useRecoilState(walletAddressState)\n    const [addLiquidityInProgress, setAddLiquidityInProgress] = useState(false)\n    const [leadingToken, setLeadingToken] = useState(0) // 0 is no token, 1/2 is the last updated token\n    const [transactionsStatus] = useRecoilState(\n        transactionsStatusSelector('add_liquidity')\n    )\n    const [componentTxs, setComponentTxs] = useState({})\n    const [tuds] = useRecoilState(tokensUserDataState)\n\n    useEffect(() => {}, [tuds, pools])\n\n    useEffect(() => {\n        GApage('pools')\n    }, [])\n\n    useEffect(() => {\n        checkAndUpdateComponentTransactions(\n            transactionsStatus,\n            componentTxs,\n            setAddLiquidityInProgress\n        )\n    }, [transactionsStatus, componentTxs])\n\n    useEffect(() => {\n        if (token1 && token2) {\n            let poolId = getPoolIdFromTokens(token1, token2)\n            setActivePoolId(poolId)\n\n            // follow the leader\n            if (leadingToken <= 1) {\n                // cannot be 0, but just for safety\n                if (poolId > 0) {\n                    let amount = calcOtherTokenRequiredAmountForLiquidity(\n                        token1,\n                        token2,\n                        token1Amount\n                    )\n                    //console.log('Provide Liquidity amount: ', amount)\n                    if (amount !== undefined) setToken2Amount(amount) // can set amount with numFormat for nicer display: numFormat(amount)\n                } else {\n                    setToken2Amount(0)\n                }\n            } else {\n                if (poolId > 0) {\n                    let amount = calcOtherTokenRequiredAmountForLiquidity(\n                        token2,\n                        token1,\n                        token2Amount\n                    )\n                    if (amount !== undefined) setToken1Amount(amount) // can set amount with numFormat for nicer display\n                } else {\n                    setToken1Amount(0)\n                }\n            }\n        }\n    }, [token1, token2, token1Amount, token2Amount, leadingToken])\n\n    const updateTokensIntervalCallback = async () => {\n        // Allow periodic update only if both tokens are selected\n        if (activePoolId > 0) {\n            updatePoolDynamicData(activePoolId)\n        } else {\n            if (token1) updateTokenDynamicData(token1)\n            if (token2) updateTokenDynamicData(token2)\n        }\n    }\n\n    // timer to update token1 user data (allowance, amount)\n    // and selected pool data\n    useInterval(updateTokensIntervalCallback, 15000)\n\n    const handleToken1Select = (event) => {\n        let token_address = event.target.value\n        setToken1(token_address)\n        updateTokenDynamicData(token_address)\n\n        GAbutton('pool-token1')\n    }\n\n    const handleToken2Select = (event) => {\n        let token_address = event.target.value\n        setToken2(token_address)\n        updateTokenDynamicData(token_address)\n\n        GAbutton('pool-token2')\n    }\n\n    // Fixme: a perfect dup of the function in swap - consider extracting to util service module\n    const handleTokenAmountChange = (token, amount) => {\n        // fixme: consider limit decimals input according to token decimals\n        const regex = /^(([0-9]+[.]?[0-9]*)|([.][0-9]+))$/\n\n        if (token === token1 && (amount === '' || regex.test(amount))) {\n            setToken1Amount(amount)\n            setLeadingToken(1)\n        }\n        if (token === token2 && (amount === '' || regex.test(amount))) {\n            setToken2Amount(amount)\n            setLeadingToken(2)\n        }\n    }\n\n    const handleAddLiquidity = async () => {\n        setAddLiquidityInProgress(true)\n        let slippage = parseFloat(getRecoil(addLiquiditySlippage)) / 100\n        let minAmount1Out = BigNumber(token1Amount)\n            .times(BigNumber(1).minus(BigNumber(slippage)))\n            .toString(10)\n        let minAmount2Out = BigNumber(token2Amount)\n            .times(BigNumber(1).minus(BigNumber(slippage)))\n            .toString(10)\n        console.log('Add Liquidity slippage: ', slippage)\n        console.log(\n            'Add Liquidity minAmountOut: ',\n            minAmount1Out,\n            float_to_decimal_int(token1, minAmount1Out)\n        )\n\n        try {\n            let tx = await add_liquidity(\n                token1,\n                float_to_decimal_int(token1, token1Amount),\n                float_to_decimal_int(token1, minAmount1Out),\n                token2,\n                float_to_decimal_int(token2, token2Amount),\n                float_to_decimal_int(token2, minAmount2Out)\n            )\n\n            if (!tx) throw Error('Cannot perform transaction')\n\n            setComponentTxs((prevState) => ({\n                ...prevState,\n                [tx.transaction_hash]: 'new'\n            }))\n        } catch (e) {\n            addToastMsg('User abort', 'error')\n            setAddLiquidityInProgress(false)\n        }\n    }\n\n    const addLiquidityButton = () => {\n        GAbutton('add-liquidity')\n\n        let token1SufficientBalance = isSufficientBalanceInWallet(token1, token1Amount)\n        let token2SufficientBalance = isSufficientBalanceInWallet(token2, token2Amount)\n\n        if (\n            token1 &&\n            token2 &&\n            token1Amount > 0 &&\n            token2Amount > 0 &&\n            token1SufficientBalance === WALLET_SUFFICIENT_BALANCE.TRUE &&\n            token2SufficientBalance === WALLET_SUFFICIENT_BALANCE.TRUE &&\n            activePoolId !== 0\n        ) {\n            // PoolId is valid - display ADD LIQUIDITY button\n            return (\n                <LoadingButton\n                    color='primary'\n                    variant='contained'\n                    fullWidth={true}\n                    disabled={\n                        (connectedAddress &&\n                            isTokenApproved(token1, token1Amount) &&\n                            isTokenApproved(token2, token2Amount)) ||\n                        addLiquidityInProgress\n                            ? false\n                            : true\n                    }\n                    loading={addLiquidityInProgress}\n                    loadingPosition='start'\n                    startIcon={<MonetizationOnIcon />}\n                    onClick={handleAddLiquidity}>\n                    {addLiquidityInProgress ? 'ADDING LIQUIDITY' : 'ADD LIQUIDITY'}\n                </LoadingButton>\n            )\n        }\n\n        if (\n            connectedAddress &&\n            token1 &&\n            token2 &&\n            token1Amount > 0 &&\n            token2Amount > 0 &&\n            (token1SufficientBalance !== WALLET_SUFFICIENT_BALANCE.TRUE ||\n                token2SufficientBalance !== WALLET_SUFFICIENT_BALANCE.TRUE)\n        ) {\n            // Amount exceed wallet balance\n            return (\n                <LoadingButton\n                    color='primary'\n                    variant='contained'\n                    fullWidth={true}\n                    disabled={true}\n                    loading={\n                        token1SufficientBalance === WALLET_SUFFICIENT_BALANCE.UNKNOWN ||\n                        token2SufficientBalance === WALLET_SUFFICIENT_BALANCE.UNKNOWN\n                    }\n                    loadingPosition='start'\n                    startIcon={<AccountBalanceWalletIcon />}>\n                    {token1SufficientBalance === WALLET_SUFFICIENT_BALANCE.FALSE ||\n                    token2SufficientBalance === WALLET_SUFFICIENT_BALANCE.FALSE\n                        ? 'AMOUNT EXCEEDS WALLET BALANCE'\n                        : 'CHECKING WALLET BALANCE'}\n                </LoadingButton>\n            )\n        }\n\n        if (token1 && token2 && activePoolId === 0) {\n            // No pool for token pair selected\n            return (\n                <Button\n                    color='primary'\n                    variant='contained'\n                    fullWidth={true}\n                    disabled={true}>\n                    NOT A VALID Pool\n                </Button>\n            )\n        }\n\n        if (connectedAddress) {\n            // Wallet is connected\n            let instruction = ''\n            if (!token1 && !token2) instruction = 'SELECT TOKENS'\n            if ((!token1 && token2) || (token1 && !token2)) instruction = 'SELECT TOKEN'\n            if (token1 && token2 && (!token1Amount || !token2Amount))\n                instruction = 'ENTER AMOUNT'\n\n            if (instruction !== '')\n                return (\n                    <Button\n                        color='secondary'\n                        variant='contained'\n                        fullWidth={true}\n                        disabled={true}>\n                        {instruction}\n                    </Button>\n                )\n        }\n\n        return <div></div>\n    }\n\n    const priceAndShare = () => {\n        let pool = pools.get(activePoolId)\n\n        if (!token1Amount || !token2Amount || !activePoolId || !pool) return <div></div>\n\n        let symbol1 = tokens.get(token1).symbol\n        let symbol2 = tokens.get(token2).symbol\n        console.log(\n            '-----POOL SHARE: ',\n            token1Amount,\n            token2Amount,\n            decimal_int_to_float(pool.token1, pool.token1Amount) +\n                BigNumber(token1Amount),\n            decimal_int_to_float(pool.token2, pool.token2Amount)\n        )\n\n        let priceForToken1 = getPoolPriceForTokenA(activePoolId, token2, token1)\n        let priceForToken2 = getPoolPriceForTokenA(activePoolId, token1, token2)\n\n        // Normalize reserves amounts and get expected share in the pool\n        let pool_share =\n            pool.token1 === token1\n                ? BigNumber(token1Amount).div(\n                      BigNumber(token1Amount).plus(\n                          BigNumber(decimal_int_to_float(pool.token1, pool.token1Amount))\n                      )\n                  )\n                : BigNumber(token1Amount).div(\n                      BigNumber(token1Amount).plus(\n                          BigNumber(decimal_int_to_float(pool.token2, pool.token2Amount))\n                      )\n                  )\n\n        return (\n            <>\n                <Grid>\n                    <Card sx={{ mb: 2, mt: 2, boxShadow: 2 }}>\n                        <CardContent>\n                            <Typography\n                                sx={{ fontSize: 16, fontWeight: '500', mb: 0 }}\n                                gutterBottom>\n                                Pool Prices and Share\n                            </Typography>\n                        </CardContent>\n\n                        <Card sx={{ mb: 0, mt: 0 }}>\n                            <Grid item container alignItems='center' spacing={2}>\n                                <Grid item xs={4}>\n                                    <Typography\n                                        sx={{\n                                            textAlign: 'center',\n                                            lineHeight: 2,\n                                            mt: 1,\n                                            fontWeight: 'bold'\n                                        }}>\n                                        {numFormat(priceForToken1)}\n                                    </Typography>\n                                    <Typography\n                                        sx={{ textAlign: 'center', fontSize: 12, mb: 1 }}>\n                                        {symbol1} for {symbol2}\n                                    </Typography>\n                                </Grid>\n                                <Grid item xs={4}>\n                                    <Typography\n                                        sx={{\n                                            textAlign: 'center',\n                                            lineHeight: 2,\n                                            mt: 1,\n                                            fontWeight: 'bold'\n                                        }}>\n                                        {numFormat(priceForToken2)}\n                                    </Typography>\n                                    <Typography\n                                        sx={{ textAlign: 'center', fontSize: 12, mb: 1 }}>\n                                        {symbol2} for {symbol1}\n                                    </Typography>\n                                </Grid>\n                                <Grid item xs={4}>\n                                    <Typography\n                                        sx={{\n                                            textAlign: 'center',\n                                            lineHeight: 2,\n                                            mt: 1,\n                                            fontWeight: 'bold'\n                                        }}>\n                                        {numFormat(pool_share, true)}%\n                                    </Typography>\n                                    <Typography\n                                        sx={{ textAlign: 'center', fontSize: 12, mb: 1 }}>\n                                        Share of Pool\n                                    </Typography>\n                                </Grid>\n                            </Grid>\n                        </Card>\n                    </Card>\n                </Grid>\n            </>\n        )\n    }\n\n    const menuItems = (otherSelectedToken) => {\n        let r = []\n        tokens.forEach((value, address) => {\n            if (otherSelectedToken !== address) {\n                r.push(\n                    <MenuItem key={address} value={address}>\n                        <Grid container direction='row'>\n                            <Grid sx={{ mr: 1, mb: -1 }}>\n                                <img src={value.icon} alt='' width='24' height='24' />\n                            </Grid>\n                            <Grid>\n                                <Typography>{value.symbol || value.address}</Typography>\n                            </Grid>\n                        </Grid>\n                    </MenuItem>\n                )\n            }\n        })\n        return r\n    }\n\n    return (\n        <div>\n            <Box sx={{ p: 2, border: '0px solid', mt: 1, mb: 4, boxShadow: 2 }}>\n                <Grid container sx={{ mb: 4 }}>\n                    <BoxHeader name='Add Liquidity' />\n                </Grid>\n\n                <Grid container spacing={2}>\n                    <Grid item xs={6}>\n                        <FormControl fullWidth>\n                            <InputLabel id='token1-label'>Token 1:</InputLabel>\n                            <Select\n                                labelId='token1-label'\n                                id='token1-select'\n                                value={token1}\n                                label='Token 1'\n                                onChange={handleToken1Select}>\n                                {menuItems(token2)}\n                            </Select>\n                        </FormControl>\n                        <Balance\n                            token={token1}\n                            amount={getWalletTokenAmount(token1)}\n                            showMaxButton={true}\n                            setMaxAmountHandler={handleTokenAmountChange}\n                        />\n                    </Grid>\n                    <Grid item xs={6}>\n                        <FormControl fullWidth>\n                            <TextField\n                                helperText='Amount to provide'\n                                id='token1-amount'\n                                inputProps={{\n                                    variant: 'outlined',\n                                    placeholder: '0.00',\n                                    type: 'string',\n                                    autoComplete: 'off',\n                                    'aria-labelledby': 'input-amount1'\n                                }}\n                                value={token1Amount ? token1Amount : ''}\n                                onChange={(e) =>\n                                    handleTokenAmountChange(token1, e.target.value)\n                                }\n                                error={\n                                    isSufficientBalanceInWallet(token1, token1Amount) ===\n                                    WALLET_SUFFICIENT_BALANCE.FALSE\n                                        ? true\n                                        : false\n                                }\n                                disabled={token1 === '' ? true : false}\n                            />\n                        </FormControl>\n                    </Grid>\n                </Grid>\n\n                <Grid container spacing={2} sx={{ mt: 2 }}>\n                    <Grid item xs={6}>\n                        <FormControl fullWidth>\n                            <InputLabel id='token2-label'>Token 2:</InputLabel>\n                            <Select\n                                labelId='token2-label'\n                                id='token2-select'\n                                value={token2}\n                                label='Token 2'\n                                onChange={handleToken2Select}>\n                                {menuItems(token1)}\n                            </Select>\n                        </FormControl>\n                        <Balance\n                            token={token2}\n                            amount={getWalletTokenAmount(token2)}\n                            showMaxButton={true}\n                            setMaxAmountHandler={handleTokenAmountChange}\n                        />\n                    </Grid>\n                    <Grid item xs={6}>\n                        <FormControl fullWidth>\n                            <TextField\n                                helperText='Amount to provide'\n                                id='token2-amount'\n                                inputProps={{\n                                    variant: 'outlined',\n                                    placeholder: '0.00',\n                                    type: 'string',\n                                    autoComplete: 'off',\n                                    'aria-labelledby': 'input-amount2'\n                                }}\n                                value={token2Amount ? token2Amount : ''}\n                                onChange={(e) =>\n                                    handleTokenAmountChange(token2, e.target.value)\n                                }\n                                error={\n                                    isSufficientBalanceInWallet(token2, token2Amount) ===\n                                    WALLET_SUFFICIENT_BALANCE.FALSE\n                                        ? true\n                                        : false\n                                }\n                                disabled={token2 === '' ? true : false}\n                            />\n                        </FormControl>\n                    </Grid>\n                </Grid>\n\n                {priceAndShare()}\n\n                <Card sx={{ minWidth: 275, mb: 2, mt: 3, boxShadow: 2 }}>\n                    <ConnectWallet secondary='true' />\n                    <Approve\n                        token={token1}\n                        tokenAmount={token1Amount}\n                        activePoolId={activePoolId}\n                        tokenInRange={\n                            isSufficientBalanceInWallet(token1, token1Amount) ===\n                            WALLET_SUFFICIENT_BALANCE.TRUE\n                        }\n                    />\n                    <Approve\n                        token={token2}\n                        tokenAmount={token2Amount}\n                        activePoolId={activePoolId}\n                        tokenInRange={\n                            isSufficientBalanceInWallet(token2, token2Amount) ===\n                            WALLET_SUFFICIENT_BALANCE.TRUE\n                        }\n                    />\n                    {addLiquidityButton()}\n                </Card>\n            </Box>\n\n            {/* User's position boxes */}\n            <Positions />\n        </div>\n    )\n}\n\nexport default Provide\n","import React from 'react'\n\nimport {\n    Chart as ChartJS,\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend\n} from 'chart.js'\nimport { Line } from 'react-chartjs-2'\nimport { Typography, Card, Grid } from '@mui/material'\n\nChartJS.register(\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend\n)\n\nfunction Charts() {\n    const labels = [\n        '2021-12-14',\n        '2021-12-13',\n        '2021-12-12',\n        '2021-12-11',\n        '2021-12-10',\n        '2021-12-09',\n        '2021-12-08',\n        '2021-12-07',\n        '2021-12-06',\n        '2021-12-05'\n    ]\n    const datasets = [\n        {\n            id: 1,\n            label: '',\n            data: [\n                9.486967291294242, 9.913585044383598, 6.1093149832212585,\n                8.888170412454828, 9.644500380279675, 5.592256920179448,\n                1.6120884439497363, 1.6694652914713426, 9.780713359093626,\n                6.9842512776941055\n            ]\n        }\n    ]\n    /*    return ( <div>\n        123\n        <Line datasetIdKey='id'\n            data={{d1}}></Line>\n    </div>)*/\n\n    return (\n        <div>\n            <Card sx={{ mb: 0, mt: 0 }}>\n                <Typography>Overview</Typography>\n                <Grid item container alignItems='center' spacing={2}>\n                    <Grid item xs={6}>\n                        <Line\n                            datasetIdKey='id'\n                            data={{ labels: labels, datasets: datasets }}\n                        />\n                    </Grid>\n\n                    <Grid item xs={6}>\n                        <Line\n                            datasetIdKey='id'\n                            data={{ labels: labels, datasets: datasets }}\n                        />\n                    </Grid>\n                </Grid>\n            </Card>\n        </div>\n    )\n}\n\nexport default Charts\n","import React, { useState } from 'react'\nimport Swap from './Swap'\nimport Provide from './Provide'\nimport Charts from './Charts'\nimport { Tab, Tabs, Box } from '@mui/material'\n\nconst Main = () => {\n    const [selectedTab, setSelectedTab] = useState(0)\n\n    const handleChange = (event, newValue) => {\n        setSelectedTab(newValue)\n    }\n\n    return (\n        <Box>\n            <Tabs\n                sx={{ mt: 3, mb: 2 }}\n                value={selectedTab}\n                onChange={handleChange}\n                centered>\n                <Tab className='swap-tab' label='Swap' sx={{ fontSize: 18 }} />\n                <Tab className='provide-tab' label='Pools' sx={{ fontSize: 18 }} />\n                <Tab className='chart-tab' label='Charts' sx={{ fontSize: 18 }} />\n            </Tabs>\n            {selectedTab === 0 && <Swap />}\n            {selectedTab === 1 && <Provide />}\n            {selectedTab === 2 && <Charts />}\n        </Box>\n    )\n}\n\nexport default Main\n","import React from 'react'\nimport { Button } from '@mui/material'\n\nimport { human_readable_hash } from '../services/amm'\n\nfunction PendingTransaction(props) {\n    const handleClick = () => {\n        window.open('https://goerli.voyager.online/tx/' + props.hash, '_blank')\n    }\n\n    return (\n        <div>\n            <Button sx={{ mr: 2 }} variant='contained' onClick={handleClick}>\n                Tx {human_readable_hash(props.hash)} {props.transactionStatus}\n            </Button>\n        </div>\n    )\n}\n\nexport default PendingTransaction\n","import React from 'react'\n\nimport { useRecoilState } from 'recoil'\nimport { useInterval } from 'usehooks-ts'\n\nimport { pendingTxsState } from '../atoms'\nimport PendingTransaction from './PendingTransaction.js'\nimport {\n    getTransactionUpdate,\n    updateAllTokensDynamicData,\n    updatePoolsAndTokens,\n    addToastMsg\n} from '../services/amm'\n\nfunction PendingTransactions() {\n    const [txs] = useRecoilState(pendingTxsState)\n\n    const updateTransactionsStatus = async () => {\n        txs.forEach(async (tx) => {\n            if (!tx.dismiss) {\n                let status = await getTransactionUpdate(tx.hash)\n                if (status !== null) {\n                    // should get here only if there is an update\n                    if (status.includes('RECEIVED')) {\n                        addToastMsg('Transaction Sent', 'success')\n                    }\n                    if (status.includes('REJECTED')) {\n                        addToastMsg('Transaction Rejected', 'error')\n                    }\n                    if (status.includes('PENDING')) {\n                        addToastMsg('Transaction Pending', 'success')\n                        updatePoolsAndTokens(false)\n                        updateAllTokensDynamicData()\n                    }\n                    if (status.includes('ACCEPTED')) {\n                        addToastMsg('Transaction Accepted', 'success')\n                    }\n                }\n            }\n        })\n    }\n    useInterval(updateTransactionsStatus, 10000)\n\n    const pendingTransactions = () => {\n        let r = []\n        txs.forEach((tx) => {\n            if (!tx.dismiss) {\n                r.push(\n                    <PendingTransaction\n                        key={tx.hash}\n                        hash={tx.hash}\n                        transactionStatus={tx.status}>\n                        {' '}\n                    </PendingTransaction>\n                )\n            }\n        })\n        return r\n    }\n\n    return <>{pendingTransactions()}</>\n}\n\nexport default PendingTransactions\n","import React from 'react'\n\nimport { Snackbar, Alert } from '@mui/material'\n\nfunction Toast(props) {\n    const [open, setOpen] = React.useState(props.open)\n\n    const handleClose = (event, reason) => {\n        if (reason === 'clickaway') {\n            return\n        }\n        setOpen(false)\n    }\n\n    return (\n        <Snackbar\n            className='toast'\n            open={open}\n            autoHideDuration={6000}\n            onClose={handleClose}>\n            <Alert onClose={handleClose} severity={props.type} sx={{ width: '100%' }}>\n                {props.msg}\n            </Alert>\n        </Snackbar>\n    )\n}\n\nexport default Toast\n","import React from 'react'\n\nimport { useRecoilState } from 'recoil'\n\nimport { toastsState } from '../atoms'\nimport Toast from './Toast.js'\n\nfunction Toasts() {\n    const [toasts] = useRecoilState(toastsState)\n\n    const activeToasts = () => {\n        let allActiveToasts = []\n        toasts.forEach((t) => {\n            if (!t.dismiss) {\n                allActiveToasts.push(\n                    <Toast\n                        key={t.hash}\n                        open={t.dismiss ? false : true}\n                        msg={t.msg}\n                        type={t.type}></Toast>\n                )\n            }\n        })\n        return allActiveToasts\n    }\n\n    return <div>{activeToasts()}</div>\n}\n\nexport default Toasts\n","import React from 'react'\n\nimport {\n    Chart as ChartJS,\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend\n} from 'chart.js'\nimport { Line } from 'react-chartjs-2'\nimport { Typography, Card, Grid } from '@mui/material'\n\nChartJS.register(\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend\n)\n\nfunction Info() {\n    const options = (title) => {\n        return {\n            responsive: true,\n            plugins: {\n                legend: {\n                    position: 'top'\n                },\n                title: {\n                    display: true,\n                    text: title\n                }\n            }\n        }\n    }\n\n    const labels = [\n        '2021-12-14',\n        '2021-12-13',\n        '2021-12-12',\n        '2021-12-11',\n        '2021-12-10',\n        '2021-12-09',\n        '2021-12-08',\n        '2021-12-07',\n        '2021-12-06',\n        '2021-12-05'\n    ]\n    const datasets = [\n        {\n            id: 1,\n            label: '',\n            data: [\n                9.486967291294242, 9.913585044383598, 6.1093149832212585,\n                8.888170412454828, 9.644500380279675, 5.592256920179448,\n                1.6120884439497363, 1.6694652914713426, 9.780713359093626,\n                6.9842512776941055\n            ]\n        }\n    ]\n    /*    return ( <div>\n        123\n        <Line datasetIdKey='id'\n            data={{d1}}></Line>\n    </div>)*/\n\n    return (\n        <div>\n            <Card sx={{ mb: 0, mt: 0 }}>\n                <Typography>Overview</Typography>\n                <Grid item container alignItems='center' spacing={2}>\n                    <Grid item xs={6}>\n                        <Line\n                            options={options('TVL')}\n                            datasetIdKey='id'\n                            data={{ labels: labels, datasets: datasets }}\n                        />\n                    </Grid>\n\n                    <Grid item xs={6}>\n                        <Line\n                            options={options('Volume')}\n                            datasetIdKey='id'\n                            data={{ labels: labels, datasets: datasets }}\n                        />\n                    </Grid>\n                </Grid>\n            </Card>\n        </div>\n    )\n}\n\nexport default Info\n","import {\n    Box,\n    Card,\n    AppBar,\n    Toolbar,\n    Grid,\n    FormControl,\n    Button,\n    TextField,\n    Typography\n} from '@mui/material'\nimport React, { useEffect, useState } from 'react'\nimport { useRecoilState } from 'recoil'\nimport {\n    tokensState,\n    walletAddressState,\n    walletAmountsSelector,\n    lastTxDoneSelector\n} from '../atoms'\nimport { ERC20_mint, float_to_decimal_int } from '../services/amm'\n\nfunction Minter() {\n    const [mintAmount, setMintAmount] = useState('')\n    const [mintedTokens, setMintedTokens] = useState(new Map())\n    const [waitingToMint, setWaitingToMint] = useState([])\n\n    const [tokens] = useRecoilState(tokensState)\n    const [connectedAddress] = useRecoilState(walletAddressState)\n    const [walletAmounts] = useRecoilState(walletAmountsSelector)\n    const [lastTxDone] = useRecoilState(lastTxDoneSelector)\n\n    useEffect(() => {\n        console.log('minter tokens effect')\n        tokens.forEach((value, address) => {\n            console.log(address)\n            if (!mintedTokens.get(address)) {\n                setMintedTokens((prev) => {\n                    let n = new Map(prev)\n                    n.set(address, 0)\n                    return n\n                })\n            }\n        })\n    }, [tokens, mintedTokens])\n\n    const mintedState = { 0: '...', 1: 'MINTING', 2: 'MINTED' }\n\n    const waitingToMintList = () => {\n        let r = []\n        console.log(waitingToMint)\n        for (const x of waitingToMint) {\n            r.push(<div>token {x}</div>)\n        }\n        return r\n    }\n\n    const mintedTokensList = () => {\n        console.log('mintedTokensList!')\n        let r = []\n        mintedTokens.forEach((minted, address) => {\n            let token = tokens.get(address)\n            console.log('walletAmounts=', walletAmounts)\n            let walletAmount = walletAmounts.get(address)\n\n            if (token) {\n                r.push(\n                    <Card key={address} sx={{ mt: 1 }}>\n                        <Grid container direction='row'>\n                            <Grid sx={{ mr: 1, mb: -1 }}>\n                                <img src={token.icon} alt='' width='24' height='24' />\n                            </Grid>\n                            <Grid>\n                                <Typography>{token.name || token.address}</Typography>\n                            </Grid>\n                            <Grid sx={{ ml: 2 }}>\n                                <Typography> in wallet: {walletAmount}</Typography>\n                            </Grid>\n                            <Grid\n                                container\n                                direction='row'\n                                justifyContent='flex-end'\n                                sx={{ mr: 1, mt: -3 }}>\n                                {mintedState[minted]}\n                            </Grid>\n                        </Grid>\n                    </Card>\n                )\n            }\n        })\n\n        console.log(r)\n        return r\n    }\n    const handleMintAmountChange = (value) => {\n        setMintAmount(value)\n    }\n\n    const mintNextToken = () => {\n        console.log('waiting:', waitingToMint)\n        let x = [...waitingToMint]\n        let address = x.shift()\n        console.log('address: ', address)\n        ERC20_mint(address, float_to_decimal_int(address, mintAmount))\n        setWaitingToMint(x)\n    }\n    useEffect(() => {\n        console.log(\n            'lastTxDone changed, val=',\n            lastTxDone,\n            ' waitingToMint=',\n            waitingToMint\n        )\n        if (lastTxDone && waitingToMint.length > 0) {\n            mintNextToken()\n        }\n    }, [lastTxDone])\n\n    const handleMint = async () => {\n        console.log('will mint...')\n        console.log(mintedTokens.entries())\n        for (const entry of mintedTokens.entries()) {\n            console.log(entry)\n            let address = entry[0]\n            let minted = entry[1]\n            console.log('handleMint address=', address, ' minted=', minted)\n            let token = tokens.get(address)\n\n            if (minted === 0 && token) {\n                setWaitingToMint((curr) => {\n                    return [...curr, address]\n                })\n                /*\n                let tx = await ERC20_mint(\n                    address,\n                    float_to_decimal_int(address, mintAmount)\n                )*/\n\n                setMintedTokens((prev) => {\n                    let n = new Map(prev)\n                    n.set(address, 1)\n                    return n\n                })\n            }\n        }\n\n        if (lastTxDone) mintNextToken()\n    }\n\n    return (\n        <Box>\n            <Grid container sx={{ mt: 2, mb: 2 }}>\n                <Box sx={{ flexGrow: 1 }}>\n                    <AppBar position='static'>\n                        <Toolbar>\n                            <Typography>Mint (testnet)</Typography>\n                        </Toolbar>\n                    </AppBar>\n                </Box>\n            </Grid>\n            <Grid container spacing={2} sx={{}}>\n                <Grid item xs={12}>\n                    <FormControl fullWidth>\n                        <TextField\n                            helperText='Amount to mint'\n                            id='mint-amount'\n                            inputProps={{\n                                variant: 'outlined',\n                                placeholder: '0.00',\n                                type: 'number',\n                                autoComplete: 'off'\n                            }}\n                            value={mintAmount}\n                            onChange={(e) => handleMintAmountChange(e.target.value)}\n                        />\n                    </FormControl>\n                </Grid>\n                <Grid item xs={12}>\n                    <Button\n                        color='inherit'\n                        variant='outlined'\n                        fullWidth={true}\n                        disabled={connectedAddress && mintAmount > 0 ? false : true}\n                        onClick={handleMint}>\n                        {connectedAddress\n                            ? mintAmount > 0\n                                ? 'MINT'\n                                : 'PLEASE SET MINT AMOUNT'\n                            : 'PLEASE CONNECT WALLET'}\n                    </Button>\n                </Grid>\n                <Grid item xs={12}>\n                    {mintedTokensList()}\n                </Grid>\n                waiting to mint:\n                <Grid item xs={12}>\n                    {waitingToMintList()}\n                </Grid>\n            </Grid>\n        </Box>\n    )\n}\n\nexport default Minter\n","import React, { useEffect } from 'react'\nimport { AppBar, Toolbar, Typography, Container } from '@mui/material'\n\nimport { RecoilRoot } from 'recoil'\n\nimport RecoilNexus from 'recoil-nexus'\nimport { updatePoolsAndTokens } from './services/amm'\nimport { updatePoolsAndTokensStatic } from './services/static_data'\nimport Main from './components/Main'\nimport ConnectWallet from './components/ConnectWallet'\nimport PendingTransactions from './components/PendingTransactions'\nimport Toasts from './components/Toasts'\nimport Info from './components/Info'\nimport { useInterval } from 'usehooks-ts'\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom'\nimport Minter from './components/Minter'\nimport ReactGA from 'react-ga'\n\nimport { GAinit, GApage, GAbutton } from './services/ga.js'\n\nimport { getSourceMapRange } from 'typescript'\n\nfunction App() {\n    useEffect(() => {\n        GAinit()\n        GApage('/')\n    }, [])\n\n    // run once, on page load\n    useEffect(() => {\n        updatePoolsAndTokensStatic()\n        console.log('Finished updating static data')\n        updatePoolsAndTokens(true)\n    }, [])\n\n    const updateAMMIntervalCallback = async () => {\n        updatePoolsAndTokens(false)\n    }\n\n    // Timer to update all Pools and Tokens user data (allowance, amount)\n    useInterval(updateAMMIntervalCallback, 15000)\n\n    return (\n        <Router>\n            <RecoilRoot>\n                <RecoilNexus />\n                <div className='App'>\n                    <AppBar position='sticky' /*style={{ background: '#2F2F5A' }}*/>\n                        <Toolbar>\n                            <Typography\n                                variant='h4'\n                                color='inherit'\n                                component='div'\n                                sx={{ flexGrow: 1 }}>\n                                mySwap\n                            </Typography>\n                            <PendingTransactions />\n                            <ConnectWallet />\n                        </Toolbar>\n                    </AppBar>\n\n                    <Switch>\n                        <Route exact path='/'>\n                            <Container maxWidth='sm'>\n                                <Main />\n                            </Container>\n                        </Route>\n                        <Route path='/charts'>\n                            <Info />\n                        </Route>\n                        <Route path='/mint'>\n                            <Container maxWidth='sm'>\n                                <Minter />\n                            </Container>\n                        </Route>\n                    </Switch>\n                    <Toasts />\n                </div>\n            </RecoilRoot>\n        </Router>\n    )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n// import reportWebVitals from './reportWebVitals'\n\nimport CssBaseline from '@mui/material/CssBaseline'\n\nReactDOM.render(\n    <React.StrictMode>\n        <CssBaseline>\n            <App />\n        </CssBaseline>\n    </React.StrictMode>,\n    document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals()\n"],"sourceRoot":""}